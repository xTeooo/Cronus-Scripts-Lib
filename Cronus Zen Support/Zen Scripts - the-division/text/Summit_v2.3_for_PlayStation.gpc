/*
											 -   T H E   S U M M I T   -    A U T O F A R M   O N   T H E   1 0 t h   F L O O R   -
												
																	-   P L A Y S T A T I O N   O N L Y   -

Game: The Division 2
Version: 2.3
Device: CronusZEN ONLY
Controller tested: wired PS5 / PS4
Console : PS5 using RemotePlay on PC / PS4 ONLY
Author: noozbar



You need to get to the 10th floor of Summit
Set the difficulty to Normal to go up from floor 1 to 9
Then, go back to the lobby, change the difficulty to Challenging and put every directives exept 2 (the "skill" directives) and take the elevator again so that it takes you to the 10th floor
It has to be the same floor as in the video otherwise it won't work (check Required Floor 10)
If you are not on the right floor, go back to the lobby and take the elevator up to the 10th floor again until you find the right one. 
Then start the script when the elevator doors open and go do something else while it's farming for you


Required Floor 10
https://discord.com/channels/832268474066665512/839053823627493376/993591412304134245


Build 
https://discord.com/channels/832268474066665512/839053823627493376/997068866335297606
https://discord.com/channels/832268474066665512/839053823627493376/996886583045271564


Skill
L1 ==> turret
R1 ==> seeker mines


Start Autofarm when the elevator doors open
Hold L2 and tap UP

Enable or disable OLED Display (OLED display turns off after 3min)
Tap DOWN

*/

define MAX_LOOP = 25; // maximum amount of loops before the script starts again (if an enemy is well hidden and neither the turret nor the mine reaches him)

int toggle, fight, timer;
int HW_loop, killed, loop_cycle;
int elevator, combat, no_combat, dead;

const string TXT[] = {
			"L2/LT + UP"   , "to start or stop" ,
			//   0                 1    
			"The Summit"   , "AutoFarm"  ,
			//   2               3
			"Go to cover"  , "HardWired loop"  ,  "Suicide" , "You're dead" , "Restart"
			//   4                  5                  6            7             8
}

int display_info, info_count, current_info, screen_saver;
int display_on = 1;
int display_main = 1;

main {
	set_val(TRACE_1, toggle);
	set_val(TRACE_2, fight);
	//set_val(TRACE_3, HW_loop);
	//set_val(TRACE_4, killed);
	set_val(TRACE_5, loop_cycle);
	set_val(TRACE_6, timer / 1000);
	set_val(TRACE_4, screen_saver / 1000);
	set_val(TRACE_3, display_on)
	
// Block controller rumbles
	block_rumble();
	
// Colors definitions	
	elevator = get_led(LED_1) == 0x02 && get_led(LED_2) == 0x0D && get_led(LED_3) == 0x02;
	combat = !get_led(LED_1) && get_led(LED_2) == 0xFF && !get_led(LED_3); /*|| !get_led(LED_1) && !get_led(LED_2) && get_led(LED_3) == 0xFF*/
	no_combat = !get_led(LED_1) && get_led(LED_2) == 0xFF && get_led(LED_3) == 0x37;
	dead = !get_led(LED_1) && get_led(LED_2) == 0x0D && !get_led(LED_3);
		
// Toggle
	if(get_val(PS4_L2) && event_press(PS4_UP))
	{
		display_on = TRUE;
		toggle = !toggle;
		screen_saver = 0;
		
		if(!toggle)
			display_main = TRUE;
	}
	
	if(event_press(PS4_DOWN))
	{
		display_on = !display_on;
		
		if(!display_on)
			cls_oled(OLED_BLACK);
		else
		{
			if(!toggle)
				display_main = TRUE;
			else
			{
				if(combo_running(GO_TO_COVER_AND_START_CYCLE))	
					combo_run(DISPLAY_CORRIDOR);
					
				else if(combo_running(HARD_WIRED))	
					combo_run(DISPLAY_HW);
					
				else if(combo_running(NADE))	
					combo_run(DISPLAY_SUICIDE);
					
				else if(combo_running(RESTART))	
					combo_run(DISPLAY_RESTART);
			}
			
			screen_saver = 0;
		}
	}

// Toggle ON
	if(toggle)
	{
		timer += get_rtime(); // how long it takes me to finish the floor (TRACE 6)
		
		if(!HW_loop)
		{
			if(elevator)
				combo_run(GO_TO_COVER_AND_START_CYCLE);
		}
		else 
		{	
			if(combat) 
				fight = TRUE;
				
			if(fight)
			{
				combo_run(HARD_WIRED);
						
				if(loop_cycle > MAX_LOOP) // if more than X loops to clear the floor, wipe and restart
				{
					combo_stop(HARD_WIRED);
					combo_run(WIPE);
				}
			}
			else
				combo_stop(HARD_WIRED);
			
			if(no_combat && !killed) 
				combo_run(NADE);
				
			if(dead) 
				combo_run(RESTART);	
		}
	}
// Toggle OFF	
	else
	{
		combo_stop_all();
		HW_loop = 0;
		loop_cycle = 0;
		killed = 0
	}

	if(display_on)
	{	
	// Screen Saver
		screen_saver += get_rtime();
	
		if(screen_saver >= 180000) // 3min 
		{
			cls_oled(OLED_BLACK);
			display_on = FALSE;
		}
	
	// Timer to display user infos
		info_count += get_rtime();
		if(info_count > 2000)
		{
			current_info = !current_info;
			display_info = TRUE;
		}
		
	// Display how to toggle
		if(display_info) 
		{
			info_count = 0;
			rect_oled(1, 50, 126, 13, OLED_WHITE, OLED_BLACK); // bottom rectangle (clear)
			print(center_x(get_string_length(TXT[current_info]), OLED_FONT_SMALL_WIDTH),53,OLED_FONT_SMALL,OLED_WHITE,TXT[current_info]);
			display_info = FALSE;
		}
	
	// Display script name
		if(display_main)
		{
			cls_oled(OLED_BLACK);
			print(center_x(get_string_length(TXT[2]), OLED_FONT_MEDIUM_WIDTH),4,OLED_FONT_MEDIUM,OLED_WHITE,TXT[2]);
			print(center_x(get_string_length(TXT[3]), OLED_FONT_MEDIUM_WIDTH),26,OLED_FONT_MEDIUM,OLED_WHITE,TXT[3]);
			display_info = TRUE;
			display_main = FALSE;
		}
	}
}

combo GO_TO_COVER_AND_START_CYCLE {	
	timer = 0; // reset the timer
	
	if(display_on)
		combo_run(DISPLAY_CORRIDOR);
		
	wait(get_rtime());
	
// Start running to the cover	
	set_val(PS4_LY, -100);
	wait(390);
	set_val(PS4_L3, 100);
	set_val(PS4_LY, -100);
	wait(3160);
	set_val(PS4_L3, 100);
	set_val(PS4_LX, 23);
	set_val(PS4_LY, -100);
	wait(10); //_________________________________________________________________________________________
	set_val(PS4_L3, 100);
	set_val(PS4_LX, 59);
	set_val(PS4_LY, -100);
	wait(10); //_________________________________________________________________________________________
	set_val(PS4_L3, 100);
	set_val(PS4_LX, 82);
	set_val(PS4_LY, -84);
	wait(1190);
	set_val(PS4_L3, 100);
	set_val(PS4_LX, 76);
	set_val(PS4_LY, -89);
	wait(10); //_________________________________________________________________________________________
	set_val(PS4_L3, 100);
	set_val(PS4_LX, 57);
	set_val(PS4_LY, -100);
	wait(10); //_________________________________________________________________________________________
	set_val(PS4_L3, 100);
	set_val(PS4_LX, 23);
	set_val(PS4_LY, -100);
	wait(10); //_________________________________________________________________________________________
	set_val(PS4_L3, 100);
	set_val(PS4_LY, -100);
	wait(310);
	set_val(PS4_L3, 100);
	set_val(PS4_LX, 49);
	set_val(PS4_LY, -100);
	wait(10); //_________________________________________________________________________________________
	set_val(PS4_L3, 100);
	set_val(PS4_LX, 81);
	set_val(PS4_LY, -85);
	wait(410);
	set_val(PS4_L3, 100);
	set_val(PS4_LX, 67);
	set_val(PS4_LY, -96);
	wait(10); //_________________________________________________________________________________________
	set_val(PS4_L3, 100);
	set_val(PS4_LX, 38);
	set_val(PS4_LY, -100);
	wait(10); //_________________________________________________________________________________________
	set_val(PS4_L3, 100);
	set_val(PS4_LY, -100);
	wait(160);
	set_val(PS4_L3, 100);
	set_val(PS4_LX, 54);
	set_val(PS4_LY, -100);
	wait(10); //_________________________________________________________________________________________
	set_val(PS4_L3, 100);
	set_val(PS4_LX, 82);
	set_val(PS4_LY, -84);
	wait(510);
	set_val(PS4_L3, 100);
	set_val(PS4_LX, 48);
	set_val(PS4_LY, -100);
	wait(10); //_________________________________________________________________________________________
	set_val(PS4_L3, 100);
	set_val(PS4_LX, 23);
	set_val(PS4_LY, -100);
	wait(10); //_________________________________________________________________________________________
	set_val(PS4_L3, 100);
	set_val(PS4_LY, -100);
	wait(790);
	set_val(PS4_L3, 100);
	set_val(PS4_LX, 48);
	set_val(PS4_LY, -100);
	wait(10); //_________________________________________________________________________________________
	set_val(PS4_L3, 100);
	set_val(PS4_LX, 82);
	set_val(PS4_LY, -84);
	wait(230);
	set_val(PS4_L3, 100);
	set_val(PS4_LX, 40);
	set_val(PS4_LY, -100);
	wait(10); //_________________________________________________________________________________________
	set_val(PS4_L3, 100);
	set_val(PS4_LY, -100);
	wait(540);
	set_val(PS4_L3, 100);
	set_val(PS4_LX, 32);
	set_val(PS4_LY, -100);
	wait(10); //_________________________________________________________________________________________
	set_val(PS4_L3, 100);
	set_val(PS4_LX, 79);
	set_val(PS4_LY, -86);
	wait(10); //_________________________________________________________________________________________
	set_val(PS4_L3, 100);
	set_val(PS4_LX, 83);
	set_val(PS4_LY, -83);
	wait(550);
	set_val(PS4_L3, 100);
	set_val(PS4_LX, 66);
	set_val(PS4_LY, -97);
	wait(10); //_________________________________________________________________________________________
	set_val(PS4_L3, 100);
	set_val(PS4_LX, 33);
	set_val(PS4_LY, -100);
	wait(10); //_________________________________________________________________________________________
	set_val(PS4_L3, 100);
	set_val(PS4_LY, -100);
	wait(770);
	set_val(PS4_L3, 100);
	set_val(PS4_LY, -100);
	set_val(PS4_CROSS, 100);
	wait(80);
	set_val(PS4_LY, -74);
	set_val(PS4_CROSS, 100);
	set_val(PS4_RY, -100);
	wait(10); //_________________________________________________________________________________________
	set_val(PS4_LY, -49);
	set_val(PS4_CROSS, 100);
	set_val(PS4_RY, -100);
	wait(10); //_________________________________________________________________________________________v
	set_val(PS4_LY, -30);
	set_val(PS4_CROSS, 100);
	set_val(PS4_RY, -100);
	wait(10); //_________________________________________________________________________________________
	set_val(PS4_CROSS, 100);
	wait(720);
	
// Start Cycle 
	set_val(PS4_R1, 100); // seeker
	wait(700);
	wait(2200);
	set_val(PS4_L1, 100); // turet on
	wait(100);
	wait(4200);

	loop_cycle++;
	HW_loop++;
}

combo HARD_WIRED { // HardWired loop
	if(display_on) 
		combo_run(DISPLAY_HW);
		
	wait(get_rtime());
	
// Start loop
	set_val(PS4_L1, 100); // turet off
	wait(900);
	wait(1750);
	set_val(PS4_L1, 100); // turet on
	wait(150);
	wait(1000);
	set_val(PS4_R1, 100); // seeker
	wait(700);
	
// re-target the turret if it's not firing at anyone, re-target the mine if it's back at our feet	
	wait(2000);
	set_val(PS4_L1, 100);
	wait(150);
	wait(2200);
	set_val(PS4_R1, 100);
	wait(150);
	wait(2200);
	
	loop_cycle++;
}

combo NADE {
	fight = FALSE;
	if(display_on) //if(display_black)
	{
	// Display "Suicide"
		rect_oled(1, 1, 126, 49, OLED_WHITE, OLED_BLACK); // clear text zone
		print(center_x(get_string_length(TXT[6]), OLED_FONT_SMALL_WIDTH),random(1, 36),OLED_FONT_SMALL,OLED_WHITE,TXT[6]);
	}
	wait(get_rtime());
	
	//wait(1000);
	set_val(PS4_LEFT, 100); // take nade
	wait(100);

	set_val(PS4_RY, 100); // change view
	set_val(PS4_RX, 100); // change view
	wait(1000);

	set_val(PS4_R2, 100); // throw nade
	wait(100);

	set_val(PS4_LY, -100); // go forward
	wait(500);
	
	wait(4000);
	if(get_led(LED_2) == 0x0D)
		killed = 1;
	
}

combo RESTART {
	fight = FALSE;
	
	if(display_on) 
		combo_run(DISPLAY_DEAD);
		
	wait(get_rtime());
		
	wait(3500); // wait respawn
	set_val(PS4_SQUARE, 100); // press respawn
	wait(150);
	
	if(display_on) 
		combo_run(DISPLAY_RESTART);
		
	wait(get_rtime());
		
	wait(8000); // loading + elevator
	display_main = TRUE;
	wait(get_rtime());
	wait(2000);
	
	killed = 0;
	HW_loop = 0;
	loop_cycle = 0;
}

combo WIPE {
	call(NADE);
	wait(1000);
	call(NADE);
}

combo DISPLAY_CORRIDOR {
// Display "Go to cover"
	rect_oled(1, 1, 126, 49, OLED_WHITE, OLED_BLACK); // clear text zone
	print(center_x(get_string_length(TXT[4]), OLED_FONT_SMALL_WIDTH),random(1, 36),OLED_FONT_SMALL,OLED_WHITE,TXT[4]);
}

combo DISPLAY_HW {
// Display "HardWired loop"
	rect_oled(1, 1, 126, 49, OLED_WHITE, OLED_BLACK); // clear text zone
	print(center_x(get_string_length(TXT[5]), OLED_FONT_SMALL_WIDTH),random(1, 36),OLED_FONT_SMALL,OLED_WHITE,TXT[5]);
}

combo DISPLAY_SUICIDE {
// Display "Suicide"
	rect_oled(1, 1, 126, 49, OLED_WHITE, OLED_BLACK); // clear text zone
	print(center_x(get_string_length(TXT[6]), OLED_FONT_SMALL_WIDTH),random(1, 36),OLED_FONT_SMALL,OLED_WHITE,TXT[6]);
}

combo DISPLAY_DEAD {
// Display "You're dead"
	rect_oled(1, 1, 126, 49, OLED_WHITE, OLED_BLACK); // clear text zone
	print(center_x(get_string_length(TXT[7]), OLED_FONT_SMALL_WIDTH),random(1, 36),OLED_FONT_SMALL,OLED_WHITE,TXT[7]);
}

combo DISPLAY_RESTART {
// Display "Restart"
	rect_oled(1, 1, 126, 49, OLED_WHITE, OLED_BLACK); // clear text zone
	print(center_x(get_string_length(TXT[8]), OLED_FONT_SMALL_WIDTH),random(1, 36),OLED_FONT_SMALL,OLED_WHITE,TXT[8]);
}


int stringLength;
function get_string_length(offset) { // by Swizzy

    stringLength = 0;
    while (duint8(offset++)) { stringLength++; }
    return stringLength + 1;
}

function center_x(f_chars,f_font) {

    return (OLED_WIDTH / 2) - ((f_chars * f_font) / 2);
} ˙ªè∂Ç∫ã≤Ç≥Å∏èºçœ