// ZenShot COoper carbine and MP40!
                                              


//===============================================================
//    ADJUSTABLE VARIABLES                                       
//===============================================================
// Index to find Value Name string - switchable in game with left/right in ModEdit
    int valName_idx;                  
int DeadZone;
int drop_shot_hold;
int drop_shot_rest;
int AimAssistTime = 10;
int AimAssistSize = 13;
int VerticalStrength  = 15;
int HorizontalStrength=  0;
int Deadzone = 10;
//---Adjustable Variables Count                          
define AMOUNT_OF_VALNAME_IDX = 6; 
    //const string TITLE = "My Game"; // 18 char max 
    const string TITLE = "My Script 1"; // 11 char max 
    const string OFF   = "OFF";    
    const string ON    = "ON";   
    const string SCRIPT_ONOFF  = "SCRIPT WAS";   
// modName # of the last Mod Name string - Used for cycle modName_idx        
   define MAX_MODS_COUNT = 10;                          
// Mod Name      -   Text to Display
  const string HAIRTRIGGERS        = "Hair Trigg"; 
  const string RUMBLESONOFF        = "Rumbles" ; 
  const string USERMODVAR_1        = "Stick Noise"; 
  const string DROPSHOT            = "Drop Shot" ; 
  const string HOLDBREATH          = "Hold Breath";
  const string BUTTONLAYOUT        = "Btn Layout";
  const string STICKLAYOUT         = "Stck Layout";
  const string BATTSSTICKYAIM      = "BSticky Aim";
  const string ARGROUNDLOOT        = "ARGoundLoot";
  const string AUTOSLIDEEASY       = "ASlide Easy" ; 
  const string AUTOSLIDE           = "Auto Slide" ;
// Index to find Mod Name string - switchable in game with left/right in ModMenu
int modName_idx;  
//   Toggles 
  int USE_HAIR_TRIGGER ; 
  int rumble_onoff ; 
  int stick_noise_onoff ; 
  int dropshot_onoff ; 
  int holdbreath_onoff ;
  int BUTTON_LAYOUT;
  int STICK_LAYOUT;
  int ToggleBattsStickyAim ;// Batts Sticky Aim
  int AR_Groundloot;
  int AutoSlideCancelEasy = 0 ; 
  int AutoSlideCancel = 0 ; 
// Mod VALUES      -   Text to Display
const string USER_VAL_1    = "DeadZone" ;
const string DROPSHOT_HOLD = "DS Hold" ;
const string DROPSHOT_REST = "DS Rest" ;
const string AIMASSISTTIME = "AA Time";
const string AIMASSISTSIZE = "AA Size";
const string AR_VERTICAL   = "AR Vertical";
const string AR_HORIZONTAL = "AR Horizonl";
const string DEADZONE_MOD  = "Dead Zone";

// Constant bytes - Convert numbers array - ASCII_NUM[column number] 
    const int8 ASCII_NUM[] =                          
//      0  1  2  3  4  5  6  7  8  9  (column numbers)
      {48,49,50,51,52,53,54,55,56,57};                
                                                   
const string NO_EDIT_VAR1  = "No Edit Variables";//  17 
const string NO_EDIT_VAR2  = "for this MOD";// 12 
////////////////////////////////////////////////////////
// WEAPONS with Anti Recoil Profiles
define Mac10_Weapon    = 1;
define Kilo_Weapon     = 2;
define Bullfrog_Weapon = 3;
define OTS_Weapon      = 4;
define Amax_Weapon     = 5;
const string AR_PRIM_SECOND  = "AR Prim/Sec";
const string AR_GROUNDLOOT   = "AR Groundlo";
int AR_Prim_Sec_onoff ;// automatic


int KS_Hold_Breath = TRUE;
////////////////////////////////////////////////////////
const uint8 Options [] = {
  1 ,  // HAIRTRIGGERS # 1
  1 ,  // RUMBLESONOFF # 2
  1 ,  // USERMODVAR_1 # 3
  31,  // DROPSHOT # 4
  1 ,  // HOLD BREATH
  81,  // BUTTON LAYOUT
  82,  // STICK LAYOUT
  1 ,  // Batts Sticky Aim
  1 ,  // AR Groundloot
  1 ,
  1  
};
const uint8 EditVal [] = {
  0 , // HAIRTRIGGERS # 1
  0 , // RUMBLESONOFF # 2
  1 , // USERMODVAR_1 # 3
  1 , // DROPSHOT # 4
  0 , // HOLD BREATH
  0 , // BUTTON LAYOUT
  0 , // STICK LAYOUT
  1 , // Batts Sticky Aim
  1 , // AR Groundloot
  0,
  0 
};
const uint8 OptRange [][] = {
  { 0 , 0 }, // HAIRTRIGGERS # 1
  { 0 , 0 }, // RUMBLESONOFF # 2
  { 0 , 0 }, // USERMODVAR_1 # 3
  { 1 , 2 }, // DROPSHOT # 4
  { 0 , 0 }, // HOLD BREATH 5
  { 0 , 0 }, // BUTTON LAYOUT 6
  { 0 , 0 }, // STICK LAYOUT 7
  { 3 , 4 }, // Batts Sticky Aim
  { 5 , 6 }, // AR Ground loot
  { 0 , 0 }, // AUTOSLIDEEASY # 10
  { 0 , 0 }  // AUTOSLIDE # 11
};
const uint8 Min_Max_Options [][]={ 
  { 0 , 1 }, // HAIRTRIGGERS # 1
  { 0 , 1 }, // RUMBLESONOFF # 2
  { 0 , 1 }, // USERMODVAR_1 # 3
  { 0 , 3 }, // DROPSHOT # 4
  { 0 , 1 }, // HOLD BREATH
  { 0 ,16 }, // BUTTON LAYOUT
  { 0 , 5 }, // STICK LAYOUT
  { 0 , 1 }, // Batts Sticky Aim
  { 0 , 1 }, // AR Ground loot
  { 0 , 1 }, // AUTOSLIDEEASY # 1
  { 0 , 1 }  // AUTOSLIDE # 2
}; 
/////////////////////////////////////////////////////////////////////////////  
///   INITIALIZATION BLOCK                                                      
/////////////////////////////////////////////////////////////////////////////   
init {  
USE_HAIR_TRIGGER  = get_pvar(SPVAR_1,0,1,0); 
rumble_onoff      = get_pvar(SPVAR_2,0,1,0); 
stick_noise_onoff = get_pvar(SPVAR_3,0,1,0); 
dropshot_onoff    = get_pvar(SPVAR_4,1,3,0); 
holdbreath_onoff  = get_pvar(SPVAR_5,0,1,0);
BUTTON_LAYOUT    = get_pvar(SPVAR_6,0,16,0);
STICK_LAYOUT     = get_pvar(SPVAR_7,0, 5,0);
DeadZone          = get_pvar(SPVAR_8, 1,100, 10);
drop_shot_hold    = get_pvar(SPVAR_9, 100,6000, 600);
drop_shot_rest    = get_pvar(SPVAR_10, 100,6000, 5000);
ToggleBattsStickyAim = get_pvar(SPVAR_11,1,1,1);
AimAssistTime        = get_pvar(SPVAR_12,1,100,10);
AimAssistSize        = get_pvar(SPVAR_13,1,100,10);
AR_Groundloot        = get_pvar(SPVAR_14,1,1,1);
VerticalStrength     = get_pvar(SPVAR_15,1,100,15);
HorizontalStrength   = get_pvar(SPVAR_16,-99,99,0);
AutoSlideCancelEasy  = get_pvar(SPVAR_17,0,1,0);
AutoSlideCancel      = get_pvar(SPVAR_18,0,1,0);

InitializeShapeChange(); 
}// end of init block
///////////////////////////////////////////////////////////////////////////// 
///   MAIN BLOCK                                                             
/////////////////////////////////////////////////////////////////////////////
main {//---------------------------------
    
    
    Run_Button_Configs();
    
    
    set_val(TRACE_1,BTN_FIRE);
    
    set_val(TRACE_2,BTN_AIM);
    
   /////////////////////////////////////////
 if(get_ival(BTN_AIM)){
     if(event_press(PS4_SHARE)){
         EntireScript_OnOff    = !EntireScript_OnOff;
         blinck(EntireScript_OnOff);
         cls_oled(0);
         draw_rectangle();
         //display_mod(f_idx, f_string, mod_name, f_toggle, f_option)
         display_mod( center_x(sizeof(SCRIPT_ONOFF)- 1, OLED_FONT_MEDIUM_WIDTH) ,SCRIPT_ONOFF [0],EntireScript_OnOff ,1);
         show_mesage_time = 2000;
 //--- Set Virtual Machine Speed to Default if script is OFF    
 if(!EntireScript_OnOff) set_Virtual_Machine_Speed(VM_Default); 
     }
 }
                          
 if(show_mesage_time){
     show_mesage_time -= get_rtime();
     if(show_mesage_time <= 0) {
         cls_oled(0);    
     }
 }
                               
//============================================================
// KILL SWITCH FOR ENTIRE SCRIPT
//============================================================
 if(EntireScript_OnOff){
  //--- Set Virtual Machine Speed to Default for MENU                     
	if(ModEdit || ModMenu) set_Virtual_Machine_Speed(VM_Default);
    if(display_EDIT){                
    	  // Clear OLED screen         
        cls_oled(0);                        
       // display_edit(f_idx, f_string, f_print, f_val) 
		if(EditVal[ modName_idx ] == 0 ){  
			  //--- print label                
		    line_oled(1,45,127,45,1,0);    
		    printf( center_x( 17, OLED_FONT_SMALL_WIDTH ), 20, OLED_FONT_SMALL, 1, NO_EDIT_VAR1[0] ); 
		    printf( center_x( 12, OLED_FONT_SMALL_WIDTH ), 33, OLED_FONT_SMALL, 1, NO_EDIT_VAR2[0] ); 
		}                                                                                            
		else {//----  ELSE BEGIN --------------  
             /////////////////////////////////////////////
             if(valName_idx == 0){ 
                  display_edit(center_x(sizeof(USER_VAL_1            )- 1,OLED_FONT_MEDIUM_WIDTH),USER_VAL_1            [0],DeadZone);
                  DeadZone = edit_val(DeadZone,1,100 );
             }         
             /////////////////////////////////////////////
             if(valName_idx == 1){ 
                  display_edit(center_x(sizeof(DROPSHOT_HOLD         )- 1,OLED_FONT_MEDIUM_WIDTH),DROPSHOT_HOLD         [0],drop_shot_hold);
                  drop_shot_hold = edit_val(drop_shot_hold, 100,6000);
             }         
             /////////////////////////////////////////////
             if(valName_idx == 2){ 
                  display_edit(center_x(sizeof(DROPSHOT_REST         )- 1,OLED_FONT_MEDIUM_WIDTH),DROPSHOT_REST         [0],drop_shot_rest);
                  drop_shot_rest = edit_val(drop_shot_rest, 100,6000);
             } 
             /////////////////////////////////////////////
             if(valName_idx == 3){ 
                  display_edit(center_x(sizeof(AIMASSISTTIME         )- 1,OLED_FONT_MEDIUM_WIDTH),AIMASSISTTIME         [0],AimAssistTime);
                  AimAssistTime = edit_val(AimAssistTime, 0,100);
             } 
             /////////////////////////////////////////////
             if(valName_idx == 4){ 
                  display_edit(center_x(sizeof(AIMASSISTSIZE         )- 1,OLED_FONT_MEDIUM_WIDTH),AIMASSISTSIZE         [0],AimAssistSize);
                  AimAssistSize = edit_val(AimAssistSize, 0,100);
             }
             /////////////////////////////////////////////
             if(valName_idx == 5){ 
                  display_edit(center_x(sizeof(AR_VERTICAL         )- 1,OLED_FONT_MEDIUM_WIDTH),AR_VERTICAL         [0],VerticalStrength);
                  VerticalStrength = edit_val(VerticalStrength, 0,100);
             }
             /////////////////////////////////////////////
             if(valName_idx == 6){ 
                  display_edit(center_x(sizeof(AR_HORIZONTAL         )- 1,OLED_FONT_MEDIUM_WIDTH),AR_HORIZONTAL         [0],HorizontalStrength);
                  HorizontalStrength = edit_val(HorizontalStrength, 0,100);
             }
             
             
             
             
		 }//--- ELSE END   ----------- 
   }//  end of display edit  
    if(refresh_OLED)
    { 
        // Clear OLED screen 
        cls_oled(0);       
                           
        // Draw Rectangle 
        draw_rectangle(); 
        // Display Mod Name and togle status  : ON/OFF   
        if(modName_idx == 0)display_mod( center_x(sizeof(HAIRTRIGGERS)- 1, OLED_FONT_MEDIUM_WIDTH) ,HAIRTRIGGERS[0],USE_HAIR_TRIGGER, Options[ 0 ]);
        if(modName_idx == 1)display_mod( center_x(sizeof(RUMBLESONOFF)- 1, OLED_FONT_MEDIUM_WIDTH) ,RUMBLESONOFF[0],rumble_onoff,     Options[ 1 ]);
        if(modName_idx == 2)display_mod( center_x(sizeof(USERMODVAR_1)- 1, OLED_FONT_MEDIUM_WIDTH) ,USERMODVAR_1[0],stick_noise_onoff,Options[ 2 ]);
        if(modName_idx == 3)display_mod( center_x(sizeof(DROPSHOT)- 1,     OLED_FONT_MEDIUM_WIDTH) ,DROPSHOT[0],    dropshot_onoff,   Options[ 3 ]);
        if(modName_idx == 4)display_mod( center_x(sizeof(HOLDBREATH)- 1,   OLED_FONT_MEDIUM_WIDTH) ,HOLDBREATH[0],  holdbreath_onoff, Options[ 4 ]);
        if(modName_idx == 5)display_mod( center_x(sizeof(BUTTONLAYOUT)- 1, OLED_FONT_MEDIUM_WIDTH) ,BUTTONLAYOUT[0],BUTTON_LAYOUT,   Options[ 5 ]);
        if(modName_idx == 6)display_mod( center_x(sizeof(STICKLAYOUT)- 1,  OLED_FONT_MEDIUM_WIDTH) ,STICKLAYOUT[0], STICK_LAYOUT,    Options[ 6 ]);
        if(modName_idx == 7)display_mod( center_x(sizeof(BATTSSTICKYAIM)- 1,  OLED_FONT_MEDIUM_WIDTH) ,BATTSSTICKYAIM[0], ToggleBattsStickyAim,    Options[ 7 ]);
        if(modName_idx == 8)display_mod( center_x(sizeof(ARGROUNDLOOT)- 1,  OLED_FONT_MEDIUM_WIDTH) ,ARGROUNDLOOT[0], AR_Groundloot,    Options[ 8 ]);
        if(modName_idx == 9)display_mod( center_x(sizeof(AUTOSLIDEEASY) - 1, OLED_FONT_MEDIUM_WIDTH) ,AUTOSLIDEEASY[0], AutoSlideCancelEasy,    Options[ 9 ]);
        if(modName_idx ==10)display_mod( center_x(sizeof(AUTOSLIDE)     - 1, OLED_FONT_MEDIUM_WIDTH) ,AUTOSLIDE[0], AutoSlideCancel,    Options[ 10 ]);
        
         refresh_OLED = FALSE; 
    } 
    if(display_title){           
          // clear OLED screen    
    	    cls_oled(0);            
    	    // Display Script Title      
          DrawLogo(0, 0, 0);
           // screen saver          
	         ModMenu = FALSE;   
           display_title = FALSE;  
           display_black = TRUE;
                                   
    }                            
      
    //-----------------------------
    // Screen saver (OLED off)   
    if(display_black )         
    {                            
        count_black += get_rtime();
        if(count_black >= 5000)   
        {                        
            cls_oled(0);         
            count_black = 0;      
            display_black = FALSE; 
        }                         
    }                           
                                
   /////////////////////////////////////////////////////////
   // MENU EDIT VALUES             
   if(ModEdit){ 
        block_all_inputs(); 
        if(MenuTimeOut){
            CheckIfBtnIsPressed();
        } 
       //--- Exit from EDIT MENU  
       if(event_release(PS4_CIRCLE)){
             ModEdit      = FALSE;           
             display_EDIT = FALSE;           
             ModMenu      = TRUE;            
             refresh_OLED = TRUE;   // display MODS 
       }                    
        ////////////////////////////////////////////////////////////////////////////////  
        //  GO FORWARD                                                                      
        if(!get_ival(BTN_AIM) && event_press(PS4_DOWN)){            
                                          
        	   valName_idx ++;                 
        	   if(valName_idx > OptRange[ modName_idx ][ 1 ])  valName_idx = OptRange[ modName_idx ][ 1 ]; 
             refresh_OLED = FALSE;      
             display_EDIT = TRUE;        
        }          
        ///////////////////////////////////////////////////////////////////////////////  
        //  GO BACK                                                                      
        if(!get_ival(BTN_AIM) && event_press(PS4_UP)){  
                                                               
        	   valName_idx --;                                      
        	   if(valName_idx < OptRange[ modName_idx ][ 0 ]) valName_idx = OptRange[ modName_idx ][ 0 ];
             refresh_OLED = FALSE;      
             display_EDIT = TRUE;        
        }                                                           
            /////////////////////////////////////////////////////// 
        if(MenuTimeOut){
            CheckIfBtnIsPressed();
        }
   }// end of EDIT MENU    
   /////////////////////////////////////////////////////////
   // EDIT MENU ON/OFF            
   if(get_ival(BTN_AIM) && event_press(PS4_OPTIONS)){  
        ModMenu = TRUE;  
        // toggle EditMenu ON/OFF                      
                 modName_idx  = 0;                   
                 refresh_OLED = TRUE;   // display Title    
                 display_EDIT = FALSE;        
                 MenuTimeOut  = menu_time_active;
   }      
   /////////////////////////////////////////////////////////
   // MENU SYSTEM              
   if(ModMenu){  
        block_all_inputs(); 
      //--- Exit from MENU  
      if(event_press(PS4_CIRCLE)){
          ModMenu = FALSE;                     
          ModEdit = FALSE;              
          combo_run(MESSAGE);             
      }                    
      //--- Enter in EDIT MENU 
      if(event_press(PS4_CROSS)){
          ModMenu     = FALSE;   
          valName_idx = OptRange[ modName_idx ][ 0 ]; 
          ModEdit     = TRUE;   
          display_EDIT= TRUE; 
      }                    
                                  
        //Display MOD NAME and togle status 
        // Switch MODs                     
        if( !get_ival(BTN_AIM) && event_press(PS4_DOWN)){ 
                                          
        	   modName_idx ++;                 
        	   if(modName_idx > MAX_MODS_COUNT) modName_idx = 0; 
          //////////////////////////////////////
        	
        	   blinck(modName_idx[ modName_idx + 1]);   
        }                          
        if(!get_ival(BTN_AIM) && event_press(PS4_UP)){  
                                                               
        	  modName_idx --;                                      
        	  if(modName_idx < 0) modName_idx = MAX_MODS_COUNT;
          //////////////////////////////////////
        	 
        	  blinck(modName_idx[ modName_idx + 1]);   
        	
          /////////////////////////////////////
          }                        
        	//////////////////////////
                                  
                                  
        // screen saver           
        display_black = FALSE;    
        display_title = FALSE;    
        //////////////////////////////  
        // display mod name and Toggle ON/OFF | Scroll Options 
        if(!get_ival(BTN_AIM) ){    
             if(event_press(PS4_LEFT)){ //   go back
                     modName_idx[ modName_idx + 1] = f_go_back( modName_idx[modName_idx + 1] ); 
             }// go back 
             if(event_press(PS4_RIGHT)){//   go forward
                    modName_idx[ modName_idx + 1] = f_go_forward( modName_idx[ modName_idx + 1]);   
             }// go forward 
       } 
        refresh_OLED = TRUE;   
        set_val(PS4_LEFT,0); 
        set_val(PS4_RIGHT,0); 
        set_val(PS4_UP,0); 
        set_val(PS4_DOWN,0); 
        if(MenuTimeOut){
            CheckIfBtnIsPressed();
        }
    } 
    /////////////////////////////////////////////////////////////
    ///    END OF MENU  /////////////////////////////////////////
    /////////////////////////////////////////////////////////////
//========================================================================================================== 
   if(!ModEdit && !ModMenu){//  code for MODS
             //--- LED COLOR INDICATION                                    
            // combo_run(Blink_MOD_ON);          
            //======================================================
            //   ANTI RECOIL PRIMARY / SECONDARY WEAPON 
            //======================================================
            if(get_ival(PS4_L2) && event_press(PS4_UP) ) {
                AR_Prim_Sec_onoff =  TRUE;
                AR_Groundloot     = FALSE;
                set_rumble_tipe(AR_Prim_Sec_onoff);
                display_MOD_status(AR_Prim_Sec_onoff,sizeof(AR_PRIM_SECOND)- 1,AR_PRIM_SECOND[0]);
                set_val(PS4_LEFT,0);
            }
             //======================================================
            //   ANTI RECOIL GROUNDLOOT WEAPON 
            //======================================================
            if(get_ival(PS4_L2) && event_press(PS4_RIGHT) ) {
                AR_Groundloot     =  TRUE;
                AR_Prim_Sec_onoff = FALSE;
                set_rumble_tipe(AR_Groundloot);
                display_MOD_status(AR_Groundloot,sizeof(AR_GROUNDLOOT)- 1,AR_GROUNDLOOT[0]);
                set_val(PS4_RIGHT,0);
            }
            //---Anti Recoil Primary/Secondary Weapon
            if(AR_Prim_Sec_onoff){
                //---1. Automatic Switch
                if(AR_Prim_Sec_onoff ){
                    if(get_ival(PS4_TOUCH) || get_ival(XB1_VIEW)){
                        if(event_press(BTN_SWAP)){
                            primary_weapon = TRUE;// Re-sync to Primary
                            set_profile_notify( PRIMARY_Profile, RUMBLE_A);// one heavy rumble
                            display_ar_profile();
                        }
                        if(event_press(BTN_CROUCH)){
                            primary_weapon = FALSE;// Re-sync to Primary
                            set_profile_notify( SECONDARY_Profile, RUMBLE_A);// two heavy rumble
                            display_ar_profile();
                        }
                        set_val(BTN_SWAP,0);
                    }
                    else if(event_press(BTN_SWAP)){
                        primary_weapon = !primary_weapon; 
                        display_ar_profile();
                        if(primary_weapon)
                        {
                            set_profile_notify(PRIMARY_Profile, RUMBLE_A);// one heavy rumble
                        }
                        else
                        {
                            set_profile_notify(SECONDARY_Profile, RUMBLE_A);// two heavy rumbles
                        }

                    }
                }// Automatic
            }
            //--- end of Anti Recoil Profiles Switch
            //======================================================
            //   ANTI RECOIL PRIMARY WEAPON 
            //======================================================
            //======================================================
            if(AR_Prim_Sec_onoff  && primary_weapon) {
				if(isqrt(pow(abs(get_ival(PS4_LX)),2) + pow(abs(get_ival(PS4_LY)),2)) <= DeadZone) {
					set_val(PS4_LX,0);
					set_val(PS4_LY,0);
				}
				
				if(isqrt(pow(abs(get_ival(PS4_RX)),2) + pow(abs(get_ival(PS4_RY)),2)) <= DeadZone) {
					set_val(PS4_RX,0);
					set_val(PS4_RY,0);
				}
                colourled(Green);
                if(get_val(BTN_FIRE))
			    {
			        AntiRecoil_Y = 41; 
			        AntiRecoil_X = -1; 
			        if(get_ptime(BTN_FIRE) >= 300)   
			        {
			            AntiRecoil_Y = 40; 
			            AntiRecoil_X = -1; 
			        }
			          if(get_ptime(BTN_FIRE) >= 3000)   
			        {
			            AntiRecoil_Y = 37; 
			            AntiRecoil_X = 0; 
			        }
			     
			        if(get_ptime(BTN_FIRE) >= 3900)  
			        {
			            AntiRecoil_Y = 0; 
			            AntiRecoil_X = 0; 
			        }
			        set_val(PS4_RY, SmartSens_func(AntiRecoil_Y, PS4_RY));
			        set_val(PS4_RX, SmartSens_func(AntiRecoil_X, PS4_RX));
			    }
            }
            //======================================================    
            //   ANTI RECOIL SECONDARY WEAPON 
            //======================================================
            //======================================================
            if(AR_Prim_Sec_onoff  && !primary_weapon) {
                colourled(Pink);
                if(get_val(BTN_FIRE))
			    {
			        AntiRecoil_Y = 45; 
			        AntiRecoil_X = -2; 
			        if(get_ptime(BTN_FIRE) >= 300)   
			        {
			            AntiRecoil_Y = 45; 
			            AntiRecoil_X = -2; 
			        }
			          if(get_ptime(BTN_FIRE) >= 3000)   
			        {
			            AntiRecoil_Y = 40; 
			            AntiRecoil_X = -2; 
			        }
			     
			        if(get_ptime(BTN_FIRE) >= 3900)  
			        {
			            AntiRecoil_Y = 7; 
			            AntiRecoil_X = -2; 
			        }
			           if(get_ptime(BTN_FIRE) >= 5500)  
			        {
			            AntiRecoil_Y = 0; 
			            AntiRecoil_X = -2; 
			        }
			           if(get_ptime(BTN_FIRE) >= 5900)  
			        {
			            AntiRecoil_Y = 0; 
			            AntiRecoil_X = 0; 
			        }
			        set_val(PS4_RY, SmartSens_func(AntiRecoil_Y, PS4_RY));
			        set_val(PS4_RX, SmartSens_func(AntiRecoil_X, PS4_RX));
			    }
            } 
            //======================================================    
            //   ANTI RECOIL GROUND LOOT WEAPON 
            //======================================================
            //   Legacy Rumble AR / Polar Rumble AR 
            if(AR_Groundloot){
            	colourled(Blue);
	        	if(RumbleAR_toggle == 1 || RumbleAR_toggle == 2)  // If Modern Warfare Rumble OR Cold War Rumble Selected \\ 
			    {
			        if(get_ival(BTN_FIRE) && get_ival(BTN_AIM))  // If Press Fire Trigger , Activate Rumble AR \\ 
			        {
			            if(!get_rumble(RUMBLE_A) || !get_rumble(RUMBLE_B))  // Until Rumble Is Detected , Set the Strength To Maintain Anti-Recoil Until Rumble Detected \\ 
			    
			                SmartSens(VerticalStrength,PS4_RY);
			                
			            else
			            {
			                if(RumbleAR_toggle == 1) // Modern Warfare Rumble Option 
			                    SmartRumble = get_rumble(RumbleToUse())
			                    
			                else if(RumbleAR_toggle == 2)  // Cold War Rumble Option 
			                    AntirecoilStrength = get_rumble(RUMBLE_A)/2;
			                
			            }
			            if(AntirecoilStrength > 10 && AntirecoilStrength < 90)  // If Get Rumble \\ // Calculate The Rumble & Vertical Strength Divided By 4 \\
			            {
			                AntirecoilStrength = VerticalStrength + SmartRumble / 4;
			            }     
			            if(AntirecoilStrength < 10)   // If NO Rumble Is Detected \\// This Will Act Like Normal Anti-Recoil \\
			            {
			                SmartSens(VerticalStrength, PS4_RY);
			                SmartSens(HorizontalStrength,PS4_RX); 
			            }
			            else
			            {     
			                SmartSens(AntirecoilStrength,PS4_RY);  // If Get Rumble \\ //   
			                SmartSens(HorizontalStrength,PS4_RX);      
			            }
			            AntirecoilStrength  = 0;  // Reset Rumble Calculation
			            SmartRumble = 0;          // Reset RumbleToUse(); 
			        }
			    }
				/* =========================== POLAR RUMBLE AR ============================*/
			    if(RumbleAR_toggle == 3 || RumbleAR_toggle == 4)  // If Modern Warfare Rumble OR Cold War Rumble Selected \\ 
			    {
			        if(get_ival(BTN_FIRE) && get_ival(BTN_AIM))  // If Press Fire Btn , Activate Rumble AR \\ 
			        {
			            if(!get_rumble(RUMBLE_A) || !get_rumble(RUMBLE_B))  // Until Rumble Is Detected , Set the Strength To Maintain Anti-Recoil Until Rumble Detected \\ 
			    
			                SmartSens(VerticalStrength,POLAR_RY);
			                
			            else
			            {
			                if(RumbleAR_toggle == 3) // Modern Warfare Rumble Option 
			                    SmartRumble = get_rumble(RumbleToUse())
			                    
			                else if(RumbleAR_toggle == 4)  // Cold War Rumble Option 
			                    AntirecoilStrength = get_rumble(RUMBLE_A)/2;
			                
			            }
			            if(AntirecoilStrength > 10 && AntirecoilStrength < 90)  // If Get Rumble \\ // Calculate The Rumble & Vertical Strength Divided By 4 \\
			            {
			                AntirecoilStrength = VerticalStrength + SmartRumble / 4;
			            }     
			            if(AntirecoilStrength < 10)   // If NO Rumble Is Detected \\// This Will Act Like Normal Anti-Recoil \\
			            {
			                SmartSens(VerticalStrength, POLAR_RY);
			                SmartSens(HorizontalStrength,POLAR_RX); 
			            }
			            else
			            {     
			                SmartSens(AntirecoilStrength,POLAR_RY);  // If Get Rumble \\ //   
			                SmartSens(HorizontalStrength,POLAR_RX);      
			            }
			            AntirecoilStrength  = 0;  // Reset Rumble Calculation
			            SmartRumble = 0;          // Reset RumbleToUse(); 
			        }
			    }
            }
            //======================================================    
            //  AIM ASSIST TAYLORDRIFT with SHAPES
            //====================================================== 
            if(ToggleTaylorAA == 1 || ToggleTaylorAA == 2 || TaylorAssist == 1 || TaylorAssist == 2 || TaylorAssist == 3 || TaylorAssist == 4){ 	// V1 && V6 										
				ActualMagnitude = isqrt(pow(RX_td, 2) + pow(RY_td, 2));   
				MaxMagnitude    = (ActualMagnitude < 100);  
				RX_td           = get_val(PS4_RX);
				RY_td           = get_val(PS4_RY); 
				CycleRefresh    += get_rtime();
				
				if(ToggleTaylorAA == 1 || ToggleTaylorAA == 2){ 
					angleVersionOne += SpeedAA12 + BoostAngle;
					GetAngle(TaylorShapesv1,angleVersionOne,RadiusAA12);
					if(BoostFirev1){
						if(get_ival(BTN_FIRE)){ 
							AimAssistBoost = get_rumble(RumbleToUse());
							BoostAngle = BoostSpeedv1;
			        		if(AimAssistBoost > 10 && AimAssistBoost < 90){  
					   			BoostedAimAssist  = (BoostStrengthv1 + AimAssistBoost / 6); 
				   			}
				   			if(BoostReducer){ 
								if(!get_rumble(RUMBLE_A) && !get_rumble(RUMBLE_B)){ 
									GetAngle(TaylorShapesv1,angleVersionOne,RadiusAA12 + inv(BoostStrengthv1));
								}else{ 
							   	 	GetAngle(TaylorShapesv1,angleVersionOne,inv(BoostedAimAssist/2));
						   		} 
						   	}else{
						   		if(!get_rumble(RUMBLE_A) && !get_rumble(RUMBLE_B)){ 
									GetAngle(TaylorShapesv1,angleVersionOne,RadiusAA12 + BoostStrengthv1);
								}else{ 
						   	 		GetAngle(TaylorShapesv1,angleVersionOne,BoostedAimAssist)
						   	    } 
					   		} 
				   		} 
				   		if(event_release(BTN_FIRE)){ 
				   			BoostedAimAssist = 0;
				   			AimAssistBoost   = 0;
				   		} 
				   	} 
				} 
				if(TaylorAssist == 1 || TaylorAssist == 2 || TaylorAssist == 4){ 
					GetAngle(TaylorShapesv2,angleVersionFive,TaylorRadius);
					if((abs(get_val(PS4_RX)) < 10) * (abs(get_val(PS4_RY)) < 10)) 
				    	angleVersionFive += AdsSpeed + BoostAnglev4;
				    else
				    	angleVersionFive +=  TaylorAngle + BoostAnglev4;
				    if(ToggleBoostFire){
						if(get_ival(BTN_FIRE)){ 
							AimAssistBoostv4 = get_rumble(RumbleToUse());
							BoostAnglev4 =  TaylorABoostSpd;
			        		if(AimAssistBoostv4 > 10 && AimAssistBoostv4 < 90){  
					   			BoostedAimAssistv4  = (TaylorPBoostStr + AimAssistBoostv4 / 6); 
				   			}
				   			if(BoostReducerv2){ 
								if(!get_rumble(RUMBLE_A) && !get_rumble(RUMBLE_B)){ 
									GetAngle(TaylorShapesv2,angleVersionFive,TaylorRadius + inv(TaylorPBoostStr));
								}else{ 
							   	 	GetAngle(TaylorShapesv2,angleVersionFive,inv(BoostedAimAssistv4/2));
						   		} 
						   	}else{ 
						   		if(!get_rumble(RUMBLE_A) && !get_rumble(RUMBLE_B)){ 
									GetAngle(TaylorShapesv2,angleVersionFive,TaylorRadius + TaylorPBoostStr);
								}else{ 
						   	 		GetAngle(TaylorShapesv2,angleVersionFive,BoostedAimAssistv4);
						   	 	} 
					   		} 
				   		} 
				   		if(event_release(BTN_FIRE)){ 
				   			BoostedAimAssistv4 = 0;
				   			AimAssistBoostv4   = 0;
				   		} 
				   	} 
			    }
			    if(TaylorAssist == 1 || TaylorAssist == 2 || TaylorAssist == 3 || TaylorAssist == 4){ 
			    	Tracking        = (Tracking + TrackingSpeed) % 360;
				    if(ShapeDirection){ 
				    	AngleDirection = (get_val(PS4_RX) > 0);
				    } 
				    if(TaylorTracking){ 
						Tracker1 = (TrackingSize * sin(Tracking)/100);
				        Tracker2 = (TrackingSize * cos(Tracking)/100);
				    }    
				}
				if(TaylorAssist == 3){ 
					angleVersionFive += get_rtime();
					GetAngle(TaylorShapesv2,SpeedAngle,TaylorRadius);
					SpeedAngle = (SpeedAngle  + (angleVersionFive / 100)) % 360;
				} 
				if(get_val(BTN_AIM) || get_val(BTN_FIRE)){ 
				
					if(ToggleTaylorAA == 1 || ToggleTaylorAA == 1 && BoostFirev1){ 	
						if(ActualMagnitude < RadiusAA12){
					   		SinAngle -= RX_td;                                                              
							CosAngle -= RY_td;
						}else{
							SinAngle = (SinAngle * (200 - ((abs(RY_td) + ActualMagnitude) / 10) * 10) / 200) * MaxMagnitude;  
							CosAngle = (CosAngle * (200 - ((abs(RX_td) + ActualMagnitude) / 10) * 10) / 200) * MaxMagnitude; 
						}
					}
					if(ToggleTaylorAA == 1 || TaylorAssist == 2 || TaylorAssist == 3) { 
						set_val(PS4_RX, clamp(RX_td + CosAngle, -100, 100));
						set_val(PS4_RY, clamp(RY_td + SinAngle, -100, 100));
					} 
					if(ToggleTaylorAA == 2 || TaylorAssist == 1){ 
						offset(POLAR_RS + 8,SinAngle);
						offset(POLAR_RS + 7,CosAngle);
					}
						
				} 
				if(event_release(BTN_AIM)){ 
			    	angleVersionFive = 0;
			    }
			    if(TaylorAssist == 4){ 
			    	if(get_ival(BTN_AIM) && !get_ival(BTN_FIRE)){ 
			    		offset(POLAR_RS + 8,SinAngle);
						offset(POLAR_RS + 7,CosAngle);
					}
					if(get_ival(BTN_FIRE)){ 
						PolarAimAssist = get_ptime(BTN_FIRE);	
						if(PolarAimAssist <= PolarStart){
			         		offset(POLAR_RS + 8,SinAngle);
							offset(POLAR_RS + 7,CosAngle);
			     		}
			     		if((PolarAimAssist > PolarStart) && (PolarAimAssist <= PolarMid)){
			         		set_val(PS4_RX, clamp(RX_td + CosAngle, -100, 100));
							set_val(PS4_RY, clamp(RY_td + SinAngle, -100, 100));
			     		}
			     		if(PolarAimAssist > PolarMid) {
			         		set_val(PS4_RX, clamp(RX_td + CosAngle, -100, 100));
							set_val(PS4_RY, clamp(RY_td + SinAngle, -100, 100));
			     		}
					} 
				}
			} 
	        //===========================================
	        //   Stick Noise                      
	        //===========================================
	        if( stick_noise_onoff ) { 
		        RemoveStickNoise();
	        }// end user MOD 4
            //===========================================
            //   IN GAME RUMBLE                          
            //===========================================
            if(!rumble_onoff)
                block_rumble();
                                
            //===========================================
            //   JOYSTICK CALIBRATION                         
            //===========================================
            if(!rumble_onoff)
                block_rumble();
                                
	         //===========================================
	         //   DROP SHOT 
	         //===========================================
	        if(get_ival(PS4_L2)){
	            if(event_press(PS4_DOWN)){
	                KS_drop_shot = !KS_drop_shot;
	                set_rumble_tipe(KS_drop_shot); 
	                display_MOD_status(KS_drop_shot,sizeof(DROPSHOT)- 1,DROPSHOT[0]);
	            }
	             set_val(PS4_DOWN,0);
	        }
	        if(dropshot_onoff  && KS_drop_shot) {     
	            if(dropshot_onoff == 1){
	                //--- FIRE ONLY
	                if(get_ival(BTN_FIRE) && !get_ival(BTN_AIM) ) combo_run(DROP_SHOT_cmb); 
	                /////////////////////////////////////////
	            }
	            if(dropshot_onoff == 2){
	                //--- ADS & FIRE
	                if(get_ival(BTN_FIRE) || get_ival(BTN_AIM) ) combo_run(DROP_SHOT_cmb); 
	                /////////////////////////////////////////
	            }
	            if(dropshot_onoff == 3){
	                //--- ADS ONLY
	                if(get_ival(!BTN_FIRE) && get_ival(BTN_AIM) ) combo_run(DROP_SHOT_cmb); 
	                /////////////////////////////////////////
	            } 
	        }                                   
            //--- CLEAR OLED SCREEN after message                                       
            if(time_to_clear_screen){               
                time_to_clear_screen -= get_rtime();
                if(time_to_clear_screen <= 0 ){     
                    QT_MESSAGE_TIMEOUT();     
                }                              
            }            
                          
            //===========================================
            //   HAIR TRIGGERS 
            //===========================================
            if(USE_HAIR_TRIGGER)
            {                                 
                 deadzone(PS4_L2,PS4_R2,99,99);
            }                                 
			//===========================================
			//   HOLD BREATH 
			//===========================================
			if(KS_Hold_Breath){ 
			    if(holdbreath_onoff  ) { // Like CoD
			         //----------------------------------------------
			         if( get_ival(BTN_AIM) ) set_val(BTN_SPRINT, 100);// SPRINT BTN 
			         //----------------------------------------------
			    } 
			   
			}
			//===========================================
            //   Batts Sticky Aim 
            //===========================================
            if(ToggleBattsStickyAim){
                if(get_ival(BTN_FIRE))
                    combo_run(StickyAim);
            }
            
                        //===========================================
		    //   AUTO SLIDE CANCEL 
		    //===========================================
			//===============================================  
			//--- Auto Slide Cancel with custom slide lenth (recommended for low skill players)ASCE 
			//===============================================                                        
		    if((event_press(PS4_UP) && get_ival(PS4_CIRCLE)) || (event_press(XB1_Y) && get_ival(PS4_UP))) {// 
		       AutoSlideCancelEasy = !AutoSlideCancelEasy;    
		       set_rumble_tipe (AutoSlideCancelEasy);         
		       if(AutoSlideCancelEasy)AutoSlideCancel = FALSE; 
		                                                      
		    }                         
		                              
		    if(AutoSlideCancelEasy){  
			     if(get_ival (BTN_CROUCH)){
					    combo_run(ASCE);
				   }                  
		    }                     
		                                                     
			//===============================================            
			//--- Auto Slide Cancel with the ability to choose the length of your slide. 
			//===============================================                                 
			if((event_press(PS4_UP) && get_ival(PS4_CROSS)) || (event_press(PS4_CROSS) && get_ival(PS4_UP))) {//- 
			   AutoSlideCancel = !AutoSlideCancel;                                        
			   if(AutoSlideCancel)AutoSlideCancelEasy = FALSE;                            
			   set_rumble_tipe (AutoSlideCancelEasy);                                
			}                                                                        
		                                                                         
		                                                                        
		   	if(AutoSlideCancel)  {                                            
		                                                                    
		       if((get_ival(walk) < -60) || (get_ival(walk) > 60) || (get_ival(strafe) < -60) || (get_ival(strafe) > 60)){
				      if(event_release (BTN_CROUCH)){                
					       combo_run(ASC)                               
				      }                                              
			     }                                               
		    }
        } //  end of MODS CODE 
    } //  ENTIRE SCRIPT KILL SWITCH 
} //  end of main block 
///////////////////////////////////////////////////////////////////////////// 
///   COMBO BLOCK                                                             
/////////////////////////////////////////////////////////////////////////////



const int8 PolarArray[] = { -100,-100,-100,-100,-100,-100,-100,-100,-100,-99,-99,-99,-98,-98,-98,-97,-97,-96,-96,-95,-94,-94,-93,-93,-92,-91,-90,-90,-89,-88,-87,-86,-85,-84,-83,-82,-81,-80,-79,-78,-77,-76,-75,-74,-72,-71,-70,-69,-67,-66,-65,-63,-62,-61,-59,-58,-56,-55,-53,-52,-50,-49,-47,-46,-44,-43,-41,-40,-38,-36,-35,-33,-31,-30,-28,-26,-25,-23,-21,-20,-18,-16,-14,-13,-11,-9,-7,-6,-4,-2,0,2,4,6,7,9,11,13,14,16,18,20,21,23,25,26,28,30,31,33,35,36,38,40,41,43,44,46,47,49,51,52,54,55,56,58,59,61,62,63,65,66,67,69,70,70,72,73,74,75,77,78,79,80,81,82,83,84,85,86,87,88,89,89,90,91,92,92,93,94,94,95,95,96,97,97,97,98,98,99,99,99,99,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,99,99,99,99,98,98,97,97,97,96,95,95,94,94,93,92,92,91,90,89,89,88,87,86,85,84,83,82,81,80,79,78,77,75,74,73,72,71,70,69,67,66,65,63,62,61,59,58,56,55,53,52,50,49,47,46,44,43,41,40,38,36,35,33,31,30,28,26,25,23,21,20,18,16,14,13,11,9,7,6,4,2,0,-1,-3,-5,-7,-8,-10,-12,-13,-15,-17,-19,-20,-22,-24,-25,-27,-29,-30,-32,-34,-35,-37,-39,-40,-42,-43,-45,-46,-48,-50,-51,-53,-54,-55,-57,-58,-60,-61,-62,-64,-65,-66,-68,-69,-70,-71,-73,-74,-75,-76,-77,-78,-79,-80,-81,-82,-83,-84,-85,-86,-87,-88,-89,-89,-90,-91,-92,-92,-93,-93,-94,-95,-95,-96,-96,-97,-97,-97,-98,-98,-99,-99,-99,-99,-100,-100,-100,-100,-100};
const int8 LinearArray[] = { 100,-100,-99,-98,-97,-96,-95,-94,-93,-91,-90,-89,-88,-87,-86,-85,-84,-82,-81,-80,-79,-78,-77,-76,-75,-73,-72,-71,-70,-69,-68,-67,-66,-64,-63,-62,-61,-60,-59,-58,-57,-55,-54,-53,-52,-51,-50,-49,-48,-46,-45,-44,-43,-42,-41,-40,-39,-37,-36,-35,-34,-33,-32,-31,-30,-28,-27,-26,-25,-24,-23,-22,-21,-19,-18,-17,-16,-15,-14,-13,-12,-10,-9,-8,-7,-6,-5,-4,-3,-11,2,3,4,5,6,7,8,10,11,12,13,14,15,16,17,19,20,21,22,23,24,25,26,28,29,30,31,32,33,34,35,37,38,39,40,41,42,43,44,46,47,48,49,50,51,52,53,55,56,57,58,59,60,61,62,64,65,66,67,68,69,70,71,73,74,75,76,77,78,79,80,82,83,84,85,86,87,88,89,91,92,93,94,95,96,97,98,100,100,100,99,98,97,96,95,94,93,91,90,89,88,87,86,85,84,82,81,80,79,78,77,76,75,73,72,71,70,69,68,67,66,64,63,62,61,60,59,58,57,55,54,53,52,51,50,49,48,46,45,44,43,42,41,40,39,37,36,35,34,33,32,31,30,28,27,26,25,24,23,22,21,19,18,17,16,15,14,13,12,10,9,8,7,6,5,4,3,1,-1,-1,-2,-3,-4,-5,-6,-7,-8,-10,-11,-12,-13,-14,-15,-16,-17,-19,-20,-21,-22,-23,-24,-25,-26,-28,-29,-30,-31,-32,-33,-34,-35,-37,-38,-39,-40,-41,-42,-43,-44,-46,-47,-48,-49,-50,-51,-52,-53,-55,-56,-57,-58,-59,-60,-61,-62,-64,-65,-66,-67,-68,-69,-70,-71,-73,-74,-75,-76,-77,-78,-79,-80,-82,-83,-84,-85,-86,-87,-88,-89,-91,-92,-93,-94,-95,-96,-97,-98,-100};   

// Version 1 & Version 2 AimAssist 
int ToggleTaylorAA  =  0;// Toggle = 1 For Aim Assist v1 , Toggle 2 for Aim Assist V2 
int ToggleAAType    =  1;// Toggle  0 = OFF, 1 = Polar - 2 = Linear - 3 = Mixed - This is for the shapes ( Aim Assist Type For Shapes ) 
int TaylorShapesv1  =  2;//WideOval= 2; Shape Selection 0 to 12 - names of the shapes are in the script next to the table
int SpeedAA12       = 15;// This is adjustable value - 0 to 99 max
int RadiusAA12      = 20;// This is adjustable value - 0 to 99 max
int BoostFirev1     = FALSE;// Toggle On/Off ( Boost On Fire ) 
int BoostReducer    = FALSE;// Toggle On/Off ( Boost Reducer - Makes the Shape smaller instead ) 
int BoostSpeedv1    =  5;   // This is a adjustable value for Boost speed if Boost On Fire Is enabled ( 0 - 40 max ) 
int BoostStrengthv1 = 10;  // This is a adjustable vaue for boost strength if Boost On Fire Is enabled ( 0 - 40 max ) 

// Version v4 & v5 & v5 + SpeedBoost 
int TaylorAssist    =  4;//  Toggle options 0 to 4 ,  1 - V4 , 2 - V5 , 3 - V5 Plus SpeedBoost , 4 V6 AA \\ 
int ToggleAATypev2  =  1;//  Toggle options 0 to 3 ,  0 = OFF, 1 = Polar - 2 = Linear - 3 = Mixed \\ // 
int TaylorShapesv2  =  2;//  Shape Selection 0 to 12 ( shape names are in the script next to the table ) 
int AdsSpeed        = 14;//  Adjustable Value - 0 - 99 max ( Ads Speed ) 
int TaylorAngle     = 12;// Adjustable Value - 0 - 99 max ( Speed )  
int TaylorRadius    = 12;// Adjustable Value - 0 - 99 max ( Radius ) 
int ShapeDirection  = 1; // Toggle - On/Off  ( Shape Direction ) 
int ToggleBoostFire = TRUE;// Toggle - On/Off ( Boost On Fire ) 
int BoostReducerv2  = FALSE;// Toggle - On/Off ( Boost Reducer On Fire - Reduces the shape Size ) 
int TaylorPBoostStr = 4; // Adjustable Value - 0 - 40 max ( Boost On Fire Strength ) 
int TaylorABoostSpd = 7;  // Adjustable Value - 0 - 40 max ( Boost On Fire Speed ) 

int TaylorTracking = 1;// Toggle On/Off 
int TrackingSize   = 2;  // Tracking Size  ( 0 - 8 max ) 
int TrackingSpeed  = 2; // Tracking Speed ( 0 - 8 max ) 


int Tracking,Tracker1,Tracker2;
int CosAngle,SinAngle;
int angleVersionOne,angleVersionFive;
int BoostedAimAssist,AimAssistBoost,BoostAngle; // V1 and V2 AimAssist 
int BoostedAimAssistv4,AimAssistBoostv4,BoostAnglev4; // v4 && v5 AimAssist 
int RX_td,RY_td,ActualMagnitude,MaxMagnitude;
int SpiralPosition1,InnerSpiral,OuterSpiral,SpiralPosition2,Position,SpeedAngle,AngleDirection,Positionv2;
int x,y,inc;
int CycleRefresh;
int TimeInterval = 4;
int PolarStart	 = 1000;
int PolarMid   	 = 1200;
int PolarAimAssist
define False     = FALSE;
define True      = TRUE; 

const int16 TaylorShapesInfo[][] = {
// Shape ID - CosAngle - SinAngle - DivisableRadiusCos - DivisableRadiusSin - NonSpiral 
{      0    ,    0     ,    0     ,          1         ,         1          ,     0 }, // Circular 
{      1    ,    0     ,    0     ,          2         ,         1          ,     0 }, // TallOval
{      2    ,    0     ,    1     ,          3        ,         2         ,     2 }, // WideOval
{      3    ,    0     ,    0     ,          2         ,         1          ,     1 }, // SpiralOval 
{      4    ,    0     ,    0     ,          2         ,         1          ,     1 }, // Spiral 
{      5    ,    0     ,    0     ,          1         ,         1          ,     2 }, // Helix 
{      6    ,    0     ,    0     ,          1         ,         0          ,     0 }, // Kitt 
{      7    ,    0     ,    0     ,          0         ,         1          ,     0 }, // Vertical Flare
{      8    ,   45    ,   135     ,          1         ,         1          ,     3 }, // Tartan Flex 
{      9    ,  180    ,   315     ,          1         ,         1          ,     0 }, // Jupiter
{     10    ,  135    ,    45     ,          1         ,         1          ,     0 }, // Bishop
{     11    ,   45    ,   135     ,          1         ,         1          ,     0 }, // Blade
{     12    ,  315    ,   180     ,          1         ,         1          ,     0 }  // Osclirate  
} 

function GetAngle(getShapes,getSinCos,Rad){ 

	if(TaylorShapesInfo[getShapes][5] == 0){
		if(AngleDirection){
			SinAngle  = (cos(TaylorShapesInfo[getShapes][1] + getSinCos) * Rad/TaylorShapesInfo[getShapes][3])/100 + Tracker1;
			CosAngle  = (sin(TaylorShapesInfo[getShapes][2] + getSinCos) * Rad/TaylorShapesInfo[getShapes][4])/100 + Tracker2; 
		}else{ 
			CosAngle  = (cos(TaylorShapesInfo[getShapes][1] + getSinCos) * Rad/TaylorShapesInfo[getShapes][3])/100 + Tracker1;
			SinAngle  = (sin(TaylorShapesInfo[getShapes][2] + getSinCos) * Rad/TaylorShapesInfo[getShapes][4])/100 + Tracker2; 
		} 
	} 
	if(TaylorShapesInfo[getShapes][5] == 1){ 
		Spiral(Rad);
		if(ShapeDirection){
			CosAngle  = (sin(TaylorShapesInfo[getShapes][1] + getSinCos) * InnerSpiral)/100 + Tracker1;
			SinAngle  = (cos(TaylorShapesInfo[getShapes][2] + getSinCos) * OuterSpiral)/100 + Tracker2;
		}else{ 
			CosAngle  = (cos(TaylorShapesInfo[getShapes][1] + getSinCos) * InnerSpiral)/100 + Tracker1;
			SinAngle  = (sin(TaylorShapesInfo[getShapes][2] + getSinCos) * OuterSpiral)/100 + Tracker2;
		} 
	}
	if(TaylorShapesInfo[getShapes][5] == 2){ 
		Helix();
		CosAngle  = (Rad * y)/100 + Tracker1;
		SinAngle  = (Rad * x)/100 + Tracker2;
	}
	if(TaylorShapesInfo[getShapes][5] == 3){ 
		if(Positionv2 == 0){ 
			CosAngle  = (cos(TaylorShapesInfo[getShapes][1] + getSinCos) * Rad/TaylorShapesInfo[getShapes][3])/100 + Tracker1;
			SinAngle  = (sin(TaylorShapesInfo[getShapes][2] + getSinCos) * Rad/TaylorShapesInfo[getShapes][4])/100 + Tracker2; 
		} 
		if(Positionv2 == 1){ 
			CosAngle  = (cos(TaylorShapesInfo[getShapes][2] + getSinCos) * Rad/TaylorShapesInfo[getShapes][3])/100 + Tracker1;
		    SinAngle  = (sin(TaylorShapesInfo[getShapes][1] + getSinCos) * Rad/TaylorShapesInfo[getShapes][4])/100 + Tracker2; 
		} 
	    Positionv2 ++ 
		if(Positionv2 == 2){ 
		  	Positionv2 = 0;
		}
	} 
} 
function InitializeShapeChange() { 
	if(TaylorShapesInfo[TaylorShapesv1][0] == 3) {
		if(ToggleTaylorAA == 1 || ToggleTaylorAA == 2){ 
			if(!ToggleBoostFire){
				InnerSpiral = RadiusAA12/2;	
				OuterSpiral = RadiusAA12;
			}else{ 
				InnerSpiral = BoostStrengthv1/2;	
				OuterSpiral = BoostStrengthv1;
			}
		}
	}
	if(TaylorShapesInfo[TaylorShapesv2][0] == 3) {
		if(TaylorAssist == 1 || TaylorAssist == 2){ 
			if(!ToggleBoostFire){ 
				InnerSpiral = TaylorRadius/2;	
				OuterSpiral = TaylorRadius;
			}else{ 
				InnerSpiral = TaylorPBoostStr/2;	
				OuterSpiral = TaylorPBoostStr;
			}
		}
	}
	
}
int i;
function Helix(){ 
	inc = (i % 100);
    if(Position == 0){ 
   		x = inc; y = 100 - inc;
   	} 
    else if (Position == 1){ 
    	x = 100 - inc; y = - inc; 
    }
    else if (Position == 2){
    	x = -inc; y = -100 + inc; 
    }
    else if(Position == 3) {  
    	x = -100 + inc; y = inc; 
    }
    Position ++;
   
    if(Position == 4){ 
    	Position = 0;
    }	
 } 
function Spiral(Rad){ 
	
		if(!(CycleRefresh++ % TimeInterval))
		{
			if(!SpiralPosition1)                                
			{
				InnerSpiral -= 1;
				if(InnerSpiral < Rad/2)
					SpiralPosition1 = True;   
			}
			else
			{
			    InnerSpiral += 1;
				if(InnerSpiral > Rad)
					SpiralPosition1 = False;
			}
			if(!SpiralPosition2)
			{
				OuterSpiral -= 1;
				if(OuterSpiral < Rad/2)
					SpiralPosition2 = True;
			}
			else
			{
				OuterSpiral += 1;
				if(OuterSpiral > Rad)
					SpiralPosition2 = False
			}
			CycleRefresh = 0;
		}
	
}
function correctAngle(angle){
  if(angle < 0) angle = 360 + (angle % 360);
  angle = (angle + 90) % 360;
  return angle;
}
function offset(Stick,Value) {
  set_val(Stick, clamp(Value * (100 - abs(get_val(Stick))) / 110 + get_val(Stick), -100, 100));
  return;
}
function sin(angle){
	
  	if(ToggleAAType == 1 || ToggleAATypev2 == 1)
		return PolarArray[correctAngle(angle)];
	else if(ToggleAAType == 2|| ToggleAATypev2 == 2)
    	return LinearArray[correctAngle(angle)];
    else if(ToggleAAType == 3|| ToggleAATypev2 == 3)
    	return PolarArray[correctAngle(angle)];
    	
    return 0;
}

function cos(angle){
	if(ToggleAAType == 1 || ToggleAATypev2 == 1) 
		return PolarArray[(correctAngle(angle) + 90) % 360];
	else if(ToggleAAType == 2|| ToggleAATypev2 == 2)
    	return LinearArray[(correctAngle(angle) + 90) % 360];
    else if(ToggleAAType == 3|| ToggleAATypev2 == 3)
    	return LinearArray[(correctAngle(angle) + 90) % 360]; 
    	
    return 0;   
}

// ANTI RECOIL
// Variables \\
int SmartRumble,AntirecoilStrength;
int SmartSens_side,SmartSens;
int polar_to_standard;
int final_val;
int range_min;
int range_max;
int RumbleAR_toggle = 1;// COD WF



function RumbleToUse() {
    if(get_rumble(RUMBLE_A) == get_rumble(RUMBLE_B)) 
    {
        return RUMBLE_A;
    }
    if(get_rumble(RUMBLE_A) == 100) 
    {
        return RUMBLE_B;
    }
    if(get_rumble(RUMBLE_B) == 100) 
    {
        return RUMBLE_A;
    }
    if(get_rumble(RUMBLE_A) > get_rumble(RUMBLE_B)) 
    {
        return RUMBLE_A;
    }
    if(get_rumble(RUMBLE_A) < get_rumble(RUMBLE_B)) 
    {
        return RUMBLE_B;
    }
    return 0;
}
function SmartSens(f_val, f_axis) { 
    
    if     (f_axis == POLAR_RX) polar_to_standard = PS4_RX;
    else if(f_axis == POLAR_RY) polar_to_standard = PS4_RY;
    else if(f_axis == POLAR_LX) polar_to_standard = PS4_LX;
    else if(f_axis == POLAR_LY) polar_to_standard = PS4_LY;
    else    polar_to_standard = f_axis;
    
    if(f_val < 0)
        SmartSens_side = -1; // Left / Up 
    else 
        SmartSens_side = 1; // Right / Down 

    if(SmartSens_side == -1) // if f_val has a negative value (Left side or Up) 
    {
        if(get_ival(f_axis) > 0) // if Right stick input has a positive value
            SmartSens = ((get_ival(polar_to_standard) * (100 - f_val)) / 100); 
        
        else if(get_ival(f_axis) <= 0) // if Right stick input has a negative value
            SmartSens = ((get_ival(polar_to_standard) * (100 + f_val)) / 100);
    }
    
    if(SmartSens_side == 1) // if f_val has a positive value (Right side or Down)
    {
        if(get_ival(f_axis) < 0) // if Right stick input has a negative value
            SmartSens = ((get_ival(polar_to_standard) * (100 + f_val)) / 100); 
            
        else if(get_ival(f_axis) >= 0) // if Right stick input has a positive value
            SmartSens = ((get_ival(polar_to_standard) * (100 - f_val)) / 100);
    }
            
    if(polar_to_standard == f_axis)
    {
        final_val = f_val + SmartSens;
        range_min = -100;
        range_max = 100;
    }
    else
    {
        final_val = (f_val + SmartSens) * 327;
        range_min = -32768;
        range_max = 32767;
    }
// Set axis to SmartSens value
    if(SmartSens_side == -1 && get_ival(f_axis) >= final_val || SmartSens_side == 1 && get_ival(f_axis) <= final_val)
        set_val(f_axis, clamp(final_val, range_min, range_max));
}
const string AR_PRIMARY_LABEL       = "COOPER" ;
const string AR_SECONDARY_LABEL     = "MP40" ;            
function display_ar_profile(){  
    if(!ModMenu && !ModEdit ){                                           
        // Clear OLED Screen                          
        cls_oled(0); // will clear oled                  
        if( primary_weapon ){
            printf(sizeof(AR_PRIMARY_LABEL)- 1 ,3,OLED_FONT_MEDIUM,OLED_WHITE,AR_PRIMARY_LABEL[0]);// Primary AR Profile 
        }
        else {           
            printf(sizeof(AR_SECONDARY_LABEL)- 1,3,OLED_FONT_MEDIUM,OLED_WHITE,AR_SECONDARY_LABEL[0]);//Secondary AR Profile                              
        }             
        printf(center_x(sizeof(ON)- 1, OLED_FONT_LARGE_WIDTH),37,OLED_FONT_LARGE,OLED_WHITE, ON[0]);
        time_to_clear_screen = 1500; 
    } 

}
int KS_AntiRecoil = TRUE;


////////////////////////////////////////////////////////////
///// Batts Sticky Aim     /////////////////////////////////
////////////////////////////////////////////////////////////


combo StickyAim {
	offset_batts(PS4_RY,AimAssistSize);
	wait(AimAssistTime);
	offset_batts(PS4_RX,AimAssistSize);
	offset_batts(PS4_LX,AimAssistSize);
	wait(AimAssistTime);
	offset_batts(PS4_RY,inv(AimAssistSize));
	wait(AimAssistTime);
    offset_batts(PS4_RX,inv(AimAssistSize));
    offset_batts(PS4_LX,inv(AimAssistSize));
    wait(AimAssistTime);
}
function offset_batts(Stick,Value) {
  set_val(Stick, clamp(Value * (90 - abs(get_ival(Stick))) / 90 + get_ival(Stick), -110, 100));
  return;
}

//=============================================== 
//                 ASC_PRO_MOD                    
//=============================================== 
combo ASC { // Professional Slide Cancel.         
    wait(14); // If this becomes an issue, change it to 12 or 15. Worked fine here.
    set_val(BTN_CROUCH, 100);                                          
    wait(14); // If this becomes and issue, change to anything between 11-20. 
    set_val(BTN_CROUCH, 100);          
    set_val(BTN_JUMP, 100);          
    wait(12);                                     
    set_val(BTN_CROUCH, 0);            
    set_val(BTN_JUMP, 100);         
    wait(12);                                      
    set_val(BTN_JUMP, 0);             
}                                                   
//===============================================  
//                 ESC                             
//===============================================  
combo ASCE { //--- Easy Slide Cancel.              
    set_val(BTN_CROUCH, 100);          
    wait(380);                         
    set_val(BTN_CROUCH, 0);            
    wait(60);                          
    set_val(BTN_CROUCH, 100);          
    wait(50);                          
    set_val(BTN_CROUCH, 100);          
    set_val(BTN_JUMP, 100);           
    wait(60);                          
    set_val(BTN_CROUCH, 0);            
    set_val(BTN_JUMP, 100);          
    wait(10);                        
    set_val(BTN_JUMP, 0);         
}
//-- VM Speed
define VM_Default = 0;
function set_Virtual_Machine_Speed (f_speed){
    if     (f_speed == 0) vm_tctrl(-0);//10 ms Default
    else if(f_speed == 1) vm_tctrl(-2);// 8 ms
    else if(f_speed == 2) vm_tctrl(-4);// 6 ms
    else if(f_speed == 3) vm_tctrl(-6);// 4 ms
    else if(f_speed == 4) vm_tctrl(-8);// 2 ms
    else if(f_speed == 5) vm_tctrl(-9);// 1 ms
}
           
int primary_weapon = TRUE;
int message_timeout;
int time_to_clear_screen;
function QT_MESSAGE_TIMEOUT (){     
	// Clear OLED Screen              
	cls_oled(0); // will clear oled   
	display_title  = FALSE;           
}                                  
                                      
                       
int exit_wait = 1500;
combo EXIT {     
	wait(exit_wait);     
	cls_oled(0);    
	ModMenu = FALSE;  
	ModEdit = FALSE;    
	display_EDIT = FALSE; 
	display_title = FALSE; 
}                      
int LED_OnOff;       
int rumble_tipe = RUMBLE_A;
       
//=============================================== 
//            LED BLINK                           
//=============================================== 
combo LED_BLINK {                                 
	colourled(LED_OnOff);                           
	wait(200);                                      
	colourled(ColorOFF);                            
	wait(100);                                      
	colourled(LED_OnOff);                           
	wait(200);                                      
	colourled(ColorOFF);                             
	wait(100);                                      
}                                                 
//=============================================== 
//            PROFILE VIBRATE 1 , 2 ,3                           
//=============================================== 
int profile_numbr;                                
combo PROFILES_VIBRATE_NOTIFY {                    
    if(profile_numbr >= 1) set_rumble(rumble_tipe, 100);
    wait(300);                                       
    reset_rumble();                                   
    wait(100);                                       
    if(profile_numbr > 1)set_rumble(rumble_tipe, 100);
    wait(300);                                       
    reset_rumble();                                  
    wait(100);                                       
    if(profile_numbr > 2)set_rumble(rumble_tipe, 100);
    wait(300);                                       
    reset_rumble();                                 
}
define PRIMARY_Profile   = 1;
define SECONDARY_Profile = 2;
function set_profile_notify(f_profile,rumbl_type){
    profile_numbr = f_profile;
    rumble_tipe   = rumbl_type;
    combo_run(PROFILES_VIBRATE_NOTIFY);
}

//=============================================== 
//                 VIBRATE SETUP                 
//=============================================== 
combo vibrate {                                   
	set_rumble(rumble_tipe, 100);                   
	wait(300);                                       
	reset_rumble();                                 
	wait(100);                                       
	set_rumble(rumble_tipe, 100);                   
	wait(300);                                       
	reset_rumble();                                 
}                                                 
//===============================================  
//                 RUMBLE_TIPE                     
//===============================================  
function set_rumble_tipe ( val) {                  
	if( val){ rumble_tipe = RUMBLE_A ; LED_OnOff = Green;}  
	else    { rumble_tipe = RUMBLE_B ; LED_OnOff = Red  ;} 
	combo_run(vibrate);                     
	combo_run(LED_BLINK);                   
}                                         
//===============================================  
//             DOUBLE CLICK 
//===============================================  
int b_dblclick;

function double_click (button) {                      
    if (b_dblclick) {                                 
        b_dblclick -=get_rtime();                                      
    }                                                 
    if (event_press(button) ) {
        if(b_dblclick){
            b_dblclick = 0;
            return TRUE;
        }else{
            b_dblclick = 300;
            return FALSE;
        }
    }                                                 
    return FALSE;                                        
}           

define ColorOFF  = 0;
define Blue      = 1;
define Red       = 2;
define Green     = 3;
define Pink      = 4;
define SkyBlue   = 5;
define Yellow    = 6;
define White     = 7;
                      
data(                 
  0,0,0, //0. ColorOFF
  2,0,0, //1. Blue     
  0,2,0, //2. Red      
  0,0,2, //3. Green    
  2,2,0, //4. Pink     
  2,0,2, //5. SkyBlue 
  0,2,2, //6. Yellow   
  2,2,2  //7. White    
); // end of data segment-------------- 
// COLOR LED function        
//-------------------------------------------------------------- 
                                       
int data_indx;
function colourled(color) {  
    for( data_indx = 0; data_indx < 3; data_indx++ ) {
        set_led(data_indx,duint8 ((color * 3) + data_indx));
    }
}

// Refresh OLED              
    int display_title = TRUE;
    int display_black;      
    int refresh_OLED;        
    int ModMenu;    
    int ModEdit;   
    int display_EDIT;   
    int EntireScript_OnOff = TRUE;// Kill Swith For Entire Script   
    int show_mesage_time; 
////////////////////////////////////// 
/////////////////////////////////////// 
int count_black;                      
int need_to_be_save;                 
int BlinckColor = 3;                 
int Col_ind;                         
//===============================================================
//   MODS COMBO SECTION
//===============================================================
int KS_drop_shot = TRUE; 
combo DROP_SHOT_cmb {                   
    set_val(BTN_CROUCH, 100); 
    wait(drop_shot_hold);  
    wait(drop_shot_rest); 
} 
int AntiRecoil_Y;
int AntiRecoil_X;



function SmartSens_func(f_val, f_axis) { 

    SmartSens = ( (f_val * ( 100 - abs( get_ival(f_axis) ) ) ) / 100); 

    return clamp(get_ival(f_axis) + SmartSens, -100, 100);    
}
///////////////////////////////



//////////////////////////////

function RemoveStickNoise() {

  if(isqrt(pow(abs(get_ival(PS4_LX)),2) + pow(abs(get_ival(PS4_LY)),2)) <= DeadZone) {
    set_val(PS4_LX,0);
    set_val(PS4_LY,0);
  }

  if(isqrt(pow(abs(get_ival(PS4_RX)),2) + pow(abs(get_ival(PS4_RY)),2)) <= DeadZone) {
    set_val(PS4_RX,0);
    set_val(PS4_RY,0);
  }
}
define FONT_STATS_INDEX_WIDTH    = 0; 
define FONT_STATS_INDEX_HEIGHT   = 1; 
define FONT_STATS_INDEX_MAXCHARS = 2; 
                                      
                                      
//////////////////////////////////////////////////////////////// 
function horizontal_center_offset(number_characters, font_size) { 
    return (128 - number_characters * FONT_STATS[font_size][FONT_STATS_INDEX_WIDTH]) / 2;
}             
              
const string EXIT_TXT1 = "SETTINGS";  
const string EXIT_TXT2 = "WAS SAVED"; 
                                     
////////////////////////////////////////////////////////////////////////////// 
///  SAVE  
function save_toggles () {  
                    
     set_pvar(SPVAR_1,USE_HAIR_TRIGGER); 
     set_pvar(SPVAR_2,rumble_onoff); 
     set_pvar(SPVAR_3,stick_noise_onoff); 
     set_pvar(SPVAR_4,dropshot_onoff); 
     set_pvar(SPVAR_5,holdbreath_onoff);
     set_pvar(SPVAR_6,BUTTON_LAYOUT);
     set_pvar(SPVAR_7,STICK_LAYOUT);
     set_pvar(SPVAR_8,DeadZone); 
     set_pvar(SPVAR_9,drop_shot_hold); 
     set_pvar(SPVAR_10,drop_shot_rest); 
     set_pvar(SPVAR_11,ToggleBattsStickyAim);
     set_pvar(SPVAR_12,AimAssistTime);
     set_pvar(SPVAR_13,AimAssistSize);
     set_pvar(SPVAR_14,AR_Groundloot);
     set_pvar(SPVAR_15,VerticalStrength);
     set_pvar(SPVAR_16,HorizontalStrength);
     set_pvar(SPVAR_17,AutoSlideCancelEasy);
     set_pvar(SPVAR_18,AutoSlideCancel);
     
     
     
    combo_run(EXIT);                  
      
}// end of save   
                      
combo MESSAGE {       
    wait(20);         
    save_toggles ();  
    cls_oled(0);      
    printf(horizontal_center_offset(sizeof(EXIT_TXT1), OLED_FONT_MEDIUM ), 2, OLED_FONT_MEDIUM, 1, EXIT_TXT1[0]); 
    printf(horizontal_center_offset(sizeof(EXIT_TXT2), OLED_FONT_MEDIUM ), 23, OLED_FONT_MEDIUM, 1, EXIT_TXT2[0]);
    exit_wait = 2000;     
}                        
function blinck ( var){  
	if(var){               
		BlinckColor = Green;
	}else{                 
		BlinckColor = Red;    
	}                       
	combo_run(BLINK_NOTIFY); 
}                           
                            
combo BLINK_NOTIFY {        
	colourled(BlinckColor);   
	wait(300);                 
	colourled(ColorOFF);        
	wait(100);                  
	colourled(BlinckColor);      
	wait(300);                   
	colourled(ColorOFF);          
}                                
int MOD_Color;
int blink_n ;
combo Blink_MOD_ON   {
    colourled(ColorOFF);   
    wait(500);                 
    colourled(ColorOFF);   
    wait(1000);
    blink_n +=1; 
    if( blink_n > 0)blink_n = 1; 
}                                
                                
                                
const uint8 FONT_STATS[][] = {  
    {  7, 10, 18 }, // Small    
    { 11, 18, 11 }, // Medium   
    { 16, 26,  7 }  // Large    
};                              
                                
function display_edit( f_string, f_print, f_val) {
    printf(f_string, 0, OLED_FONT_MEDIUM, OLED_WHITE, f_print);  
    number_to_string(f_val, find_digits(f_val));     
}                                                  
function f_go_forward (f_variable) {
    f_variable       +=1;   
    if(f_variable  > Min_Max_Options[modName_idx][1] )f_variable  = Min_Max_Options[modName_idx][1]; // max option
    need_to_be_save = TRUE;       
    blinck( f_variable );
    return f_variable;
}

function f_go_back (f_variable) {
    f_variable       -=1;   
    if(f_variable  < Min_Max_Options[modName_idx][0] )f_variable  = Min_Max_Options[modName_idx][0]; 
    need_to_be_save = TRUE;       
    blinck( f_variable );
    return f_variable;
}
// Variables for function number_to_string()  
int ssss;                            
int c_c_c,c_val;   
function number_to_string(f_val,f_digits) {                  
//=======================================================
//  number_to_string(value to convert, # of digits in value) 
//                                                           
//  Display Up to Max 16-bit Signed Integer (-32,768 to 32,767) 
//                                                      
//      Convert digits to ASCII                         
//      Add ASCII character to print buffer            
//      Print string centered X & Y on OLED             
//                                                       
//======================================================
    ssss = 1;  c_val = 10000;                            
                                                      
    if(f_val < 0) //--neg numbers                     
    {                                                 
         putc_oled(ssss,45);    //--add leading "-"      
         ssss += 1;                                      
         f_val = abs(f_val);                          
    }                                                 
                                                      
    for(c_c_c = 5; c_c_c >= 1; c_c_c--)                           
    {                                                 
        if(f_digits >= c_c_c)                             
        {                                             
            putc_oled(ssss,ASCII_NUM[f_val / c_val]);    
            f_val = f_val % c_val;                    
            ssss +=  1;                                  
            if(c_c_c == 4)                               
            {                                         
                putc_oled(ssss,44);   //--add ","        
                ssss += 1;                               
            }                                        
        }                                             
        c_val /= 10;                                  
    }                                                
    puts_oled(center_x(ssss - 1,OLED_FONT_LARGE_WIDTH),37,OLED_FONT_LARGE,ssss - 1,OLED_WHITE); // adjustable value centered in X 
}                                                     
int n_str_;                  
int horiz_X_center_sufix;    
                             
function print_number(f_val,f_digits ,print_s_x , print_s_y , f_font) { 
                                                      
    n_str_ = 1;  c_val = 10000;                       
                                                      
    if(f_val < 0) //--neg numbers                     
    {                                                 
         putc_oled(n_str_,45);    //--add leading "-" 
         n_str_ += 1;                                 
         f_val = abs(f_val);                          
                                                      
    }                                                 
                                                      
    for(c_c_c = 5; c_c_c >= 1; c_c_c--)                           
    {                                                 
        if(f_digits >= c_c_c)                             
        {                                              
            putc_oled(n_str_,ASCII_NUM[f_val / c_val]);
            f_val = f_val % c_val;                    
            n_str_ +=  1;                             
                                                      
        }                                             
        c_val /= 10;                                  
    }                                                 
    puts_oled(print_s_x,print_s_y,f_font,n_str_ - 1,OLED_WHITE); // adjustable value centered in X
}                                       
                                                      
                                                      
function edit_val( f_val, f_min, f_max ) {  // antirecoil = edit_val( 0 , antirecoil, 99  , 99  ) 
    line_oled(1,18,127,18,1,1);                                        
    // print the range values                                          
    // on the left: min value                                          
    print_number(f_min ,find_digits(f_min) ,4 , 22 , OLED_FONT_SMALL); 
    // on the right: max value                                         
    print_number(f_max ,find_digits(f_max) ,97 , 22 , OLED_FONT_SMALL);
                                          
    if(get_ival(BTN_AIM)){                  
		if(press_hold(PS4_RIGHT)){            
			f_val ++;                           
			if(f_val > f_max ) f_val = f_max;   
			display_EDIT = TRUE;                
			need_to_be_save = TRUE;             
		}                                     
                                          
		if(press_hold(PS4_LEFT)){             
			f_val --;                           
			if(f_val < f_min ) f_val = f_min;   
			display_EDIT = TRUE;                
			need_to_be_save = TRUE;             
		}                                     
		if(press_hold(PS4_UP)){               
			f_val +=10;                         
			if(f_val > f_max ) f_val = f_max;   
			display_EDIT = TRUE;                
			need_to_be_save = TRUE;             
		}                                     
                                          
		if(press_hold(PS4_DOWN)){             
			f_val -=10;                         
			if(f_val < f_min ) f_val = f_min;   
			display_EDIT = TRUE;                
			need_to_be_save = TRUE;             
		}                                     
	}                                      
    return f_val;                        
}                                        
                                             
                                   
function press_hold(f_btn) {       
//  return TRUE - event_press()    
//- every 250ms when button is held 
	  return event_press(f_btn) || get_ival(f_btn) && get_ptime(f_btn) > 250 
	       && get_ptime(f_btn) % (get_rtime() * 8) == 0;
}               
                
function find_digits(f_num) {                         
//  find_digits(value)                                
//        return Number of Digits in Value Passed     
                                                      
    f_num = abs(f_num);                               
    if(f_num / 10000 > 0) return 5;                   
    if(f_num /  1000 > 0) return 4;                   
    if(f_num /   100 > 0) return 3;                   
    if(f_num /    10 > 0) return 2;                   
                          return 1;                  
}                                                     
///////////////////////////////////////////////
//  FUNCTIONS                                 
                                              
function center_x(f_chars,f_font) {           
//  center_x(number of chars,font size);     
//        return X for Centering String Horizontally 
                                                      
    return (OLED_WIDTH / 2) - ((f_chars * f_font) / 2); 
}                                                      
                                                       
function draw_rectangle()        
{
    line_oled(1,25,127,25,1,1); 
    rect_oled(0, 0,OLED_WIDTH,64,FALSE,1); 
}

const string ModOption_56_0 = "Disabled"; 
const string ModOption_56_1 = "Mac 10"; 
const string ModOption_56_2 = "Kilo"; 
const string ModOption_56_3 = "Bullfrog"; 
const string ModOption_56_4 = "OTS"; 
const string ModOption_56_5 = "Amax"; 
define ShotModOptions = 31;
define FireModOptions =  9;
const string ModOption_31_0 = "Disable"; 
const string ModOption_31_1 = "Fire Only"; 
const string ModOption_31_2 = "ADS & Fire"; 
const string ModOption_31_3 = "ADS Only"; 
const string ModOption_31_4 = "On Fire"; 

const string ModOption_81_0 =	"DEFAULT";          // 0
const string ModOption_81_1 =	"TACTICAL";         // 1
const string ModOption_81_2 =	"LEFTY";            // 2
const string ModOption_81_3 =	"N0M4D/CHARLIE";    // 3
const string ModOption_81_4 =	"NOM4D/CH TACTICAL";// 4
const string ModOption_81_5 =	"NOM4D/CHARL L3F7Y";// 5
const string ModOption_81_6 =	"BUMPER JUMPER";    // 6
const string ModOption_81_7 =	"BUMP/JUM TACTICAL";// 7
const string ModOption_81_8 =	"ONE-HAND GUNSLING";// 8
const string ModOption_81_9 =	"STICK AND MOVE";   // 9
const string ModOption_81_10 =	"BRAWLER";          // 10
const string ModOption_81_11 =	"BEAST";            // 81
const string ModOption_81_12 =	"DEFAULT SWAPPED";  // 82
const string ModOption_81_13 =	"BUMP/J SWAPPED";   // 13 
const string ModOption_81_14 =	"BUMP/J TACT SWAPP";// 14
const string ModOption_81_15 =	"STICK & MOVE SWAP";// 15
const string ModOption_81_16 =	"TACTICAL SWAPPED"  // 16

const string ModOption_82_0 =	"DEFAULT";          // 0
const string ModOption_82_1 =	"SOUTHPAW";         // 1
const string ModOption_82_2 =	"LEGACY";           // 2
const string ModOption_82_3 =	"LEGACY SOUTHPAW";  // 3

const string ModOption_82_4 =	"SOUTHPAW";         // 4
const string ModOption_82_5 =	"NO CLICK SWAP";    // 5

const string ModOption_82_6 =	"LEGACY SOUTHPAW";  // 6
const string ModOption_82_7 =	"NO CLIC SWAP";     // 7


define SINGLE     = 37;
define ROW_1      = 32;
define ROW_2      = 47;


function display_mod( f_string, mod_name, f_toggle, f_option) {   
        // Display MOD_NAME                                    
        printf(f_string, 3, OLED_FONT_MEDIUM, OLED_WHITE, mod_name); 
        if(f_option == 1)                              
        {                                                     
        // Display Disable / Enable                                 
            if(f_toggle == 1)                                                             
                printf(center_x(sizeof(ON)  - 1, OLED_FONT_LARGE_WIDTH),37,OLED_FONT_LARGE,OLED_WHITE, ON[0]);// Enable 
            else                                                                                               
                printf(center_x(sizeof(OFF) - 1, OLED_FONT_LARGE_WIDTH),37,OLED_FONT_LARGE,OLED_WHITE,OFF[0]);// Disable 
        } 
        
      if(f_option == 81)                              
        {                                                     
        // Display Disable / Enable               // Display Disable / Enable                                 
            if(f_toggle == 0)                                                             
                printf(center_x(sizeof(ModOption_81_0)  - 1, OLED_FONT_SMALL_WIDTH),37,OLED_FONT_SMALL,OLED_WHITE, ModOption_81_0[0]);// Disable
            if(f_toggle == 1)                                                             
                printf(center_x(sizeof(ModOption_81_1)  - 1, OLED_FONT_SMALL_WIDTH),37,OLED_FONT_SMALL,OLED_WHITE, ModOption_81_1[0]);//
            if(f_toggle == 2)                                                             
                printf(center_x(sizeof(ModOption_81_2)  - 1, OLED_FONT_SMALL_WIDTH),37,OLED_FONT_SMALL,OLED_WHITE, ModOption_81_2[0]);//
            if(f_toggle == 3)                                                             
                printf(center_x(sizeof(ModOption_81_3)  - 1, OLED_FONT_SMALL_WIDTH),37,OLED_FONT_SMALL,OLED_WHITE, ModOption_81_3[0]);//    
            if(f_toggle == 4)                                                             
                printf(center_x(sizeof(ModOption_81_4)  - 1, OLED_FONT_SMALL_WIDTH),37,OLED_FONT_SMALL,OLED_WHITE, ModOption_81_4[0]);//    
            if(f_toggle == 5)                                                             
                printf(center_x(sizeof(ModOption_81_5)  - 1, OLED_FONT_SMALL_WIDTH),37,OLED_FONT_SMALL,OLED_WHITE, ModOption_81_5[0]);//
            if(f_toggle == 6)                                                             
                printf(center_x(sizeof(ModOption_81_6)  - 1, OLED_FONT_SMALL_WIDTH),37,OLED_FONT_SMALL,OLED_WHITE, ModOption_81_6[0]);//    
            if(f_toggle == 7)                                                             
                printf(center_x(sizeof(ModOption_81_7)  - 1, OLED_FONT_SMALL_WIDTH),37,OLED_FONT_SMALL,OLED_WHITE, ModOption_81_7[0]);//    
            if(f_toggle == 8)                                                             
                printf(center_x(sizeof(ModOption_81_8)  - 1, OLED_FONT_SMALL_WIDTH),37,OLED_FONT_SMALL,OLED_WHITE, ModOption_81_8[0]);//    
            if(f_toggle == 9)                                                             
                printf(center_x(sizeof(ModOption_81_9)  - 1, OLED_FONT_SMALL_WIDTH),37,OLED_FONT_SMALL,OLED_WHITE, ModOption_81_9[0]);//
            if(f_toggle == 10)                                                             
                printf(center_x(sizeof(ModOption_81_10)  - 1, OLED_FONT_SMALL_WIDTH),37,OLED_FONT_SMALL,OLED_WHITE, ModOption_81_10[0]);//    
            if(f_toggle == 11)                                                             
                printf(center_x(sizeof(ModOption_81_11)  - 1, OLED_FONT_SMALL_WIDTH),37,OLED_FONT_SMALL,OLED_WHITE, ModOption_81_11[0]);//    
            if(f_toggle == 12)                                                             
                printf(center_x(sizeof(ModOption_81_12)  - 1, OLED_FONT_SMALL_WIDTH),37,OLED_FONT_SMALL,OLED_WHITE, ModOption_81_12[0]);//   
            if(f_toggle == 13)                                                             
                printf(center_x(sizeof(ModOption_81_13)  - 1, OLED_FONT_SMALL_WIDTH),37,OLED_FONT_SMALL,OLED_WHITE, ModOption_81_13[0]);//    
            if(f_toggle == 14)                                                             
                printf(center_x(sizeof(ModOption_81_14)  - 1, OLED_FONT_SMALL_WIDTH),37,OLED_FONT_SMALL,OLED_WHITE, ModOption_81_14[0]);//    
            if(f_toggle == 15)                                                             
                printf(center_x(sizeof(ModOption_81_15)  - 1, OLED_FONT_SMALL_WIDTH),37,OLED_FONT_SMALL,OLED_WHITE, ModOption_81_15[0]);//    
            if(f_toggle == 16)                                                             
                printf(center_x(sizeof(ModOption_81_16)  - 1, OLED_FONT_SMALL_WIDTH),37,OLED_FONT_SMALL,OLED_WHITE, ModOption_81_16[0]);//    
        } 
        if(f_option == 82)                              
        {  
        	if(f_toggle == 0)                                                             
                printf(center_x(sizeof(ModOption_82_0)  - 1, OLED_FONT_SMALL_WIDTH),37,OLED_FONT_SMALL,OLED_WHITE, ModOption_82_0[0]);// Disable
            if(f_toggle == 1)                                                             
                printf(center_x(sizeof(ModOption_82_1)  - 1, OLED_FONT_SMALL_WIDTH),37,OLED_FONT_SMALL,OLED_WHITE, ModOption_82_1[0]);//
            if(f_toggle == 2)                                                             
                printf(center_x(sizeof(ModOption_82_2)  - 1, OLED_FONT_SMALL_WIDTH),37,OLED_FONT_SMALL,OLED_WHITE, ModOption_82_2[0]);//
            if(f_toggle == 3)                                                             
                printf(center_x(sizeof(ModOption_82_3)  - 1, OLED_FONT_SMALL_WIDTH),37,OLED_FONT_SMALL,OLED_WHITE, ModOption_82_3[0]);//    
            if(f_toggle == 4){                                                             
                printf(center_x(sizeof(ModOption_82_4)  - 1, OLED_FONT_SMALL_WIDTH),ROW_1,OLED_FONT_SMALL,OLED_WHITE, ModOption_82_4[0]);// 
                printf(center_x(sizeof(ModOption_82_5)  - 1, OLED_FONT_SMALL_WIDTH),ROW_2,OLED_FONT_SMALL,OLED_WHITE, ModOption_82_5[0]);// 
            }
            if(f_toggle == 5){                                                             
                printf(center_x(sizeof(ModOption_82_6)  - 1, OLED_FONT_SMALL_WIDTH),ROW_1,OLED_FONT_SMALL,OLED_WHITE, ModOption_82_6[0]);// 
                printf(center_x(sizeof(ModOption_82_7)  - 1, OLED_FONT_SMALL_WIDTH),ROW_2,OLED_FONT_SMALL,OLED_WHITE, ModOption_82_7[0]);// 
            }
                
        }
        
        
        if(f_option == ShotModOptions)// 31    
        {                                                     
            if(f_toggle == 0)                                                             
                printf(center_x(sizeof(ModOption_31_0)  - 1, OLED_FONT_MEDIUM_WIDTH),37,OLED_FONT_MEDIUM,OLED_WHITE, ModOption_31_0[0]);// Disable
                                                                                                                           
            if(f_toggle == 1)                                                             
                printf(center_x(sizeof(ModOption_31_1)  - 1, OLED_FONT_MEDIUM_WIDTH),37,OLED_FONT_MEDIUM,OLED_WHITE, ModOption_31_1[0]);// Fire Only
                                                                                                                           
            if(f_toggle == 2)                                                             
                printf(center_x(sizeof(ModOption_31_2)  - 1, OLED_FONT_MEDIUM_WIDTH),37,OLED_FONT_MEDIUM,OLED_WHITE, ModOption_31_2[0]);// ADS & Fire
                                                                                                                           
            if(f_toggle == 3)                                                             
                printf(center_x(sizeof(ModOption_31_3)  - 1, OLED_FONT_MEDIUM_WIDTH),37,OLED_FONT_MEDIUM,OLED_WHITE, ModOption_31_3[0]);// ADS Only
                                                                                                                           
        }            
        if(f_option == FireModOptions)// 9 FireModOptions   
        {                                                     
            if(f_toggle == 0)                                                             
                printf(center_x(sizeof(ModOption_31_0)  - 1, OLED_FONT_MEDIUM_WIDTH),37,OLED_FONT_MEDIUM,OLED_WHITE, ModOption_31_0[0]);// Disable
                                                                                                                           
            if(f_toggle == 1)                                                             
                printf(center_x(sizeof(ModOption_31_1)  - 1, OLED_FONT_MEDIUM_WIDTH),37,OLED_FONT_MEDIUM,OLED_WHITE, ModOption_31_1[0]);// Fire Only
                                                                                                                           
            if(f_toggle == 2)                                                             
                printf(center_x(sizeof(ModOption_31_2)  - 1, OLED_FONT_MEDIUM_WIDTH),37,OLED_FONT_MEDIUM,OLED_WHITE, ModOption_31_2[0]);// ADS & Fire
                                                                                                                 
            if(f_toggle == 3)                                                             
                printf(center_x(sizeof(ModOption_31_4)  - 1, OLED_FONT_MEDIUM_WIDTH),37,OLED_FONT_MEDIUM,OLED_WHITE, ModOption_31_4[0]);// On Fire
                                                                                                                 
        }         

        if(f_option == 56)   
        {                                                     
            if(f_toggle == 0)                                                             
                printf(center_x(sizeof(ModOption_56_0)  - 1, OLED_FONT_MEDIUM_WIDTH),37,OLED_FONT_MEDIUM,OLED_WHITE, ModOption_56_0[0]);// Disabled
                                                                                                                           
            if(f_toggle == 1)                                                             
                printf(center_x(sizeof(ModOption_56_1)  - 1, OLED_FONT_MEDIUM_WIDTH),37,OLED_FONT_MEDIUM,OLED_WHITE, ModOption_56_1[0]);// Profile 1
                                                                                                                           
            if(f_toggle == 2)                                                             
                printf(center_x(sizeof(ModOption_56_2)  - 1, OLED_FONT_MEDIUM_WIDTH),37,OLED_FONT_MEDIUM,OLED_WHITE, ModOption_56_2[0]);// Profile 2
                                                                                                                           
            if(f_toggle == 3)                                                             
                printf(center_x(sizeof(ModOption_56_3)  - 1, OLED_FONT_MEDIUM_WIDTH),37,OLED_FONT_MEDIUM,OLED_WHITE, ModOption_56_3[0]);// Profile 3
                                                                                                                           
            if(f_toggle == 4)                                                             
                printf(center_x(sizeof(ModOption_56_4)  - 1, OLED_FONT_MEDIUM_WIDTH),37,OLED_FONT_MEDIUM,OLED_WHITE, ModOption_56_4[0]);// Profile 4
                                                                                                                           
            if(f_toggle == 5)                                                             
                printf(center_x(sizeof(ModOption_56_5)  - 1, OLED_FONT_MEDIUM_WIDTH),37,OLED_FONT_MEDIUM,OLED_WHITE, ModOption_56_5[0]);// Profile 5
                                                                                                                           
        }            
}//display mod end           
/*     
======================================================
     Logo Picture : WARZONE
======================================================
*/                                                    
                               
 const int16 BOOT_LOGO[] = { 
127, 52,
    0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,
    0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,
    0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,
    0xFFFF,0xFFF0,0xC119,0xF064,0x0067,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFCC,0x8233,0xE449,0x861F,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFF99,0x0464,0x4C93,0x9C3F,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFF3E,0x48C8,0x9927,0x387F,0xFFFF,0xFFFF,0xFFFF,
    0xFFFF,0xFE7C,0x919F,0x324E,0x79FF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFCC8,0x233E,0x649C,0xF3FF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xF990,0x467C,0x8839,0xE7FF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xF864,0x8438,0x3073,0xCFFF,0xFFFF,0xFFFF,0xFFFF,
    0xFFFF,0xF9FF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFF0,0x780E,0x0700,0x7800,0x1E00,0x01E0,0x03C0,0xF030,0x0060,0xF01C,0x0C00,0xF000,0x0C00,0x0380,0x0181,0xE060,0x00C1,0xE038,
    0x1801,0xF000,0x1800,0x0600,0x0303,0xC0C0,0x0183,0xC030,0x3003,0xE000,0x3000,0x0C00,0x0603,0x8180,0x0303,0x0060,0x6007,0xC000,0x6000,0x1800,0x0C07,0x0300,0x0606,0x00C0,0xC00F,0x81C0,0xC000,0x3038,0x180E,0x0600,0x0C0C,0x0181,
    0x801F,0x0381,0xFFC0,0x6070,0x300C,0x0C0F,0xF818,0x0302,0x001E,0x0703,0xFF01,0xC0E0,0x6018,0x181F,0xF030,0x0604,0x003C,0x0E07,0xFE03,0x81C0,0xC030,0x303F,0xE060,0x0C18,0x3078,0x1C0F,0xF80F,0x0381,0x8020,0x607F,0xC0C0,0x1830,
    0x60F0,0x381F,0xF01E,0x0703,0x0060,0xC0FF,0x8180,0x3060,0xC1E0,0x703F,0xE07C,0x0E06,0x00C1,0x81FF,0x8308,0x60C1,0x83C0,0xE07F,0x80F8,0x1C0C,0x0003,0x000F,0x0410,0xC183,0x0380,0x00FF,0x03F0,0x3818,0x0006,0x001E,0x0821,0x8306,
    0x0700,0x01FC,0x07E0,0x7030,0x000C,0x003C,0x1042,0x040C,0x0E00,0x0FF8,0x1FC0,0xE060,0x0018,0x0078,0x2080,0x0818,0x1C00,0x1FE0,0x3F81,0xC0C0,0x0030,0x00F0,0x0300,0x3030,0x3800,0x3FC0,0xFF03,0x8183,0x0060,0x01E0,0x0600,0x6000,
    0x7020,0x3F01,0xFE07,0x0306,0x00C0,0xFFC0,0x0C00,0xC000,0xE040,0x7E07,0xFC0E,0x0604,0x0181,0xFFC0,0x1801,0x8000,0xC0C0,0xF80F,0xF81C,0x0C08,0x0303,0xFF80,0x3002,0x0001,0x8180,0xF01F,0xF038,0x1818,0x0607,0xFF00,0x6004,0x0003,
    0x0301,0xC07F,0xE070,0x3030,0x0C0F,0xFE00,0xC008,0x0006,0x0703,0x80FF,0xC0E0,0x6060,0x181F,0xFC01,0x8030,0x3C0C,0x0E02,0x0001,0x8080,0xC0E0,0x3000,0x7803,0x8060,0x7818,0x1C04,0x0003,0x0001,0x81C0,0x6000,0xF007,0x00C0,0xF030,
    0x3C08,0x0006,0x0003,0x0380,0xC001,0xF00E,0x0181,0xE060,0x7810,0x000C,0x0006,0x0781,0x8003,0xE01C,0x0303,0xC0C0,0xF020,0x001C,0x001C,0x0F03,0x0007,0xC078,0x0607,0x8181,0xF060,0x003C,0x0078,0x3E06,0x0000
 } // picture 
/*     
======================================================
     DrawLogo(x, y, invert)                            
====================================================== 
*/                                                    
int logoX,logoX2,logoY, logoY2;                       
int logoBit,logoOffset,logoData;                      
                                                      
function DrawLogo(x, y, invert) {                     
    logoOffset = 2;                                    
    logoBit = 16;                                           
    for (logoY = 0; logoY < BOOT_LOGO[1]; logoY++) {         // Loop the Y axis 
        for (logoX = 0; logoX < BOOT_LOGO[0]; logoX++) {     // Loop the X axis 
            logoData = BOOT_LOGO[logoOffset]          
            logoX2 = x + logoX;                       
            logoY2 = y + logoY;                       
            if (logoX2 < 0 || logoX2 >= 128) {        
                logoX2 -= 128;                        
            }                                         
            if (logoY2 < 0 || logoY2 >= 64) {         
                logoY2 -= 64;                         
            }                                         
            if (test_bit(logoData, logoBit - 1)) {     
                pixel_oled(logoX2, logoY2, !invert);   
            }else{                                     
                pixel_oled(logoX2, logoY2, invert);    
            }                                            
            logoBit--;             // Decrement the bit flag, we are moving to the next bit 
            if (!logoBit) {     // Check if we have just handled the last bit  
                logoBit = 16;     // Reset the bit flag     
                logoOffset++;     // Move to the next value 
            }  
        }   
    }    
}     
      
const uint8 MenuButtons [] = {  
  PS4_LEFT , //0. Up
  PS4_RIGHT , //1. Down
  PS4_UP , //2. go back
  PS4_DOWN , //3. go forward
  PS4_CROSS , //4. enter in Edit Menu
  PS4_CIRCLE , //5. exit  Menu
  PS4_OPTIONS , //5. enter in  Menu
  PS4_L2     //6. hold ADS
};//--- End Menu Buttons  

int menu_btn_indx;
int MenuTimeOut;
define menu_time_active = 30000;
function CheckIfBtnIsPressed (){  
    for(menu_btn_indx = 0; menu_btn_indx < 7; menu_btn_indx++){
         if(event_press(MenuButtons[menu_btn_indx]) ){
             MenuTimeOut = menu_time_active;
         }
         if(MenuTimeOut){              
            MenuTimeOut -=1;
            if(MenuTimeOut <= 0 ){    
                ModMenu = FALSE;      
                ModEdit = FALSE;      
                display_EDIT  = FALSE; 
                display_black = TRUE; 
            }
        }
    }
}

function display_MOD_status(f_val,f_size,f_label){  
    if(!ModMenu && !ModEdit){                                           
        // Clear OLED Screen                          
        cls_oled(0); // will clear oled   
        printf(f_size, 3, OLED_FONT_MEDIUM ,OLED_WHITE, f_label);   
        if( f_val ){
            printf(center_x(sizeof(ON)  - 1, OLED_FONT_LARGE_WIDTH),37,OLED_FONT_LARGE,OLED_WHITE, ON[0]);//MOD is ON
        }
        else{
            printf(center_x(sizeof(OFF) - 1, OLED_FONT_LARGE_WIDTH),37,OLED_FONT_LARGE,OLED_WHITE, OFF[0]);// MOD is OFF
        }    
        time_to_clear_screen = 1500; 
    } 
}
//===============================================================
//    BUTTON LAYOUT                                              
//===============================================================

define UP             = PS4_UP;
define RIGHT          = PS4_RIGHT;
define DOWN           = PS4_DOWN;
define LEFT           = PS4_LEFT;

int BTN_FIRE,BTN_AIM,BTN_LETHAL,BTN_TACTICAL,BTN_JUMP,BTN_SWAP,BTN_RELOAD,BTN_CROUCH,BTN_MELEE,BTN_SPRINT,walk,strafe,aim_x,aim_y;

function Run_Button_Configs(){
	
	BTN_FIRE     = ButtonLayout[BUTTON_LAYOUT][0];
	BTN_AIM      = ButtonLayout[BUTTON_LAYOUT][1];
	
	BTN_LETHAL   = ButtonLayout[BUTTON_LAYOUT][2];
	BTN_TACTICAL = ButtonLayout[BUTTON_LAYOUT][3];
	
	BTN_JUMP     = ButtonLayout[BUTTON_LAYOUT][4];
	BTN_SWAP     = ButtonLayout[BUTTON_LAYOUT][5];
	BTN_RELOAD   = ButtonLayout[BUTTON_LAYOUT][6];
	BTN_CROUCH   = ButtonLayout[BUTTON_LAYOUT][7];
	BTN_MELEE    = ButtonLayout[BUTTON_LAYOUT][8];
	BTN_SPRINT   = ButtonLayout[BUTTON_LAYOUT][9];
	
	walk         = StickLayout[STICK_LAYOUT][0];
	strafe       = StickLayout[STICK_LAYOUT][1];
	aim_y        = StickLayout[STICK_LAYOUT][2];
	aim_x        = StickLayout[STICK_LAYOUT][3];}
	
const int16 StickLayout[][] = {            
	//Walk,     Strafe, AimY,    AimX    
	{ XB1_LY,     XB1_LX, XB1_RY, XB1_RX },    // DEFAULT
	{ XB1_RY,     XB1_RX, XB1_LY, XB1_LX },    // SOUTHPAW
	{ XB1_LY,     XB1_RX, XB1_RY, XB1_LX },    // LEGACY
	{ XB1_RY,     XB1_LX, XB1_LY, XB1_RX },    // LEGACY SOUTHPAW
	{ XB1_RY,     XB1_RX, XB1_LY, XB1_LX },    // SOUTHPAW NO CLICK SWAP
	{ XB1_RY,     XB1_LX, XB1_LY, XB1_RX }};   // LEGACY SOUTHPAW NO CLICK SWAP

const int16 ButtonLayout[][] = {            
	//Fire       ads        LETHAL        TACTICAL        JUMP     SWITCH        RELOAD     CROUCH  MELEE   SPRINT
	{ XB1_RT,   XB1_LT,    XB1_RB,        XB1_LB,        XB1_A,    XB1_Y,        XB1_X,     XB1_B,  XB1_RS, XB1_LS  },     // DEFAULT
	{ XB1_RT,   XB1_LT,    XB1_RB,        XB1_LB,        XB1_A,    XB1_Y,        XB1_X,     XB1_RS, XB1_B,  XB1_LS  },     // TACTICAL
	{ XB1_LT,   XB1_RT,    XB1_LB,        XB1_RB,        XB1_A,    XB1_Y,        XB1_X,     XB1_B,  XB1_LS, XB1_RS  },     // LEFTY
	{ XB1_RT,   XB1_RB,    XB1_LT,        XB1_LB,        XB1_A,    XB1_Y,        XB1_X,     XB1_B,  XB1_RS, XB1_LS  },     // N0M4D/CHARLIE
	{ XB1_RT,   XB1_RB,    XB1_LT,        XB1_LB,        XB1_A,    XB1_Y,        XB1_X,     XB1_RS, XB1_B,  XB1_LS  },     // N0M4D/CHARLIE TACTICAL
	{ XB1_LT,   XB1_LB,    XB1_RT,        XB1_RB,        XB1_A,    XB1_Y,        XB1_X,     XB1_B,  XB1_LS, XB1_RS  },     // N0M4D/CHARLIE L3F7Y
	{ XB1_RT,   XB1_LT,    XB1_RB,        XB1_A,        XB1_LB,    XB1_Y,        XB1_X,     XB1_B,  XB1_RS, XB1_LS  },     // BUMPER JUMPER
	{ XB1_RT,   XB1_LT,    XB1_RB,        XB1_A,        XB1_LB,    XB1_Y,        XB1_X,     XB1_RS, XB1_B,  XB1_LS  },     // BUMPER JUMPER TACTICAL
	{ XB1_LB,   XB1_LT,    XB1_RT,        XB1_RB,        XB1_A,    XB1_Y,        XB1_X,     XB1_B,  XB1_RS, XB1_LS  },     // ONE-HAND GUNSLINGER
	{ XB1_RT,   XB1_LT,    XB1_RB,        XB1_LB,       XB1_RS,    XB1_Y,        XB1_X,     XB1_B,  XB1_A,  XB1_LS  },     // STICK AND MOVE
	{ XB1_RT,   XB1_LT,    XB1_RB,        XB1_LB,        XB1_A,    XB1_Y,        XB1_X,     XB1_B,  XB1_RS, XB1_LS  },     // BRAWLER
	{ XB1_RT,   XB1_LT,    XB1_RS,        XB1_A,        XB1_LB,    XB1_Y,        XB1_X,     XB1_B,  XB1_RB, XB1_LS  },     // BEAST
	{ XB1_RB,   XB1_LB,    XB1_RT,        XB1_LT,        XB1_A,    XB1_Y,        XB1_X,     XB1_B,  XB1_RS, XB1_LS  },     // DEFAULT SWAPPED
	{ XB1_RB,   XB1_LB,    XB1_RT,        XB1_LT,        XB1_A,    XB1_Y,        XB1_X,     XB1_RS, XB1_B,  XB1_LS  },     // TACTICAL SWAPPED 
	{ XB1_RB,   XB1_LB,    XB1_RT,        XB1_A,        XB1_LB,    XB1_Y,        XB1_X,     XB1_B,  XB1_RS, XB1_LS  },     // BUMPER JUMPER SWAPPED 
	{ XB1_RB,   XB1_LB,    XB1_RT,        XB1_A,        XB1_LB,    XB1_Y,        XB1_X,     XB1_RS, XB1_B,  XB1_LS  },     // BUMPER JUMPER TACTICAL SWAPPED 
	{ XB1_RB,   XB1_LB,    XB1_RT,        XB1_LT,       XB1_RS,    XB1_Y,        XB1_X,     XB1_B,  XB1_A,  XB1_LS  },     // STICK AND MOVE SWAPPED
	{ XB1_RB,   XB1_LB,    XB1_RT,        XB1_LT,        XB1_A,    XB1_Y,        XB1_X,     XB1_RS, XB1_B,  XB1_LS  }};    // TACTICAL SWAPPED
	
	 