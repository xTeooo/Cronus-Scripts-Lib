/*
									_________           __    __    ________     _____  ________            __           
									\_   ___ \ _____   |  |  |  |   \_____  \  _/ ____\ \______ \   __ __ _/  |_  ___ __ 
									/    \  \/ \__  \  |  |  |  |    /   |   \ \   __\   |    |  \ |  |  \\   __\<   |  |
									\     \____ / __ \_|  |__|  |__ /    |    \ |  |     |    `   \|  |  / |  |   \___  |
									 \______  /(____  /|____/|____/ \_______  / |__|    /_______  /|____/  |__|   / ____|
									        \/      \/                      \/                  \/                \/  
													  _________ __                          __         
													 /   _____/|__|  ____  _____   _______ |__|  ____  
													 \_____  \ |  |_/ ___\ \__  \  \_  __ \|  | /  _ \ 
													 /        \|  |\  \___  / __ \_ |  | \/|  |(  <_> ) ZEN Edition v1.01 
													/_______  /|__| \___  >(____  / |__|   |__| \____/ 
													        \/          \/      \/  
											  				
											  				TD21 Team - Alpha Testers - Beta Testers 

Creators Credit = 								DoGzTheFiGhTeR - DoNotAtMe - Batts - Excalibur - Swizzy - Noozbar

												

								/*------------------------------- INSTRUCTIONS PLEASE READ ------------------------------------------
								=====================================================================================================
								Enter Mod Menu   							= HOLD ADS & OPTIONS  
								-----------------------------------------------------------------------------------------------------
								Exit Menu                                   = CIRCLE/B 
								-----------------------------------------------------------------------------------------------------
								Enter Edit Menu To Change Values            = CROSS/A 
								-----------------------------------------------------------------------------------------------------
								Exit Edit Menu To Mod Menu                  = CIRCLE/B
								-----------------------------------------------------------------------------------------------------
								Enable/Disable Drive Mode                   = HOLD FIRE & Double Tap Right / Press Square TO Disable
								-----------------------------------------------------------------------------------------------------
								Change Profiles In The Menu                 = TRIANGLE/Y
								-----------------------------------------------------------------------------------------------------
								Change Values In Edit Menu                  = HOLD ADS & LEFT OR RIGHT OR UP OR DOWN
								-----------------------------------------------------------------------------------------------------
								Turn Mods On/Off                            = PRESS UP / DOWN TO CYCLE TOGGLE OPTIONS IF APPLICABLE
								-----------------------------------------------------------------------------------------------------
								Navigate The Main Menu                      = PRESS UP / DOWN 
								-----------------------------------------------------------------------------------------------------
								Navigate Mod Menu & Edit Menu               = PRESS LEFT / RIGHT 
								-----------------------------------------------------------------------------------------------------
								Choosing Buttons For Profiles/QuickToggles  = HOLD ADS & PRESS LEFT OR RIGHT 
								-----------------------------------------------------------------------------------------------------
								====================================================================================================*/


const int8 PolarArray[] = { -100,-100,-100,-100,-100,-100,-100,-100,-100,-99,-99,-99,-98,-98,-98,-97,-97,-96,-96,-95,-94,-94,-93,-93,-92,-91,-90,-90,-89,-88,-87,-86,-85,-84,-83,-82,-81,-80,-79,-78,-77,-76,-75,-74,-72,-71,-70,-69,-67,-66,-65,-63,-62,-61,-59,-58,-56,-55,-53,-52,-50,-49,-47,-46,-44,-43,-41,-40,-38,-36,-35,-33,-31,-30,-28,-26,-25,-23,-21,-20,-18,-16,-14,-13,-11,-9,-7,-6,-4,-2,0,2,4,6,7,9,11,13,14,16,18,20,21,23,25,26,28,30,31,33,35,36,38,40,41,43,44,46,47,49,51,52,54,55,56,58,59,61,62,63,65,66,67,69,70,70,72,73,74,75,77,78,79,80,81,82,83,84,85,86,87,88,89,89,90,91,92,92,93,94,94,95,95,96,97,97,97,98,98,99,99,99,99,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,99,99,99,99,98,98,97,97,97,96,95,95,94,94,93,92,92,91,90,89,89,88,87,86,85,84,83,82,81,80,79,78,77,75,74,73,72,71,70,69,67,66,65,63,62,61,59,58,56,55,53,52,50,49,47,46,44,43,41,40,38,36,35,33,31,30,28,26,25,23,21,20,18,16,14,13,11,9,7,6,4,2,0,-1,-3,-5,-7,-8,-10,-12,-13,-15,-17,-19,-20,-22,-24,-25,-27,-29,-30,-32,-34,-35,-37,-39,-40,-42,-43,-45,-46,-48,-50,-51,-53,-54,-55,-57,-58,-60,-61,-62,-64,-65,-66,-68,-69,-70,-71,-73,-74,-75,-76,-77,-78,-79,-80,-81,-82,-83,-84,-85,-86,-87,-88,-89,-89,-90,-91,-92,-92,-93,-93,-94,-95,-95,-96,-96,-97,-97,-97,-98,-98,-99,-99,-99,-99,-100,-100,-100,-100,-100};
const int8 LinearArray[] = { 100,-100,-99,-98,-97,-96,-95,-94,-93,-91,-90,-89,-88,-87,-86,-85,-84,-82,-81,-80,-79,-78,-77,-76,-75,-73,-72,-71,-70,-69,-68,-67,-66,-64,-63,-62,-61,-60,-59,-58,-57,-55,-54,-53,-52,-51,-50,-49,-48,-46,-45,-44,-43,-42,-41,-40,-39,-37,-36,-35,-34,-33,-32,-31,-30,-28,-27,-26,-25,-24,-23,-22,-21,-19,-18,-17,-16,-15,-14,-13,-12,-10,-9,-8,-7,-6,-5,-4,-3,-11,2,3,4,5,6,7,8,10,11,12,13,14,15,16,17,19,20,21,22,23,24,25,26,28,29,30,31,32,33,34,35,37,38,39,40,41,42,43,44,46,47,48,49,50,51,52,53,55,56,57,58,59,60,61,62,64,65,66,67,68,69,70,71,73,74,75,76,77,78,79,80,82,83,84,85,86,87,88,89,91,92,93,94,95,96,97,98,100,100,100,99,98,97,96,95,94,93,91,90,89,88,87,86,85,84,82,81,80,79,78,77,76,75,73,72,71,70,69,68,67,66,64,63,62,61,60,59,58,57,55,54,53,52,51,50,49,48,46,45,44,43,42,41,40,39,37,36,35,34,33,32,31,30,28,27,26,25,24,23,22,21,19,18,17,16,15,14,13,12,10,9,8,7,6,5,4,3,1,-1,-1,-2,-3,-4,-5,-6,-7,-8,-10,-11,-12,-13,-14,-15,-16,-17,-19,-20,-21,-22,-23,-24,-25,-26,-28,-29,-30,-31,-32,-33,-34,-35,-37,-38,-39,-40,-41,-42,-43,-44,-46,-47,-48,-49,-50,-51,-52,-53,-55,-56,-57,-58,-59,-60,-61,-62,-64,-65,-66,-67,-68,-69,-70,-71,-73,-74,-75,-76,-77,-78,-79,-80,-82,-83,-84,-85,-86,-87,-88,-89,-91,-92,-93,-94,-95,-96,-97,-98,-100};

const string MainMenuId[] = {"AR + AA","Shot Mods","Misc Mods","Settings","QuickToggles",""};
// Display Mods In the OLED Menu \\
const string ModNames[] = {"Choose AR","Progressive AR","Taylor AA","Batts StickyAim","TD HeadShot AA ","Speed Strafe","Rapid Fire","Burst Fire","StrafeShot","Cancel Reload","Custom Sens","Cancel Slide","HoldBreath",
//                              0              1             2             3                 4                 5              6            7           8              9             10              11            12     
"BunnyHop","Insta Prone","AutoAim","Crouch Shot","Jump Shot","Fast Melee","Vm Speed","Enemy Ping","Sniper/HGun Mode","Controller Layout","Block Rumble","Profile Btn","Resync Btns","Custom Profile","Rapid Fire","Sniper/HGun Mode",
// 13            14         15          16           17         18           19           20             21                 22                 23            24             25             26              27             28                    
"StrafeShot","Jump Shot","RecoilOnTheFly","Custom Name",""} 
//   29          30            31               32
// Display Editable Values In The OLED Menu \\
const string ValNames[]  = { "V Strength","H Strength","V Start","V Mid","V End","V Time","H Start","H Mid","H End","H Time","AA Type","Choose Shape","Shape Direction","Ads Speed","Speed","Ads Radius","Radius",       
//                                0             1          2        3       4       5         6         7      8       9        10           11              12             13        14         15         16                        
"Boost On Fire","Boost Str","Boost Spd","Taylor Tracking","Tracking Size","Tracking Speed","Smoothing","Sticky Size","Sticky Time","HeadShot Str","Hold Time","Active Time","Rounds/Sec","Hold Time","Release Time","StrafeTime",
//    17             18          19            20                21               22           23            24            25            26            27          28             29          30            31            32     
"Reload Time","General","Ads","Fire","AdsFire","Slide Delay","CrouchSpeed","StrafeSpeed","Ping Delay","AR VertStrength","Speed","Radius","Auto Rapid Fire","Auto Hold Breath",""}
//     33         34      35    36      37          38            39            40            41              42           43      44            45                 46         
// Display Misc Strings Used Throughout The Menu Including Combo's \\Yes
const string Misc[]     = {"On","Off","Primary","Secondary","Custom Profile","All Profiles","Controller","Prim/Sec","< Quick Toggles >","Call Of Duty","Sicario","Sniper/HGun Mode","Activated",
 //                          0    1       2          3              4              5              6           7              8                 9           10           11               12            
"Drive Mode","Deactivated","Disables Prim/Sec","Rapid Fire Only","Saved","FinalTest","Controller","Remap","Select Buttons","Hold Ads To Change",""};
 //  13            14               15                16            17            18           19         20          21           

const string ProgAR[]          = {"Off","Standard","Rumble",""};

const string CrouchSht[]       = {"Off","Legacy Crouch","Rapid C.Shot","R.C.Shot + Strafe",""}; 

const string Profiles[]        = {"Primary","Secondary","Custom Profile",""}; 

const string ARToggle[]        = {"Choose AR","Legacy AR","Rumble AR",""} ;

const string AAToggle[]        = {"Choose AA","AA V4","AA V5","V5 + Spd Boost",""}; 

const string RFToggle[]        = {"Fire Only","Ads + Bumper",""}; 

const string SlideType[]       = {"Off","Mw/Vanguard","ColdWar",""};

const string VMSpeed[]         = {"0","-2","-4","-6","-8","-9",""};

const string CurveType[]       = {"Polar","Linear",""};

const string CircularCurve[]   = {"Circular","Tall Oval","Wide Oval","Vortex Oval","Spiral","Helix","KITT","Vertical Flare","Tartan Army","Jupiter","Bishop","Blade",""};

const string SquareCurve[]     = {"Diamond","Tall Diamond","Wide Diamond","Spiral Prism","Spiral Diamond","Helix Diamond","KITT","Vertical Flare","Tartan Army","Jupiter","Bishop","Blade",""}; 

const string PressButtons[]    = { "Select","Triangle/Y","Dpad Down","Dpad UP","Dpad Left","Dpad Right","Cross/A","Circle/B","Square/X", ""};

const string HoldButtons[]     = { "Select","L2/LT","R2/RT","L1/LB","R1/RB","L3/LS","R3/RS","Dpad Down","Dpad Up","Dpad Left","Dpad Right", ""};

const int8   HoldBtns []       = { -1,  PS4_L2  ,PS4_R2  , PS4_L1, PS4_R1  , PS4_L3   , PS4_R3 ,PS4_DOWN,PS4_UP,PS4_LEFT,PS4_RIGHT}; 

const int8   PressBtns[]       = { -1,  PS4_TRIANGLE,PS4_DOWN, PS4_UP, PS4_LEFT, PS4_RIGHT, PS4_CROSS, PS4_CIRCLE, PS4_SQUARE };

const string ControllerLayouts[] = { "Default", "Tactical", "Lefty", "N0M4D/Charlie", "N0M4D/Charlie Tac", "N0M4D/Charlie Left", "Bumper Jumper", "Bumper Jumper Tac", "1-Hand Gunslinger", "Stick & Move", 
"Brawler", "Beast","Bumper Ping","Bumper Ping Tac", "Default Flipped","Tactical Flipped", "B.Jumper Flipped", "B.JumprTac Flipped", "Stick&Move Flipped","Beasty Swapped","B.Ping Flipped","B.Ping.Tac.Flipped",""}


const uint8  ModRange   [][]   = { 
{   0 ,  5 , 1}, // N/A     \\
{   6 ,  9 , 1}, // Main  1 \\
{  10 , 21 , 1}, // Main  2 \\
{  22 , 26 , 1}, // Main  3 \\
{  27 , 32 , 1}  // Main  3 \\
};
const uint8 ModsNToggles[][] = {
// ModIdx - MinToggle - MaxToggle - ValRangeMin - ValRangeMax - Editable - Profile 
//    0         1           2            3             4            5         6    \\
{     0   ,     0     ,     2     ,      0      ,      1      ,     1    ,    1  },// Leg/Rum AR  \\
{     1   ,     0     ,     2     ,      2      ,      9      ,     1    ,    1  },// Progressive \\
{     2   ,     0     ,     3     ,     10      ,     23      ,     1    ,    0  },// TaylorAA    \\
{     3   ,     0     ,     1     ,     24      ,     25      ,     1    ,    0  },// BattsAA     \\
{     4   ,     0     ,     1     ,     26      ,     27      ,     1    ,    0  },// HeadShot    \\
{     5   ,     0     ,     1     ,     28      ,     28      ,     1    ,    1  },// SpeedStrafe \\
{     6   ,     0     ,     1     ,     29      ,     29      ,     1    ,    1  },// RapidFire   \\
{     7   ,     0     ,     1     ,     30      ,     31      ,     1    ,    1  },// BurstFire   \\
{     8   ,     0     ,     1     ,     32      ,     32      ,     1    ,    1  },// StrafeShot  \\
{     9   ,     0     ,     1     ,     33      ,     33      ,     1    ,    0  },// CancelReload\\
{    10   ,     0     ,     1     ,     34      ,     37      ,     1    ,    0  },// CustomSens  \\
{    11   ,     0     ,     2     ,     38      ,     38      ,     1    ,    0  },// CancelSlide \\
{    12   ,     0     ,     1     ,      0      ,      0      ,     0    ,    1  },// HoldBreath  \\
{    13   ,     0     ,     1     ,      0      ,      0      ,     0    ,    0  },// BunnyHop    \\
{    14   ,     0     ,     1     ,      0      ,      0      ,     0    ,    1  },// Quick Drop  \\
{    15   ,     0     ,     1     ,      0      ,      0      ,     0    ,    1  },// Auto Aim    \\
{    16   ,     0     ,     3     ,     39      ,     40      ,     1    ,    1  },// CrouchMods  \\
{    17   ,     0     ,     1     ,      0      ,      0      ,     0    ,    1  },// JumpShot    \\
{    18   ,     0     ,     1     ,      0      ,      0      ,     0    ,    1  },// FastMelee   \\
{    19   ,     0     ,     5     ,      0      ,      0      ,     0    ,    0  },// VmSpeed     \\
{    20   ,     0     ,     1     ,     41      ,     41      ,     1    ,    0  },// EnemyPing   \\ 
{    21   ,     0     ,     1     ,     42      ,     46      ,     1    ,    1  },// SniperMode  \\
{    22   ,     0     ,    21     ,      0      ,      0      ,     0    ,    2  },// CtrlrLayout \\
{    23   ,     0     ,     1     ,      0      ,      0      ,     0    ,    2  },// BlockRumble \\
{    24   ,     0     ,     8     ,      0      ,      0      ,     0    ,    3  },// ProfileBtn  \\
{    25   ,     0     ,     0     ,      0      ,      0      ,     0    ,    3  },// ResyncBtn   \\
{    26   ,     0     ,     0     ,      0      ,      0      ,     0    ,    4  },// WarzonePro  \\
{    27   ,     0     ,     0     ,      0      ,      0      ,     0    ,    5  },// RapidQT     \\
{    28   ,     0     ,     0     ,      0      ,      0      ,     0    ,    5  },// SniperQT    \\
{    29   ,     0     ,     0     ,      0      ,      0      ,     0    ,    5  },// ProneQT     \\
{    30   ,     0     ,     0     ,      0      ,      0      ,     0    ,    5  },// JumpShotQT  \\
{    31   ,     0     ,     0     ,      0      ,      0      ,     0    ,    5  }, // RecoilQT    \\
{    32   ,     0     ,     0     ,      0      ,      0      ,     0    ,    6  } // RecoilQT    \\
};

const int16 ValRangeMinMax [][] = {
// ValIdx - MinValue - MaxValue - IncrementMin - IncrementMax - Profile \\
//    0        1          2             3              4           5         \\    
{     0   ,  -99     ,   99     ,       1      ,      10      ,    1      }, // Vert       \\
{     1   ,  -99     ,   99     ,       1      ,      10      ,    1      }, // Horiz      \\
{     2   ,  -99     ,   99     ,       1      ,      10      ,    1      }, // VertStart  \\
{     3   ,  -99     ,   99     ,       1      ,      10      ,    1      }, // VertMid    \\
{     4   ,  -99     ,   99     ,       1      ,      10      ,    1      }, // VertEnd    \\
{     5   ,    0     ,   99     ,       1      ,      10      ,    1      }, // VertTime   \\
{     6   ,  -99     ,   99     ,       1      ,      10      ,    1      }, // VertStart  \\
{     7   ,  -99     ,   99     ,       1      ,      10      ,    1      }, // VertMid    \\
{     8   ,  -99     ,   99     ,       1      ,      10      ,    1      }, // VertEnd    \\
{     9   ,    0     ,   99     ,       1      ,      10      ,    1      }, // VertTime   \\
{    10   ,    0     ,    1     ,       1      ,       1      ,    0      }, // AAType     \\
{    11   ,    0     ,   11     ,       1      ,       1      ,    0      }, // AAShape    \\
{    12   ,    0     ,    1     ,       1      ,       1      ,    0      }, // ShapeDir   \\
{    13   ,    0     ,   99     ,       1      ,      10      ,    0      }, // AdsSpeed   \\
{    14   ,    0     ,   99     ,       1      ,      10      ,    0      }, // SpeedAA    \\
{    15   ,    0     ,   99     ,       1      ,      10      ,    0      }, // AdsRadius  \\
{    16   ,    0     ,   99     ,       1      ,      10      ,    0      }, // RadiusAA   \\
{    17   ,    0     ,    1     ,       1      ,       1      ,    0      }, // BoostFire  \\
{    18   ,    0     ,   40     ,       1      ,      10      ,    0      }, // Boost Str  \\
{    19   ,    0     ,   40     ,       1      ,      10      ,    0      }, // Boost Spd  \\
{    20   ,    0     ,    1     ,       1      ,       1      ,    0      }, // TrackTog   \\
{    21   ,    0     ,    8     ,       1      ,       1      ,    0      }, // TrackSize  \\
{    22   ,    0     ,    8     ,       1      ,       1      ,    0      }, // TrackSpeed \\
{    23   ,    0     ,   99     ,       1      ,      10      ,    0      }, // Smoothing  \\
{    24   ,    0     ,   99     ,       1      ,      10      ,    0      }, // StickySize \\
{    25   ,    0     ,   99     ,       1      ,      10      ,    0      }, // StickyTime \\
{    26   ,    0     ,   99     ,       1      ,      10      ,    0      }, // HeadShotStr\\
{    27   ,    0     , 2000     ,       1      ,     100      ,    0      }, // HeadShotHld\\
{    28   ,    0     , 2000     ,       1      ,     100      ,    0      }, // ActiveTime \\
{    29   ,    0     ,   25     ,       1      ,      10      ,    1      }, // RateOfFire \\
{    30   ,    0     ,  990     ,      10      ,     100      ,    0      }, // HoldTime   \\
{    31   ,    0     ,  990     ,      10      ,     100      ,    0      }, // ReleaseTime\\
{    32   ,    0     ,  990     ,      10      ,     100      ,    0      }, // StrafeTime \\
{    33   ,    0     , 5000     ,      10      ,     100      ,    0      }, // ReleoadTime\\
{    34   ,    0     ,  327     ,       1      ,      10      ,    0      }, // GeneralSens\\
{    35   ,    0     ,  327     ,       1      ,      10      ,    0      }, // AdsSens    \\
{    36   ,    0     ,  327     ,       1      ,      10      ,    0      }, // FireSens   \\
{    37   ,    0     ,  327     ,       1      ,      10      ,    0      }, // AdsFireSens\\
{    38   ,    0     ,  200     ,       1      ,      10      ,    0      }, // SlideDelay \\
{    39   ,    0     ,  200     ,       1      ,      10      ,    0      }, // CrouchSpeed\\
{    40   ,    0     ,  990     ,      10      ,     100      ,    0      }, // StrafeTime \\
{    41   ,    0     , 5000     ,      10      ,     100      ,    0      }, // PingDelay  \\
{    42   ,  -99     ,   99     ,       1      ,      10      ,    2      }, //VertHandGun \\
{    43   ,    0     ,   99     ,       1      ,      10      ,    2      }, //VertHandGun \\
{    44   ,    0     ,   99     ,       1      ,      10      ,    2      }, //VertHandGun \\
{    45   ,    0     ,    1     ,       1      ,       1      ,    2      }, // AutoRF     \\
{    46   ,    0     ,    1     ,       1      ,       1      ,    2      }  // AutoHB     \\
}
int ModIdx;
int ValIdx;
int ModORVal                  [3]  ;
int ModOrEditMenu             [4]  ;
int DisplayMenu;
// Mod Menu Variables Toggles \\
int ToggleTaylorAR[3];
int ToggleProgressive[3];
int ToggleTaylorAA; 
int ToggleBattsStickyAim;
int HeadAssist;
int ToggleRapidFire[3];
int ToggleBurstFire[3];
int ToggleStrafeShot[3];
int ToggleSpeedStrafe[3]; 
int ToggleCancelReload;
int ToggleTaylorSens;
int ToggleCancelSlide;
int ToggleHoldBreath[3];
int ToggleBunnyHop;
int ToggleProneShot[3];
int ToggleAutoAim[3];
int ToggleJumpShot[3];
int ToggleFastMelee[3];
int ToggleVmSpeed;
int ToggleCrouchShot[3];
int ToggleEnemyPing;
int ToggleSniperMode[3];
int Buttons;
int ToggleBlockRumble;
int ActivateIndividualButton = 0;
define ActivateButtonCount = 8;
int ActivateHoldButton[ActivateButtonCount];
int ActivatePressButton[ActivateButtonCount];
int ActivateHoldBtnIdx[ActivateButtonCount];
int ActivatePressBtnIdx[ActivateButtonCount];
int ActivateIndividualBtnIdx;
int ActivatePressButton1[ActivateButtonCount];
int ActivatePressBtnIdx1[ActivateButtonCount];
int DisplayAR;

// Adjustable Values \\ 
int TaylorARVert[3];
int TaylorARHoriz[3]; 
int VerticalStart[3];
int VerticalMid[3];
int VerticalEnd[3];
int VerticalTime[3];
int HorizontalStart[3];
int HorizontalMid[3]; 
int HorizontalEnd[3];
int HorizontalTime[3];
int ToggleAAType; 
int TaylorShapes;
int ShapeDirection;
int AdsSpeed;
int TaylorAngle;
int AdsRadius;
int TaylorRadius;
int ToggleBoostFire;
int TaylorPBoostStr;
int TaylorABoostSpd;
int TaylorTracking;
int TrackingSize;
int TrackingSpeed;
int AimAssistSize;
int AimAssistTime;
int HeadShotStrength;
int HeadShotHold
int ActiveTime; 
int RateOfFire[3];
int BurstFireHold;
int BurstFireRelease;
int StrafeShotTime;
int ReloadTime;
int GeneralSens,AdsSens,FireSens,AdsFireSens;
int SlideDelay;
int CrouchSpeed;
int StrafeTime; 
int PingDelay; 
int HandGunVertical;
int HandGunAASpeed;
int HandGunAASize;
int ToggleAutoRF,ToggleAutoHB;
int RT,MSC,SD1,DGT,DGR,TP1,TP2;
int X_1,Y_1,X_2,Y_2,X_3,Y_3, X_4,Y_4,X_5,Y_5,X_6,Y_6,X_7,Y_7,X_8,Y_8,RN1,RN2,RN3,RN4,RN5,RN6,RN7,RN8;
int SSMU1 = 1,SSMU2 = 8,SSMU3 = 15,SSMU4 = 22,SSMU5 = 29,SSMU6 = 36,SSMU7 = 43;
int SSMU8 = 50, SSMU9 = 57, SSMU10 = 64,SSMU11 = 71;
define SSA13 = 50,SSA14 = 49,SAVER = 5000,SAVER1 = 10;
define Y2 = 38
int CustomScreen;
// Variables Used Throughout The Script \\ 
int RfFireType[3],BfFireType[3];
int HoldTime,RestTime,LedOn,LedOff;
int DisplayQToggles;
int ProfileIdx; 
int DriveMode,ScreenSaver,BlankScreen,HighLight,SelectedProfileIdx,CustomProfile;
int Ads,Fire,Tactical,Lethal,Crouch,Jump,Reload,Melee,Swap,Sprint,Ping;       
int DisplayTitle = TRUE;
define False     = FALSE;
define True      = TRUE; 
define Small  = 0;
define Medium = 1;
define Large  = 2;
int stringPosition,stringHeight; 
int SmartRumble,AntirecoilStrength;
int RX,RY,angle,ActualMagnitude,MaxMagnitude,GetAngle;
int PolarStrength,Angle,AngleBoost,SmartAAV1Rumble,SpiralPosition1,InnerSpiral,OuterSpiral,SpiralPosition2,Position,SpeedAngle,AngleDirection,RightStick;
int x,y,inc;
int stringLength,FireRF;
int color; 
int vert = 4;
int FirstShotBeforeReload,ReloadInProgress,MaxReloadTime;
int TaylorFineTune  = 30;
int Smoothing; 
int GenStr;
int Tracking,Tracker1,Tracker2,InSpiral,OutSpiral;
int HandGunVStrength,HandGunAASpd,HandGunAAStr;
int CycleRefresh;
int TimeInterval = 4;
int CompleteTime;
int Time;
int AntirecoilStart,AntirecoilMid,AntirecoilEnd,HorizTime;
int StrafeAngle;

//========================================================== End Of Variables ======================================================\\
init { 
	
	Load();
	
//============ Load Variables For When The Script Is Loaded ===============\\
	InitializeShapeChange();
//=========================================================================\\
} 
main { 
//======== Enter The OLED Menu ==========\\
	ActivateAllButtons();
	Buttons(Buttons);
	
	if(get_console() == PIO_PS4)
    {
        if(get_controller() != PIO_PS4) // If not PS4 controller:
        {
            if(get_ival(PS4_SHARE)) // View
            {
                if(get_ival(PS4_R3)) // RS + View =  ScreenShot
                {
                    set_val(PS4_SHARE,100);
                    set_val(PS4_TOUCH,0);
                    set_val(PS4_R3,0);
                }
                else // View only = PS4_TOUCH
                {
                    set_val(PS4_TOUCH, 100);
                    set_val(PS4_SHARE, 0);
                }
            }
        }
    }
    else if(get_console() == PIO_XB360) // If XBOX console
    {
        if(get_controller() == PIO_PS4) // If PS4 controller:
            swap(PS4_TOUCH, PS4_SHARE);
    }
    if(get_ival(Ads))                                            
	{ 
		if(event_press(PS4_OPTIONS))                               
		{ 
		    MenuStatus(1,1,0,0,0,0);
		    ModORVal[0]  = 0; 
		    combo_run(RumbleOn);
		    
		    if(!ModOrEditMenu[0]){ 
		    	MenuStatus(0,0,0,0,0,1);
		    }    
	    }
	    set_val(PS4_OPTIONS,0);   
    } 
// ====================================\\

// ======== Start Of The Menu =========\\
    if(!DisplayTitle)                           
    { 
    	if(ModOrEditMenu[0]) 
        {
        	ModORVal[0]  = MenuNavigation(ModORVal[0],0,4); 
        	led(ProfileIdx);
        	vm_tctrl(0);
        	
        	if(event_press(PS4_CIRCLE))
		    {
				MenuStatus(0,0,0,0,0,1);
				InitializeShapeChange();
				Save();
				combo_run(Saved);
			}	
        } 
   		if(ModOrEditMenu[1])       
     	{ 
           	ModORVal[1]   = MenuNavigation(ModORVal[1],ModRange[ModORVal[0]][0],ModRange[ModORVal[0]][1]); // Menu Navigation Function \\
           	
           	ModIdx = -1; 
           	
			ToggleTaylorAR   [ProfileIdx]   = ToggleSwitch(ToggleTaylorAR    [ProfileIdx]);
			ToggleProgressive[ProfileIdx]   = ToggleSwitch(ToggleProgressive [ProfileIdx]);
			ToggleTaylorAA       			= ToggleSwitch(ToggleTaylorAA);
			ToggleBattsStickyAim 			= ToggleSwitch(ToggleBattsStickyAim);
			HeadAssist           			= ToggleSwitch(HeadAssist);
			ToggleSpeedStrafe[ProfileIdx]   = ToggleSwitch(ToggleSpeedStrafe [ProfileIdx]);
			ToggleRapidFire  [ProfileIdx]   = ToggleSwitch(ToggleRapidFire   [ProfileIdx]);
			ToggleBurstFire  [ProfileIdx]   = ToggleSwitch(ToggleBurstFire   [ProfileIdx]);
			ToggleStrafeShot [ProfileIdx]   = ToggleSwitch(ToggleStrafeShot  [ProfileIdx]);
			ToggleCancelReload   			= ToggleSwitch(ToggleCancelReload);
			ToggleTaylorSens     			= ToggleSwitch(ToggleTaylorSens);
			ToggleCancelSlide    			= ToggleSwitch(ToggleCancelSlide);
			ToggleHoldBreath [ProfileIdx]   = ToggleSwitch(ToggleHoldBreath  [ProfileIdx]); 
			ToggleBunnyHop       			= ToggleSwitch(ToggleBunnyHop); 
			ToggleProneShot  [ProfileIdx]   = ToggleSwitch(ToggleProneShot   [ProfileIdx]);
			ToggleAutoAim    [ProfileIdx]   = ToggleSwitch(ToggleAutoAim     [ProfileIdx]); 
			ToggleCrouchShot [ProfileIdx]   = ToggleSwitch(ToggleCrouchShot  [ProfileIdx]);
			ToggleJumpShot   [ProfileIdx]   = ToggleSwitch(ToggleJumpShot    [ProfileIdx]);
			ToggleFastMelee  [ProfileIdx]   = ToggleSwitch(ToggleFastMelee   [ProfileIdx]);
			ToggleVmSpeed        			= ToggleSwitch(ToggleVmSpeed); 
			ToggleEnemyPing        			= ToggleSwitch(ToggleEnemyPing); 
			ToggleSniperMode [ProfileIdx]   = ToggleSwitch(ToggleSniperMode  [ProfileIdx]);
			Buttons            			    = ToggleSwitch(Buttons);  
		    ToggleBlockRumble        	    = ToggleSwitch(ToggleBlockRumble);
			ActivateIndividualBtnIdx        = ToggleSwitch(ActivateIndividualBtnIdx);
			ButtonActivation(0)
			ButtonActivation(1)
			ButtonActivation(2)
			ButtonActivation(3)
			ButtonActivation(4)
			ButtonActivation(5)
			ButtonActivationAR(6)
			NameChange();
			
			MenuScroll();
			vm_tctrl(0);
			
    	} 
    	if(ModOrEditMenu[2])  
	    { 
            ModORVal[2]   = MenuNavigation(ModORVal[2],ModsNToggles[ModORVal[1]][3],ModsNToggles[ModORVal[1]][4]); // Menu Navigation Function \\
            
            ValIdx = -1;
			TaylorARVert   [ProfileIdx]  = EditableValues(TaylorARVert[ProfileIdx]);
			TaylorARHoriz  [ProfileIdx]  = EditableValues(TaylorARHoriz[ProfileIdx]);
			VerticalStart  [ProfileIdx]  = EditableValues(VerticalStart[ProfileIdx]);
			VerticalMid    [ProfileIdx]  = EditableValues(VerticalMid[ProfileIdx]);
			VerticalEnd    [ProfileIdx]  = EditableValues(VerticalEnd[ProfileIdx]);
			VerticalTime   [ProfileIdx]  = EditableValues(VerticalTime[ProfileIdx]);
			HorizontalStart[ProfileIdx]  = EditableValues(HorizontalStart[ProfileIdx]);
			HorizontalMid  [ProfileIdx]  = EditableValues(HorizontalMid[ProfileIdx]);
			HorizontalEnd  [ProfileIdx]  = EditableValues(HorizontalEnd[ProfileIdx]);
			HorizontalTime [ProfileIdx]  = EditableValues(HorizontalTime[ProfileIdx]);
			ToggleAAType       			 = EditableSwitch(ToggleAAType);
			TaylorShapes      			 = EditableSwitch(TaylorShapes);
			ShapeDirection    			 = EditableSwitch(ShapeDirection);
			AdsSpeed        			 = EditableValues(AdsSpeed);
			TaylorAngle        			 = EditableValues(TaylorAngle);
			AdsRadius        			 = EditableValues(AdsRadius);
			TaylorRadius       			 = EditableValues(TaylorRadius);
			ToggleBoostFire    			 = EditableSwitch(ToggleBoostFire);
			TaylorPBoostStr    			 = EditableValues(TaylorPBoostStr);
			TaylorABoostSpd   			 = EditableValues(TaylorABoostSpd);
			TaylorTracking     			 = EditableSwitch(TaylorTracking);
			TrackingSize       			 = EditableValues(TrackingSize);
			TrackingSpeed      			 = EditableValues(TrackingSpeed);
			Smoothing        			 = EditableValues(Smoothing);
			AimAssistSize     			 = EditableValues(AimAssistSize);
			AimAssistTime      			 = EditableValues(AimAssistTime);
			HeadShotStrength           	 = EditableValues(HeadShotStrength); 
			HeadShotHold           	     = EditableValues(HeadShotHold);
			ActiveTime                   = EditableValues(ActiveTime);
			RateOfFire    [ProfileIdx]   = EditableValues(RateOfFire[ProfileIdx]);
			BurstFireHold			     = EditableValues(BurstFireHold);
			BurstFireRelease			 = EditableValues(BurstFireRelease);
			StrafeShotTime     			 = EditableValues(StrafeShotTime);
			MaxReloadTime         	     = EditableValues(MaxReloadTime);
			GeneralSens        			 = EditableValues(GeneralSens);
			AdsSens            		     = EditableValues(AdsSens);
			FireSens           			 = EditableValues(FireSens);
			AdsFireSens        			 = EditableValues(AdsFireSens);
			SlideDelay        		     = EditableValues(SlideDelay);
			CrouchSpeed     			 = EditableValues(CrouchSpeed);
        	StrafeTime      			 = EditableValues(StrafeTime);
        	PingDelay       			 = EditableValues(PingDelay);
			HandGunVertical              = EditableValues(HandGunVertical);
			HandGunAASpeed               = EditableValues(HandGunAASpeed);
			HandGunAASize                = EditableValues(HandGunAASize);
        	ToggleAutoRF     			 = EditableSwitch(ToggleAutoRF);
        	ToggleAutoHB     			 = EditableSwitch(ToggleAutoHB);
        	
			MenuScroll();
			vm_tctrl(0);
        } 
    }
    if(DisplayMenu)  // Display Menu \\ 
    { 
    	rect_oled(2,3,127,50,1,0);
		rect_oled(0, 0, OLED_WIDTH, OLED_HEIGHT, OLED_BLACK, OLED_WHITE); 
		line_oled(0, 50,127 , 50, 1, 1); 
		
		led(ProfileIdx);
	
		
		if(ModOrEditMenu[1] || ModOrEditMenu[2]) {
			line_oled(0, 25,127 , 25, 1, 1); 
			led(ProfileIdx);
		}
		
		if(ModOrEditMenu[2]) 
		{ 	
			String(ValNames[ModORVal[2]],Small,-24,0); 
			
			if(ValRangeMinMax [ModORVal[2]][5] == 0){ 
				String(Misc[5],Small,-12,0); 
			} 
			if(ValRangeMinMax [ModORVal[2]][5] == 1){ 
				String(Profiles[ProfileIdx],Small,-12,0); 
			}
			if(ValRangeMinMax [ModORVal[2]][5] == 2){ 
				String(Misc[11],Small,-12,0); 
			} 
		}
		else if(ModOrEditMenu[1])
		{
		    String(ModNames[ModORVal[1]],Small,-24,0);
		    
		    if(ModsNToggles[ModORVal[1]][6] == 0){
		    	String(Misc[5],Small,-12,0); 
		    }
		    if(ModsNToggles[ModORVal[1]][6] == 1){
		    	String(Profiles[ProfileIdx],Small,-12,0); 
		    } 
		    if(ModsNToggles[ModORVal[1]][6] == 2){
		    	String(Misc[19],Small,-12,0); 
		    } 
		    if(ModsNToggles[ModORVal[1]][6] == 3){
		    	String(Misc[7],Small,-12,0); 
		    } 
		    if(ModsNToggles[ModORVal[1]][6] == 4){
		    	String(Misc[15],Small,-12,0); 
		    }
		    if(ModsNToggles[ModORVal[1]][6] == 5){
		    	String(Misc[8],Small,-12,0); 
		    } 
		    if(ModsNToggles[ModORVal[1]][6] == 6){
		    	String(Misc[22],Small,-12,0); 
		    } 
		    if(ModORVal[1] == 32){ 
		    	DisplayAscii(Y);
		    } 
		}
		else 
		{
			cls_oled(OLED_BLACK);
        	rect_oled(0, 0, OLED_WIDTH, OLED_HEIGHT, OLED_BLACK, OLED_WHITE);
        	led(ProfileIdx);
        	
			for(i = 0;i < GetEntriesStrings(0); i++) 
			{
				if(i == ModORVal[0]) 
				{
					color = OLED_BLACK;
				}else{
		    		color = OLED_WHITE;
				}
			 	printf(64 - ((GetCharsStrings(i) * OLED_FONT_SMALL_WIDTH) / 2),vert,OLED_FONT_SMALL,color,MainMenuId[i])
				vert += 12
			}
			vert = 4;	
		}
		DisplayMenu = FALSE;
	} 
//================================== End Of Menu ======================================\\

//============================== Start Of Mod Section ==================================\\

    if(!ModOrEditMenu[0] && !ModOrEditMenu[1] && !ModOrEditMenu[2]) 
	{
	// Functions That Are Called When Not In Mod Menu / Edit Menu / Adjustable menu / Main Menu \\ 
	
    	DisplayTitleScreen();  // Line 1601
    	
    	if(!CustomProfile) 
		{
        	if(ActivateIndividualButton) 
        	{ 
        		if(event_release(ActivateIndividualButton) && get_ptime(ActivateIndividualButton) < 150 || ActivateHoldButton[0] &&  get_ival(ActivateHoldButton[0]) && event_release(ActivatePressButton[0])) 
        		{
    				SelectedProfileIdx =! SelectedProfileIdx;
    				CustomProfile = FALSE;
    
    				if(ModOrEditMenu[1]) 
    					DisplayMenu = TRUE; 
        			else
            			DisplayTitle = TRUE;
            	}	
            	if(!CustomProfile) 
            	{
            		if(SelectedProfileIdx) 
            	   		ProfileIdx = 1;
            		else
            	   		ProfileIdx = 0; 
    			}
	    		if(ActivateHoldButton[0] &&  get_ival(ActivateHoldButton[0]))
	    			set_val(ActivatePressButton[0], 0);
      		}
      	} 
        if(ActivateHoldButton[1]) 
        {
        	if(get_ival(ActivateHoldButton[1]))
            {
            	if(event_press(ActivatePressButton[1]))
            	{
	             	ProfileIdx = 2; 
		       	    CustomProfile =! CustomProfile;
		       	    
		       	    if(ModOrEditMenu[1]) 
	    				DisplayMenu = TRUE; 
	        		else
	            		DisplayTitle = TRUE;
	            		
	            	if(!CustomProfile) 
	            	{
	            		if(SelectedProfileIdx) 
	            	   		ProfileIdx = 1;
	            		else
	            	   		ProfileIdx = 0; 
	    			}
	    		} 
	       	}           
	       	if(ActivateHoldButton[1] &&  get_ival(ActivateHoldButton[1]))
	    		set_val(ActivatePressButton[1], 0);   
	   	}   	
    	
   // Everything Below Are Mods Only  & QuickToggles \\ 
 
    	led(ProfileIdx);
    	
    	if(ToggleBlockRumble) 
		{
			block_rumble();
		}
    	if(get_ival(Fire))
    	{
			if(event_press(PS4_RIGHT) && get_brtime(PS4_RIGHT) <= 200 && !ModOrEditMenu[0] && !ModOrEditMenu[1] && !ModOrEditMenu[2] && !ModOrEditMenu[3])
    	    {
		        DriveMode = TRUE; 
		        combo_run(DriveMode);
    	    }
    	    set_val(PS4_RIGHT,0);
    	} 
		if(DriveMode) 
    	{
			combo_run(Blink);
			LedOn  = 150;
			LedOff = 300;
			
			if(event_press(PS4_SQUARE))
			{
				DriveMode = FALSE;
				combo_run(RumbleOff); 
    		} 
    	} 
   		if(!DriveMode)           
		{
			if(ToggleVmSpeed)
			{
				if(ToggleVmSpeed == 0) vm_tctrl( 0);	
			    if(ToggleVmSpeed == 1) vm_tctrl(-2);
			    if(ToggleVmSpeed == 2) vm_tctrl(-4);
			   	if(ToggleVmSpeed == 3) vm_tctrl(-6);
			   	if(ToggleVmSpeed == 4) vm_tctrl(-8);
			    if(ToggleVmSpeed == 5) vm_tctrl(-9);   	
			} 

			ToggleRapidFire [ProfileIdx]  = QuickToggleMods(ActivateHoldButton[2] , ActivatePressButton[2]  ,ToggleRapidFire [ProfileIdx], 6,ModsNToggles[ModORVal[1]][1],ModsNToggles[ModORVal[1]][2]); 
			ToggleSniperMode[ProfileIdx]  = QuickToggleMods(ActivateHoldButton[3] , ActivatePressButton[3]  ,ToggleSniperMode[ProfileIdx],21,ModsNToggles[ModORVal[1]][1],ModsNToggles[ModORVal[1]][2]); 
			ToggleStrafeShot[ProfileIdx]  = QuickToggleMods(ActivateHoldButton[4] , ActivatePressButton[4]  ,ToggleStrafeShot[ProfileIdx], 8,ModsNToggles[ModORVal[1]][1],ModsNToggles[ModORVal[1]][2]); 
			ToggleJumpShot  [ProfileIdx]  = QuickToggleMods(ActivateHoldButton[5] , ActivatePressButton[5]  ,ToggleJumpShot  [ProfileIdx],17,ModsNToggles[ModORVal[1]][1],ModsNToggles[ModORVal[1]][2]); 
			
		    if(ToggleSniperMode[ProfileIdx] == 1) 
	        {
	        	LedBlink(1300,500);
	        	HandGunVStrength = HandGunVertical;
	        	HandGunAASpd     = HandGunAASpeed;
	        	HandGunAAStr     = HandGunAASize;
	        	
	        	InitializeShapeChange()
    		}
    		if(!ToggleSniperMode[ProfileIdx] == 1)
    		{
    			HandGunVStrength = TaylorARVert[ProfileIdx];
    			HandGunAASpd     = TaylorAngle;
    			HandGunAAStr     = TaylorRadius;	
       		}
       		if(get_ival(Ads))
       		{
       			if(event_press(ActivatePressButton1[6])) 
       			{
       				TaylorARVert[ProfileIdx] += 2; 
       				if(TaylorARVert[ProfileIdx] > 99) TaylorARVert[ProfileIdx] = -99; 
       				DisplayAR = TRUE;
       			}
       			if(event_press(ActivatePressButton[6])) 
       			{
       				TaylorARVert[ProfileIdx] -= 2; 
       				if(TaylorARVert[ProfileIdx] < -99) TaylorARVert[ProfileIdx] = 99; 
       				DisplayAR = TRUE;
       			}
       			set_val(ActivatePressButton1[6],0); set_val(ActivatePressButton[6],0);
       		}
       		if(event_release(ActivatePressButton1[6]) ||  event_release(ActivatePressButton[6]))
			{
				ScreenSaver = TRUE;
				CustomScreen = FALSE;
			}
			if(DisplayAR) {
				CustomScreen = FALSE;
				DisplayAR();
				DisplayAR = FALSE;
			}
		    if(ToggleTaylorAR[ProfileIdx] == 1) 
    		{
       			if(get_ival(Ads) && get_ival(Fire) || ToggleAutoAim && get_ival(Fire))
        		{ 	
        			offset(PS4_RY,HandGunVStrength);
					offset(PS4_RX,TaylorARHoriz[ProfileIdx]);
        		}
	        }
			if(ToggleTaylorAR[ProfileIdx] == 2) 
		    { 
	        	if(get_ival(Ads) && get_ival(Fire)  || ToggleAutoAim && get_ival(Fire))
	        	{
		    		SmartRumble = get_rumble(RumbleToUse());
		    	
			    	if(SmartRumble > 10 && SmartRumble < 90) 
					{
						AntirecoilStrength = HandGunVStrength + SmartRumble / 2;
					} 	 
					if(SmartRumble < 10 || get_ptime(Fire) < 200) 
					{
						offset(PS4_RY,HandGunVStrength);
						offset(PS4_RX,TaylorARHoriz[ProfileIdx]);
					}
					else
					{ 	
						offset(PS4_RY,AntirecoilStrength);
						offset(PS4_RX,TaylorARHoriz[ProfileIdx]);	
					}
				}
				AntirecoilStrength  = 0; 
	    	    SmartRumble = 0; 
		    } 
		    if(ToggleProgressive[ProfileIdx] == 1 || ToggleProgressive[ProfileIdx] == 2) { 
		    
			    CompleteTime = (VerticalTime[ProfileIdx]   * 100) / 3;
			    HorizTime    = (HorizontalTime[ProfileIdx] * 100) / 3;
			     
			    if(get_ival(Ads) && get_ival(Fire))
			    {    
			        SmartRumble = get_rumble(RumbleToUse());
			        
			        Time += get_rtime();
			        
			        if(ToggleProgressive[ProfileIdx] == 2) { 
				        if(SmartRumble > 10 && SmartRumble < 90){ 
					        AntirecoilStart = VerticalStart[ProfileIdx] + SmartRumble / 2;
					        AntirecoilMid   = VerticalMid  [ProfileIdx] + SmartRumble / 2;
					        AntirecoilEnd   = VerticalEnd  [ProfileIdx] + SmartRumble / 2;
				        }
				    } 
			        if(Time < CompleteTime){ 
			        	if(ToggleProgressive[ProfileIdx] == 2 && SmartRumble < 10 || ToggleProgressive[ProfileIdx] == 1){ 
			            	 offset(PS4_RY,VerticalStart[ProfileIdx]);
			            }else{
			            	 offset(PS4_RY,AntirecoilStart);
			            } 
			        } 
			        else if(Time < CompleteTime * 2 ){ 
			            if(ToggleProgressive[ProfileIdx] == 2 && SmartRumble < 10 || ToggleProgressive[ProfileIdx] == 1){ 
			            	offset(PS4_RY,VerticalMid[ProfileIdx]);
			            }else{
			            	offset(PS4_RY,AntirecoilMid);
			            } 
			        } 
			        else if(Time < CompleteTime * 3){ 
			    		if(ToggleProgressive[ProfileIdx] == 2 && SmartRumble < 10 || ToggleProgressive[ProfileIdx] == 1){ 
			    			offset(PS4_RY,VerticalEnd[ProfileIdx]);
			    		}else{ 
			            	offset(PS4_RY,AntirecoilEnd);
			            }     
			        }
			        if(Time >= VerticalTime[ProfileIdx] * 100){ 
			        	if(ToggleProgressive[ProfileIdx] == 2 && SmartRumble < 10 || ToggleProgressive[ProfileIdx] == 1){ 
			    			offset(PS4_RY,VerticalEnd[ProfileIdx]);
			    		}else{ 
			            	offset(PS4_RY,AntirecoilEnd);
			            }     
			        } 
			        if(Time < HorizTime){ 
			            offset(PS4_RX,HorizontalStart[ProfileIdx]);      
			        }  
			        else if(Time < HorizTime * 2 ) { 
			            offset(PS4_RX,HorizontalMid[ProfileIdx]);  
			        }  
			        else if(Time < HorizTime * 3){  
			            offset(PS4_RX,HorizontalEnd[ProfileIdx]);         
			        } 
			        if(Time >= HorizontalTime[ProfileIdx]){
			        	offset(PS4_RX,HorizontalEnd[ProfileIdx]);
			        } 
			    } 
			    if(event_release(Fire)){ 
			    	Time            = 0;
			    	SmartRumble     = 0;
			    	AntirecoilStart = 0;
			    	AntirecoilMid   = 0;
			    	AntirecoilEnd   = 0;
	    		} 
			} 
			   
			if(ToggleTaylorAA == 1) 
			{ 
			    RightStick = isqrt(pow(RX,2) + pow(RY,2));
		    	Tracking = (Tracking + TrackingSpeed) % 360;
				CycleRefresh += get_rtime();
				if(TaylorTracking)
			    {
			       Tracker1 = (TrackingSize * sin(Tracking)/100);
			       Tracker2 = (TrackingSize * cos(Tracking)/100);
		        }
			    RX = get_val(PS4_RX);                                
				RY = get_val(PS4_RY);
			   
			    if(ShapeDirection){ 
			    	AngleDirection = (get_val(PS4_RX) > 0);
			    }
			    if((abs(get_val(PS4_RX)) < 10) * (abs(get_val(PS4_RY)) < 10)) 
			    	Angle = (Angle + AdsSpeed + AngleBoost) % 360;
			    else
			    	Angle = (Angle + HandGunAASpd + AngleBoost) % 360;
			    	
				if(ToggleBoostFire) 
				{
					if(get_ival(Fire))
					{
						GetRumble(SmartAAV1Rumble,PolarStrength,TaylorPBoostStr,6)
						AngleBoost = TaylorABoostSpd;
					  
	    			    if(!get_rumble(RUMBLE_A) && !get_rumble(RUMBLE_B))
	    			    {
	    			    	DoNotAtMePolar(POLAR_RS,Angle,TaylorPBoostStr/2)
	    			    }
	    			    else
	    			    {
			    			DoNotAtMePolar(POLAR_RS,Angle,PolarStrength/2)  
				    	} 
				    }
				    if(event_release(Fire)) 
	    			{
	    				GetAngle = 0;
	    			} 
				}
				if(get_ival(Ads) || get_ival(Fire) || ToggleAutoAim && get_ival(Fire)){ 
					if(!ToggleBoostFire || !get_rumble(RumbleToUse())) {
						if(TaylorShapes == 3){ 
							DoNotAtMePolar(POLAR_RS,Angle,HandGunAAStr) 
						}else{
					
							if(RightStick > HandGunAAStr) { 
						    	DoNotAtMePolar(POLAR_RS,Angle,HandGunAAStr) 
						    }else{
						    	DoNotAtMePolar(POLAR_RS,Angle,AdsRadius)
						    } 
						} 
					} 	
				} 
				SmartAAV1Rumble = 0;
				PolarStrength = 0; 
		    }
		    if(ToggleTaylorAA == 2 || ToggleTaylorAA == 3) 
			{
				RX = get_val(PS4_RX);                                
				RY = get_val(PS4_RY);
				RightStick = isqrt(pow(RX,2) + pow(RY,2));
				ActualMagnitude = isqrt(pow(RX, 2) + pow(RY, 2));
				MaxMagnitude = (ActualMagnitude < 100);
				Tracking = (Tracking + TrackingSpeed) % 360;
			
				if(ShapeDirection){ 
			    	AngleDirection = (get_val(PS4_RX) > 0);
			    }
				CycleRefresh += get_rtime();
				
				if((abs(get_val(PS4_RX)) < 10) * (abs(get_val(PS4_RY)) < 10)) 
			    	angle += AdsSpeed + GetAngle;
			    else
			    	angle += HandGunAASpd + GetAngle;
			    	
				if(TaylorTracking)
			    {
			       Tracker1 = (TrackingSize * sin(Tracking)/100);
			       Tracker2 = (TrackingSize * cos(Tracking)/100);
		        }
		        if(ToggleBoostFire) 
				{
					if(get_ival(Fire))
					{
						GetRumble(SmartAAV1Rumble,PolarStrength,TaylorPBoostStr,6)
						GetAngle = TaylorABoostSpd;
					
	    			    if(!get_rumble(RUMBLE_A) && !get_rumble(RUMBLE_B))
	    			    {
	    			    	GetShapesV5(TaylorPBoostStr,angle); 
	    			    }else{
							GetShapesV5(PolarStrength,angle); 	
				    	} 
				    }
				    if(event_release(Fire)) 
	    			{
	    				GetAngle = 0;
	    			} 
				}	
				if(get_ival(Ads) || get_ival(Fire) && MaxMagnitude <= Smoothing)
				{  	
					if(ToggleTaylorAA == 3) 
					{ 
						angle += get_rtime();
						SpeedAngle = (SpeedAngle  + (angle / 100)) % 360;
						 
						GetShapesV5(TaylorRadius,SpeedAngle);	
				
					}else{ 
					
						if(TaylorShapes == 3){ 
							GetShapesV5(HandGunAAStr,angle); 
						}else{
							if(RightStick > HandGunAAStr) { 
								GetShapesV5(HandGunAAStr,angle);
							}else{ 
								GetShapesV5(AdsRadius,angle);
							} 	
						} 
					} 
				} 
				if(event_release(Ads)){
		        	angle = 0;
		        }  
			}
			if(ToggleSpeedStrafe[ProfileIdx] == 1){ 
				if(get_ival(Fire) && get_ptime(Fire) < ActiveTime){ 
					angle += get_rtime();
					StrafeAngle = (StrafeAngle  + (angle / 100)) % 360;
					combo_run(StrafeAA);
				}
			}
		    if(ToggleBattsStickyAim){
				if(get_ival(Fire))
					combo_run(StickyAim);
			} 
			if(HeadAssist) {
				RY = HeadShotStrength * -1;
				if(get_ival(Fire) && get_ptime(Fire) < HeadShotHold) { 	
					offset(PS4_RY,RY);	
				}
			}
			if(ToggleRapidFire[ProfileIdx] == 1 || ToggleSniperMode[ProfileIdx] == 1 && ToggleAutoRF)
			{
			 	HoldTime = 500 / RateOfFire[ProfileIdx]; 
			    RestTime = HoldTime -get_rtime();
			 	if(RestTime < 0) RestTime = 0;
			    
			 	
			 	if(RfFireType[ProfileIdx] == 0) { 
				 	if(get_ival(Fire))
				 		combo_run(RAPIDFIRE);
				 	else
				    	combo_stop(RAPIDFIRE);
				} 
				if(RfFireType[ProfileIdx] == 1) { 
					if(get_ival(Ads)){
			    		if(get_ival(Lethal)){
			    			FireRF = TRUE;
			    		}
			    	    set_val(Lethal,0);
			        } 
			        if(FireRF){ 
			    		set_val(Fire,100);
			    		combo_run(RAPIDFIRE);
			    	}
			    	if(event_release(Ads) || event_release(Lethal))
			    	{
			    		FireRF = FALSE;
			    	}
			    }
			    LedBlink(150,300);   
			}
			if(ToggleBurstFire[ProfileIdx] == 1)
		    {
		     // Hold and Release
		        HoldTime = BurstFireHold;
		    	RestTime = BurstFireRelease;
			
		    	if(BfFireType[ProfileIdx] == 0) { 
			        if(get_val(Fire))	
				    	combo_run(BurstFire);
			        else
			            combo_stop(BurstFire);
			    } 
			    if(BfFireType[ProfileIdx] == 1) { 
			    	if(get_ival(Ads)){
			    		if(get_ival(Lethal)){
			    			FireRF = TRUE;
			    		}
			    	    set_val(Lethal,0);
			        } 
			        if(FireRF){ 
			    		set_val(Fire,100);
			    		combo_run(BurstFire);
			    	}
			    	if(event_release(Ads) || event_release(Lethal))
			    	{
			    		FireRF = FALSE;
			    	}
			    }
		        LedBlink(200,1000);
		    }
		    if(ToggleStrafeShot[ProfileIdx] == 1) 
		    {
		   		if(get_val(Fire))
		        	combo_run(StrafeShot);
				else
		   			combo_stop(StrafeShot);
			}
			if(ToggleCancelReload)
			{
				if(event_press(Fire))
					FirstShotBeforeReload = TRUE; 
					
				if(event_press(Reload) && FirstShotBeforeReload)
				{
					ReloadInProgress = TRUE;
					FirstShotBeforeReload = FALSE;
				}
				if(get_val(Reload) && get_ptime(Reload) >= 250)
				{
					ReloadInProgress = FALSE;
					combo_stop(CancelReload);
				}
				if(ReloadInProgress)
					ReloadTime += get_rtime();
				else 
				    ReloadTime = 0;

				if(ReloadTime > MaxReloadTime)
					ReloadInProgress = FALSE;

				if(ReloadTime > 0 && ReloadTime <= MaxReloadTime && event_press(Fire))
					combo_run(CancelReload);
			}
			if(ToggleTaylorSens)  
            {
            	ActualMagnitude = isqrt(pow(RX, 2) + pow(RY, 2));
                        
                if(!get_val(Ads) && !get_val(Fire) && ActualMagnitude <= TaylorFineTune) 
                {
               		GenStr = GeneralSens;
                }
                else if(get_val(Ads) && !get_val(Fire) && ActualMagnitude <= TaylorFineTune) 
                { 
                    GenStr = AdsSens;
                }  
                else if(!get_val(Ads) && get_val(Fire) && ActualMagnitude <= TaylorFineTune) 
                { 
                    GenStr = FireSens;   
                }
                else if(get_val(Ads) && get_val(Fire) && ActualMagnitude <= TaylorFineTune)
                { 
                    GenStr = AdsFireSens;
                }
	            sensitivity(PS4_RY,NOT_USE,GenStr);
	            sensitivity(PS4_RX,NOT_USE,GenStr);     	
            }
            if(ToggleCancelSlide == 1 || ToggleCancelSlide == 2)
			{
				if((get_val(PS4_LY) < -80) || (get_val(PS4_LY) > 80) || (get_val(PS4_LX) < -80) || (get_val(PS4_LX) > 80))
				{
					if(ToggleCancelSlide == 1 && event_release(Crouch))
						combo_run(CancelSlideMW)
					else if(ToggleCancelSlide == 2 && event_release(Crouch))
						combo_run(CancelSlideCW) 
						
					if(ToggleCancelSlide == 1 && combo_running(CancelSlideMW) && (get_val(Ads) && event_release(Crouch)))
	                    combo_stop(CancelSlideMW)
	                    
	                if(ToggleCancelSlide == 2 && combo_running(CancelSlideCW) && (get_val(Ads) && event_release(Crouch)))
	                    combo_stop(CancelSlideCW)
				}
			}
			if(ToggleHoldBreath[ProfileIdx] == 1 || ToggleSniperMode[ProfileIdx] == 1  && ToggleAutoHB)
			{
	       		if(get_val(Ads))
		    		set_val(Sprint, 100);
	                      
	   			if(get_val(PS4_LY) <-90 && get_val(Ads) && get_ptime(Ads) > 200)
	       			combo_stop(HoldBreath);       
	                    
	   			if(event_press(Ads)) 
	       			combo_run(HoldBreath);
	  
	   			if(get_val(Ads) && get_lval(Sprint)) 
	       			set_val(Sprint, 0);  
			}
			if(ToggleBunnyHop)
			{
	            if(get_ival(Jump) && get_ptime(Jump) > 200) 
	                combo_run(Bunnyhop); 
	        }
			if(ToggleProneShot[ProfileIdx] == 1) 
			{
				if(get_val(Ads) && get_val(Fire) && event_press(Crouch))
					InstaDropShot = TRUE;
			
				if(InstaDropShot)  
					combo_run(InstaDrop);
				
				if(event_release(Ads) || event_release(Fire))
				{
					InstaDropShot = FALSE;
					combo_stop(InstaDrop);
				} 	
			}
            if(ToggleAutoAim[ProfileIdx] == 1)
            { 
            	if(get_ival(Fire))
            		set_val(Ads,100);
            }  
            if(ToggleCrouchShot[ProfileIdx] == 1) { 
		        if(get_ival(Fire) && get_ptime(Fire) < 200){
		            set_val(Crouch,100);
		        }
		        if(event_release(Fire)){
		            set_val(Crouch,100);
		        } 
		    }
		    if(ToggleCrouchShot[ProfileIdx] == 2) { 
		    	if(get_ival(Fire)){
		    		combo_run(CrouchShotCmb);
		    	}
		    }
		    if(ToggleCrouchShot[ProfileIdx] == 3) { 
		    	if(get_ival(Fire)){
		    		combo_run(CrouchShotCmb);
		    		combo_run(Strafe);
		    	}
		    }
		    if(ToggleJumpShot[ProfileIdx] == 1) 
			{
				if(get_val(Fire))
					combo_run(JumpShot);
			}
			if(ToggleFastMelee[ProfileIdx] == 1) 
			{
				if(get_val(Melee))
					combo_run(FastMelee);

				if(get_val(Ads) && event_press(Melee) < 500)
					combo_stop(FastMelee);
			}
			if(ToggleEnemyPing) 
        	{
        		if(get_ival(Fire) && get_ptime(Fire) >= 300)
	         		combo_run(EnemyPing); 
	     		else
	         		combo_stop(EnemyPing);		
        	}
	    }		
     }
     set_val(TRACE_1,DisplayMenu);
 }

combo EnemyPing {
set_val(Ping,100);
wait(20)
set_val(Ping,0);
wait(20)
set_val(Ping,100);
wait(20)
set_val(Ping,0); 
wait(PingDelay); 
}
function InitializeShapeChange() { 
	if(TaylorShapes == 3) {
		InnerSpiral = TaylorRadius/2;	
		OuterSpiral = TaylorRadius;
	} 
}
function GetShapesV5(f_var,f_angle){ 

	if(TaylorShapes == 0) 
    {	
    	if(AngleDirection){ 
			RY += (f_var * sin(f_angle))/100 + Tracker1;
		    RX += (f_var * cos(f_angle))/100 + Tracker2;   
		}else{
			RX += (f_var * sin(f_angle))/100 + Tracker1;
		    RY += (f_var * cos(f_angle))/100 + Tracker2; 
		}
    }
    if(TaylorShapes == 1) // Tall Oval
    {
    	if(AngleDirection){
			RX += ((f_var/2 * sin(f_angle))/100 + Tracker1);
	       	RY += ((f_var   * cos(f_angle))/100 + Tracker2);
	    }else{
	        RX += ((f_var/2 * cos(f_angle))/100 + Tracker1);
	        RY += ((f_var   * sin(f_angle))/100 + Tracker2);
	    } 
    }
    if(TaylorShapes == 2) // Wide Oval
    {
    	if(AngleDirection){
			RX += ((f_var   * sin(f_angle))/100 + Tracker1);
       		RY += ((f_var/2 * cos(f_angle))/100 + Tracker2);
        }else{
        	RX += ((f_var   * cos(f_angle))/100 + Tracker1);
        	RY += ((f_var/2 * sin(f_angle))/100 + Tracker2);
        }
    }
    if(TaylorShapes == 3) // SpiralOval
	{
		if(!(CycleRefresh++ % TimeInterval))
		{
			if(!SpiralPosition1)                                
			{
				InnerSpiral -= 1;
				if(InnerSpiral < f_var/2)
					SpiralPosition1 = True;   
			}
			else
			{
			    InnerSpiral += 1;
				if(InnerSpiral > f_var)
					SpiralPosition1 = False;
			}
			if(!SpiralPosition2)
			{
				OuterSpiral -= 1;
				if(OuterSpiral < f_var/2)
					SpiralPosition2 = True;
			}
			else
			{
				OuterSpiral += 1;
				if(OuterSpiral >  f_var)
					SpiralPosition2 = False;
			}
			CycleRefresh = 0;
		}
		if(AngleDirection){
			RX += ((OuterSpiral * sin(f_angle))/100 + Tracker1);
       		RY += ((InnerSpiral * cos(f_angle))/100 + Tracker2);
        }else{
        	RX += ((InnerSpiral * cos(f_angle))/100 + Tracker1);
        	RY += ((OuterSpiral * sin(f_angle))/100 + Tracker2);
		}   
    } 
    if(TaylorShapes == 4) // Spiral
	{
		if(!(CycleRefresh++ % TimeInterval))
		{
			if(!SpiralPosition1)                                
			{
				InSpiral -= 1;
				if(InSpiral < 4)
					SpiralPosition1 = True;   
			}
			else
			{
			    InSpiral += 1;
				if(InSpiral > f_var)
					SpiralPosition1 = False;
			}
			if(!SpiralPosition2)
			{
				OutSpiral -= 1;
				if(OutSpiral < 4)
					SpiralPosition2 = True;
			}
			else
			{
				OutSpiral += 1;
				if(OutSpiral >  f_var)
					SpiralPosition2 = False;
			}
			CycleRefresh = 0;
		}
		if(AngleDirection){
			RX += ((OutSpiral * sin(f_angle))/100 + Tracker1);
       		RY += ((InSpiral  * cos(f_angle))/100 + Tracker2);
        }else{
        	RX += ((InSpiral  * cos(f_angle))/100 + Tracker1);
        	RY += ((OutSpiral * sin(f_angle))/100 + Tracker2);
		} 
    }
    if(TaylorShapes == 5) // Helix
	{
   		inc = (i % 100);
	    if(Position == 0){ 
	   		x = inc; y = 100 - inc;} 
	    else if (Position == 1){ 
	    	x = 100 - inc; y = - inc;}
	    else if (Position == 2){
	    	x = -inc; y = -100 + inc;}
	    else if(Position == 3){  
	    	x = -100 + inc; y = inc;}
	    Position ++;
	   
	    if(Position == 4){ 
	    	Position = 0;
	    }
	    RX += ((f_var * x)/100 + Tracker1);
	    RY += ((f_var * y)/100 + Tracker2);
         
    }
    if(TaylorShapes == 6) 
    {
    	RX += (f_var * sin(f_angle))/100;
    }
    if(TaylorShapes == 7)
    {
    	RY += (f_var * cos(f_angle))/100; 
    } 
		   
    set_val(PS4_RX, clamp(RX, -100, 100));
	set_val(PS4_RY, clamp(RY, -100, 100));
}
function DoNotAtMePolar(stick, angle, rad) {
	if(TaylorShapes == 0){  
	 	if(AngleDirection){
	  		offset(stick + 8, (rad * sin(angle))/ 100 + Tracker1);
	 		offset(stick + 7, (rad * cos(angle))/ 100 + Tracker2);
	 	}else{
	 		offset(stick + 8, (rad * cos(angle))/ 100 + Tracker1);
	 		offset(stick + 7, (rad * sin(angle))/ 100 + Tracker2);
	 	}
 	}
 	if(TaylorShapes == 1){
 		
  		if(AngleDirection){ 	
  		    offset(stick + 8, (rad   * sin(angle))/ 100 + Tracker1);
  			offset(stick + 7, (rad/2 * cos(angle))/ 100 + Tracker2);
  		}else{
  			offset(stick + 8, (rad   * cos(angle)) / 100 + Tracker1);
  			offset(stick + 7, (rad/2 * sin(angle)) / 100 + Tracker2);
  		}
  	}
  	if(TaylorShapes == 2){
  	    if(AngleDirection){ 
  		    offset(stick + 8, (rad/2 * sin(angle)) / 100 + Tracker1);
  			offset(stick + 7, (rad   * cos(angle)) / 100 + Tracker2);
  	    }else{ 
  	    	offset(stick + 8, (rad/2 * cos(angle)) / 100 + Tracker1);
  			offset(stick + 7, (rad   * sin(angle)) / 100 + Tracker2);
  		} 
  	}
  	if(TaylorShapes == 3){
  	
		if(!(CycleRefresh++ % TimeInterval))
		{
			if(!SpiralPosition1)                                
			{
				InnerSpiral -= 1;
				if(InnerSpiral < rad/2)
					SpiralPosition1 = True;   
			}
			else
			{
			    InnerSpiral += 1;
				if(InnerSpiral > rad)
					SpiralPosition1 = False;
			}
			if(!SpiralPosition2)
			{
				OuterSpiral -= 1;
				if(OuterSpiral < rad/2)
					SpiralPosition2 = True;
			}
			else
			{
				OuterSpiral += 1;
				if(OuterSpiral >  rad)
					SpiralPosition2 = False;
			}
			CycleRefresh = 0;
		}
  		if(AngleDirection){ 
			offset(stick + 8, (InnerSpiral * sin(angle)) / 100 + Tracker1);
  			offset(stick + 7, (OuterSpiral * cos(angle)) / 100 + Tracker2);
  		}else{
  			offset(stick + 8, (InnerSpiral * cos(angle)) / 100 + Tracker1);
  			offset(stick + 7, (OuterSpiral * sin(angle)) / 100 + Tracker2);
  		} 
  	}
  	if(TaylorShapes == 4){
  	
		if(!(CycleRefresh++ % TimeInterval))
		{
			if(!SpiralPosition1)                                
			{
				InSpiral -= 1;
				if(InSpiral < rad/2)
					SpiralPosition1 = True;   
			}
			else
			{
			    InSpiral += 1;
				if(InSpiral > rad)
					SpiralPosition1 = False;
			}
			if(!SpiralPosition2)
			{
				OutSpiral -= 1;
				if(OutSpiral < rad/2)
					SpiralPosition2 = True;
			}
			else
			{
				OutSpiral += 1;
				if(OutSpiral >  rad)
					SpiralPosition2 = False;
			}
			CycleRefresh = 0;
		}
		if(AngleDirection){ 
			offset(stick + 8, (InSpiral  * sin(angle))/ 100 + Tracker1);
  			offset(stick + 7, (OutSpiral * cos(angle))/ 100 + Tracker2);
  		}else{
  			offset(stick + 8, (InSpiral  * cos(angle))/ 100 + Tracker1);
  			offset(stick + 7, (OutSpiral * sin(angle))/ 100 + Tracker2);
  		} 
  		
  	}
  	if(TaylorShapes == 5)
  	{ 
  		inc = (i % 100);
	    if(Position == 0){ 
	   		x = inc; y = 100 - inc;
	   	} 
	    else if (Position == 1){ 
	    	x = 100 - inc; y = - inc; 
	    }
	    else if (Position == 2){
	    	x = -inc; y = -100 + inc; 
	    }
	    else if(Position == 3) {  
	    	x = -100 + inc; y = inc; 
	    }
	    Position ++;
	   
	    if(Position == 4){ 
	    	Position = 0;
	    }	
	    offset(stick + 8, (rad * x)/100 + Tracker1);
	 	offset(stick + 7, (rad * y)/100 + Tracker2);
	}
	if(TaylorShapes == 6) 
	{ 
		offset(stick + 8, (rad * cos(angle))/ 100);
	} 
	if(TaylorShapes == 7) 
	{ 
		offset(stick + 7, (rad * cos(angle))/ 100);
	}
	if(TaylorShapes == 8){ 
		if(Position == 0){ 
			offset(stick + 7, (rad * cos(135 + angle)) / 100 + Tracker1);
		    offset(stick + 8, (rad * sin(45 + angle)) / 100 + Tracker2);
		} 
		if(Position == 1){ 
			offset(stick + 7, (rad * cos(45 + angle)) / 100  + Tracker1);
		    offset(stick + 8, (rad * sin(135 + angle)) / 100 + Tracker2);
	    }  
		Position ++ 
		if(Position == 2){ 
		  	Position = 0;
		}
    }
    if(TaylorShapes == 9) { 
    	offset(stick + 7, (rad * cos(315 + angle)) / 100 + Tracker1);
  		offset(stick + 8, (rad * sin(180 + angle)) / 100 + Tracker2);	
  	}
  	if(TaylorShapes == 10) { 
  		offset(stick + 7, (rad * cos(135 + angle)) / 100 + Tracker1);
  		offset(stick + 8, (rad * sin(45 + angle)) / 100 + Tracker2);
    } 
    if(TaylorShapes == 11){ 
    	offset(stick + 7, (rad * cos(45 + angle)) / 100 + Tracker1);
  		offset(stick + 8, (rad * sin(135 + angle)) / 100 + Tracker2);
  	} 
 }
combo StickyAim {
offset(PS4_RY,AimAssistSize);
wait(AimAssistTime);
offset(PS4_RX,AimAssistSize);
offset(PS4_LX,AimAssistSize);
wait(AimAssistTime);
offset(PS4_RY,inv(AimAssistSize));
wait(AimAssistTime);
offset(PS4_RX,inv(AimAssistSize));
offset(PS4_LX,inv(AimAssistSize));
wait(AimAssistTime);
}
function MultiFunction(Inc,Dec,Value,Adjust,Min,Max){  
    
    if(event_press(Inc) || get_ival(Inc) && get_ptime(Inc) > 250){
    	Value += Adjust
    	DisplayMenu = TRUE;
    	
    	if(Value > Max) 
    		return Min;
    		
    	if(!Value)
	        combo_run(RumbleOff);
	    else
	        combo_run(RumbleOn);  
    }
    if(event_press(Dec) || get_ival(Dec) && get_ptime(Dec) > 250){
    	Value -= Adjust
    	DisplayMenu = TRUE;
    	
    	if(Value < Min)
    		return Max;
    	
    	if(!Value)
	        combo_run(RumbleOff);
	    else
	        combo_run(RumbleOn);  
    }
    set_val(Inc,0); set_val(Dec,0);
    return Value; 
}
function MenuNavigation(f_index,f_min,f_max) {
	if(!get_val(Ads))
	{
		if(ModOrEditMenu[0]) 
	    {
	    	f_index = MultiFunction(PS4_DOWN,PS4_UP,f_index,1,f_min,f_max); 
		}
		
		if(!ModOrEditMenu[0])
		{
			f_index = MultiFunction(PS4_RIGHT,PS4_LEFT,f_index,1,f_min,f_max); 
	    }
	}
    if(event_release(PS4_CROSS))
	{
		if(ModOrEditMenu[0]) 
		{
    		if(ModRange[ModORVal[0]][2] != 0)  
			{
				MenuStatus(1,0,1,0,0,0);
				ModORVal[1] = ModRange[ ModORVal[0] ][ 0 ]; 
			} 
	    }
	}
	if(event_press(PS4_CROSS))
	{
		if(ModOrEditMenu[1]) 
		{
			if(ModsNToggles[ModORVal[1]][5] == 1) 
			{
				MenuStatus(1,0,0,1,0,0);
				ModORVal[2] = ModsNToggles[ ModORVal[1] ][ 3 ];
				InitializeShapeChange();
				cls_oled(0);	
			}
		}
    }
    if(event_release(PS4_CIRCLE) && !ModOrEditMenu[0])
    {
    	if(ModOrEditMenu[1]) 
    	{
    		MenuStatus(1,1,0,0,0,0);
    		InitializeShapeChange();
		}
		else if(ModOrEditMenu[2]) 
		{
			MenuStatus(1,0,1,0,0,0);
			InitializeShapeChange();
		}
	}
	ProfileIdx = MultiFunction(PS4_TRIANGLE,NOT_USE,ProfileIdx,1,0,2); 
	BlockButtons();
	return f_index; 
}
function EditableValues(ValueIndex) {

    if(ModORVal[2] == ValRangeMinMax[ValIdx++][0]) 
    { 
        if(get_ival(Ads))  
        {    
        	ValueIndex = MultiFunction(PS4_RIGHT,PS4_LEFT,ValueIndex,ValRangeMinMax[ModORVal[2]][3],ValRangeMinMax[ModORVal[2]][1],ValRangeMinMax[ModORVal[2]][2]);  
          	ValueIndex = MultiFunction(PS4_UP,PS4_DOWN,ValueIndex,ValRangeMinMax[ModORVal[2]][4],ValRangeMinMax[ModORVal[2]][1],ValRangeMinMax[ModORVal[2]][2]);  
        }
        if(ValRangeMinMax[ValIdx][0] == 5 || ValRangeMinMax[ValIdx][0] == 9) 
        	NumberToString(ValueIndex * 100, FindDigits(ValueIndex * 100));
        else
        	NumberToString(ValueIndex, FindDigits(ValueIndex));  
    }
    return ValueIndex;                
 }
function EditableSwitch(f_val) { 
	  
	if(ModORVal[2] == ValRangeMinMax[ValIdx++][0]){
	
		f_val = MultiFunction(PS4_UP,PS4_DOWN,f_val,ValRangeMinMax[ModORVal[2]][3],ValRangeMinMax[ModORVal[2]][1],ValRangeMinMax[ModORVal[2]][2]);  
		  
	    if(ValRangeMinMax[ValIdx][0] == 10){
	    	String(CurveType[ToggleAAType],Small,6,0);
	    } 
	    else if(ValRangeMinMax[ValIdx][0] == 11){
	    	if(ToggleAAType == 0)
	    		String(CircularCurve[TaylorShapes],Small,6,0);
	    	else
	    		String(SquareCurve[TaylorShapes],Small,6,0);
	    }
	    else
	    {
			if(f_val == 1)
				String(Misc[0],Small,6,0);   
			else 
			    String(Misc[1],Small,6,0);  
	    } 
	}      	
    return f_val;
}
function ToggleSwitch(f_val) { 
	  
	if(ModORVal[1] == ModsNToggles[ModIdx++][0]){
	
		f_val = MultiFunction(PS4_UP,PS4_DOWN,f_val,1,ModsNToggles[ModORVal[1]][1],ModsNToggles[ModORVal[1]][2]); 
		
		if(ModsNToggles[ModIdx][0] == 6){
			RfFireType[ProfileIdx] = MultiFunction(PS4_R1,PS4_L1,RfFireType[ProfileIdx],1,0,1); 
		}
		if(ModsNToggles[ModIdx][0] == 7){
			BfFireType[ProfileIdx] = MultiFunction(PS4_R1,PS4_L1,BfFireType[ProfileIdx],1,0,1); 
		}
	    if(ModsNToggles[ModIdx][0] == 0) { 
	    	String(ARToggle[ToggleTaylorAR[ProfileIdx]],Small,6,0);
	    }
	    else if(ModsNToggles[ModIdx][0] == 1) { 
	    	String(ProgAR[ToggleProgressive[ProfileIdx]],Small,6,0);
	    }
	    else if(ModsNToggles[ModIdx][0] == 2){
	    	String(AAToggle[ToggleTaylorAA],Small,6,0);
	    } 
	    else if(ModsNToggles[ModIdx][0] == 6){
	    	String(RFToggle[RfFireType[ProfileIdx]],Small,1,0);
	    	
	    	if(f_val == 1)
				String(Misc[0],Small,12,0);   
			else 
		    	String(Misc[1],Small,12,0);  
	    }
	    else if(ModsNToggles[ModIdx][0] == 7){
	    	String(RFToggle[BfFireType[ProfileIdx]],Small,1,0);
	    	
	    	if(f_val == 1)
				String(Misc[0],Small,12,0);   
			else 
		    	String(Misc[1],Small,12,0);  
	    }
	    else if(ModsNToggles[ModIdx][0] == 11){
	    	String(SlideType[ToggleCancelSlide],Small,6,0);
	    } 
	    else if(ModsNToggles[ModIdx][0] == 16){
	    	String(CrouchSht[ToggleCrouchShot[ProfileIdx]],Small,6,0);
	    } 
	    else if(ModsNToggles[ModIdx][0] == 19){
	    	String(VMSpeed[ToggleVmSpeed],Medium,6,0);
	    } 
	    else if(ModsNToggles[ModIdx][0] == 22){
	    	String(ControllerLayouts[Buttons],Small,6,0);
	    } 
	    else if(ModsNToggles[ModIdx][0] == 24){
	    	String(PressButtons[ActivateIndividualBtnIdx],Small,6,0);
	    } 
	    else
	    {
		    if(f_val == 1)
				String(Misc[0],Small,6,0);   
			else 
		    	String(Misc[1],Small,6,0);  
		} 		
	}  	
    return f_val;
}
function QuickToggleMods(f_hold, f_press,f_val,f_idx,f_min,f_max) {  
	if (f_hold == 0 || f_press == 0) return f_val;

	if(get_ival(f_hold))
	{
		if(event_press(f_press)) 
		{
		    ModORVal[1] = f_idx;
		    f_val = Refresh(f_val ++,ModsNToggles[ModORVal[1]][1],ModsNToggles[ModORVal[1]][2]);
		    DisplayQToggles = TRUE;
		   
	        if(!f_val)
	            combo_run(RumbleOff);
	        else
	            combo_run(RumbleOn);	
		    
	    }
	    set_val(f_press, 0) 
	} 
	if(DisplayQToggles) 
	{
		combo_run(QuickToggles);
		ScreenSaver = FALSE;
		CustomScreen = FALSE;
		cls_oled(OLED_BLACK);
		rect_oled(0, 0, OLED_WIDTH, OLED_HEIGHT, OLED_BLACK, OLED_WHITE);
		String(ModNames[ModORVal[1]],Small,-22,0);
		String(Profiles[ProfileIdx],Small,-5,0);
		
		
		if(f_val == 1) 
			String(Misc[0],Small,20,0);
	    else 
	        String(Misc[1],Small,20,0); 
	    
	 
	    DisplayQToggles = FALSE; 
	} 
    return f_val;
} 
function ButtonActivation(i){

	if(ModORVal[1] == ModsNToggles[ModIdx++][0])
 	{ 
 		HighLight = MultiFunction(PS4_DOWN,PS4_UP,HighLight,1,0,1);
 		
	    if(get_ival(Ads))
	    {
	    	if(HighLight == 0) 
	    		ActivateHoldBtnIdx[i] = MultiFunction(PS4_RIGHT,PS4_LEFT,ActivateHoldBtnIdx[i],1,0,10);
	    	else
	    		ActivatePressBtnIdx[i] = MultiFunction(PS4_RIGHT,PS4_LEFT,ActivatePressBtnIdx[i],1,0,8);
        }
        if(HighLight == 0)
        {
       		rect_oled(115,28, 6, 8, OLED_WHITE, OLED_WHITE); // HighLight 1
			rect_oled(6,28, 6, 8, OLED_WHITE, OLED_WHITE);   // HighLight 1
		}
		if(HighLight == 1)
		{
		    rect_oled(115,40, 6, 8, OLED_WHITE, OLED_WHITE); // HighLight 2
   			rect_oled(6,40, 6, 8, OLED_WHITE, OLED_WHITE);   // HighLight 2
		} 
        String(HoldButtons[ActivateHoldBtnIdx[i]],Small,1,0);
       	String(PressButtons[ActivatePressBtnIdx[i]],Small,12,0);
     }  
 }
define Y  = 32;  
int Ascii[11];
int AsciiIndex;
int LowerCase;
function DisplayAscii(Position){ 
putc_oled(1,Ascii[0])
puts_oled(26,Position,0,1,1);
putc_oled(1,Ascii[1])
puts_oled(33,Position,0,1,1);
putc_oled(1,Ascii[2])
puts_oled(40,Position,0,1,1);
putc_oled(1,Ascii[3])
puts_oled(47,Position,0,1,1);
putc_oled(1,Ascii[4])
puts_oled(54,Position,0,1,1);
putc_oled(1,Ascii[5])
puts_oled(61,Position,0,1,1);
putc_oled(1,Ascii[6])
puts_oled(68,Position,0,1,1);
putc_oled(1,Ascii[7])
puts_oled(75,Position,0,1,1);
putc_oled(1,Ascii[8])
puts_oled(82,Position,0,1,1);
putc_oled(1,Ascii[9])
puts_oled(89,Position,0,1,1);
putc_oled(1,Ascii[10])
puts_oled(96,Position,0,1,1);
	
} 
function NameChange(){ 

	if(ModORVal[1] == ModsNToggles[ModIdx++][0]) 
 	{ 
 		if(event_press(PS4_CROSS)){ 
			LowerCase =! LowerCase;
			if(LowerCase)
				Ascii[AsciiIndex] = 97; 
			else
				Ascii[AsciiIndex] = 65;
				
			DisplayMenu = TRUE;
		} 
		if(event_press(PS4_SQUARE)){ 
			Ascii[AsciiIndex] = 32;
			DisplayMenu = TRUE;
		} 
		
	    AsciiIndex = MultiFunction(PS4_RIGHT,PS4_LEFT,AsciiIndex,1,0,10);
	   
	    Ascii[AsciiIndex] = MultiFunction(PS4_UP,PS4_DOWN,Ascii[AsciiIndex],1,1,122);
	     
	    if(AsciiIndex == 0){
	    	line_oled(27,44,30,44, 2, 1 );
	   	}
	   	else if(AsciiIndex == 1){ 
	   		line_oled(34,44,37,44, 2, 1 );
	   	}
	   	else if(AsciiIndex == 2){ 
	   		line_oled(41,44,44,44, 2, 1 );
	    }
	   	else if(AsciiIndex == 3){ 
	   		line_oled(48,44,51,44,2, 1 );
	    }
	   	else if(AsciiIndex == 4){ 
	   		line_oled(55,44,58,44, 2, 1 );
	    }
	    else if(AsciiIndex == 5){ 
	   		line_oled(62,44,65,44, 2, 1 );
	    }
	    else if(AsciiIndex == 6){ 
	   		line_oled(69,44,72,44, 2, 1 );
	    }
	    else if(AsciiIndex == 7){ 
	   		line_oled(76,44,79,44, 2, 1 );
	    }
	    else if(AsciiIndex == 8){ 
	   		line_oled(82,44,85,44, 2, 1 );
	    }
	    else if(AsciiIndex == 9){ 
	   		line_oled(90,44,93,44, 2, 1 );
	    }
	    else if(AsciiIndex == 10){ 
	   		line_oled(97,44,100,44, 2, 1 );
	    }
	}
}
function ButtonActivationAR(i){

	if(ModORVal[1] == ModsNToggles[ModIdx++][0]) 
 	{ 
 		HighLight = MultiFunction(PS4_DOWN,PS4_UP,HighLight,1,0,1);
 		
	    if(get_ival(Ads))
	    {
	    	if(HighLight == 0) 
	    		ActivatePressBtnIdx1[i] = MultiFunction(PS4_RIGHT,PS4_LEFT,ActivatePressBtnIdx1[i],1,0,8);
	    	else
	    		ActivatePressBtnIdx[i] = MultiFunction(PS4_RIGHT,PS4_LEFT,ActivatePressBtnIdx[i],1,0,8);
        }
        if(HighLight == 0)
        {
       		rect_oled(115,28, 6, 8, OLED_WHITE, OLED_WHITE); // HighLight 1
			rect_oled(6,28, 6, 8, OLED_WHITE, OLED_WHITE);   // HighLight 1
		}
		if(HighLight == 1)
		{
		    rect_oled(115,40, 6, 8, OLED_WHITE, OLED_WHITE); // HighLight 2
   			rect_oled(6,40, 6, 8, OLED_WHITE, OLED_WHITE);   // HighLight 2
		} 
        String(PressButtons[ActivatePressBtnIdx1[i]],Small,1,0);
       	String(PressButtons[ActivatePressBtnIdx[i]],Small,12,0);
     }  
 }
function DisplayAR() { 
	ScreenSaver = FALSE;
	cls_oled(OLED_BLACK); 
	rect_oled(0, 0, OLED_WIDTH, OLED_HEIGHT, OLED_BLACK, OLED_WHITE);
    line_oled(0, 27, OLED_WIDTH - 1, 27, 1, OLED_WHITE);
	String(ValNames[0],Small,-22,0);
	NumberToString(TaylorARVert[ProfileIdx], FindDigits(TaylorARVert[ProfileIdx]))
}
function DisplayTitleScreen(){ 

	if(DisplayTitle)                                            
    { 	
   		cls_oled(OLED_BLACK);
   	    rect_oled(0, 0, OLED_WIDTH, OLED_HEIGHT, OLED_BLACK, OLED_WHITE);
    	String(Misc[9],Small,-22,0);
    	String(Misc[10],Medium,-8,0);
    	String(Profiles[ProfileIdx],Small,25,0);
    	DisplayAscii(Y2);
    	DisplayTitle = FALSE;
        ScreenSaver  = TRUE; 
	}
	// Display a Blank Screen after 10 seconds ( Prevents Screen Burn on The OLED Screen ) 
	if(ScreenSaver) 
	{
    	BlankScreen += get_rtime();
    	
		if(BlankScreen >= 10000)
		{
			cls_oled(OLED_BLACK);
			BlankScreen = 0;
			ScreenSaver = FALSE;
			CustomScreen = TRUE;
    	} 
    }
    if(CustomScreen){ 
    	DGT += get_rtime();
    	
		if(DGT >= 100) 
		{
			SD1 += 2;	TP1 += 1;	TP2 -= 1;	DGT  = 0;
		}
		DGR += get_rtime();
		
		if(DGR >= 30) 
		{
			Y_1 += 1;	Y_2 += 2;	Y_3 += 3;	Y_4 += 4;
			Y_5 += 5;	Y_6 += 6;	Y_7 += 7;	Y_8 += 8;
			DGR  = 0;
		}
		
		name();
		MSC += get_rtime();
		
		if(MSC >= 1000) 
		{
			MSC = 0;	
			RT += 1;
		}
		
		if(RT == 15) 
		{
			CustomScreen = 0;
			RT = 0;
			cls_oled(0);
		}
    }
    
}
combo RACE {
	X_1 = random(0,127);
	wait(SAVER1);
	X_2 = random(0,127);
	wait(SAVER1);
	X_3 = random(0,127);
	wait(SAVER1);
	X_4 = random(0,127);
	wait(SAVER1); 
	X_5 = random(0,127);
	wait(SAVER1);
	X_6 = random(0,127);
	wait(SAVER1); 
	X_7 = random(0,127);
	wait(SAVER1); 
	X_8 = random(0,127);
	wait(SAVER1);
}
combo RN {
	RN1 = random(65,90);
	RN2 = random(60,90);
	RN3 = random(65,90);
	RN4 = random(65,90); 
	RN5 = random(65,90);
	RN6 = random(65,90);
	RN7 = random(65,90);
	RN8 = random(65,90);
	wait(SAVER);
}
function name(){
	cls_oled(0);
	combo_run(RACE);
	combo_run(RN);
if (Y_1 > 64)  Y_1 =   0;
if (Y_2 > 64)  Y_2 =   0;
if (Y_3 > 64)  Y_3 =   0;
if (Y_4 > 64)  Y_4 =   0;
if (Y_5 > 64)  Y_5 =   0;
if (Y_6 > 64)  Y_6 =   0;
if (Y_7 > 64)  Y_7 =   0;
if (Y_8 > 64)  Y_8 =   0;
if (SD1 > 105) SD1 = -50;
if (TP1 > 45)  TP1 =   0;
if (TP2 < 0)   TP2 =  55;
	putc_oled(1,RN1);
	puts_oled(X_1,Y_1,0,1,1);
	putc_oled(1,RN2);
	puts_oled(X_2,Y_2,0,1,1);
	putc_oled(1,RN3);
	puts_oled(X_3,Y_3,0,1,1);
	putc_oled(1,RN4);
	puts_oled(X_4,Y_4,0,1,1);
	putc_oled(1,RN5);
	puts_oled(X_5,Y_5,0,1,1);
	putc_oled(1,RN6);
	puts_oled(X_6,Y_6,0,1,1);
	putc_oled(1,RN7);
	puts_oled(X_7,Y_7,0,1,1);
	putc_oled(1,RN8);
	puts_oled(X_8,Y_8,0,1,1);
	putc_oled(1,Ascii[0]);
	puts_oled(SSMU1 + SD1,TP1 + 2,0,1,1);
	putc_oled(1,Ascii[1]);
	puts_oled(SSMU2 + SD1,TP2 + 4,0,1,1);
	putc_oled(1,Ascii[2]);
	puts_oled(SSMU3 + SD1,TP1 + 6,0,1,1);
	putc_oled(1,Ascii[3]);
	puts_oled(SSMU4 + SD1,TP2 + 8,0,1,1);
	putc_oled(1,Ascii[4]);
	puts_oled(SSMU5 + SD1,TP1 + 10,0,1,1);
	putc_oled(1,Ascii[5]);
	puts_oled(SSMU6 + SD1,TP2 + 12,0,1,1);
	putc_oled(1,Ascii[6]);
	puts_oled(SSMU7 + SD1,TP1 + 14,0,1,1);
	putc_oled(1,Ascii[7]);
	puts_oled(SSMU8 + SD1,TP1 + 16,0,1,1);
	putc_oled(1,Ascii[8]);
	puts_oled(SSMU9 + SD1,TP1 + 18,0,1,1);
	putc_oled(1,Ascii[9]);
	puts_oled(SSMU10 + SD1,TP1 + 20,0,1,1);
	putc_oled(1,Ascii[10]);
	puts_oled(SSMU11 + SD1,TP1 + 22,0,1,1);
}
combo FastMelee {
set_val(Melee, 100);
wait(35);
set_val(Melee, 0);
wait(30);  
}
combo JumpShot {
set_val(Jump,100);
wait(100);
}
combo DriveMode { 
cls_oled(0);
String(Misc[13],Medium,-15,0);
String(Misc[11],Medium,10,0);
wait(1500);
DisplayTitle = TRUE;
} 
int InstaDropShot;
combo InstaDrop {
set_val(Crouch,100);
wait(1000);
set_val(Crouch,0);
InstaDropShot = FALSE;
}
combo BurstFire { 
wait(HoldTime);
call(RAPIDFIRE);
call(RAPIDFIRE);
call(RAPIDFIRE);
call(RAPIDFIRE);
}
combo Strafe { 
offset(PS4_LX,100);
wait(StrafeTime);
wait(20);
offset(PS4_LX,-100);
wait(StrafeTime);
wait(20);
} 
combo StrafeAA { 
offset(PS4_LX,50);
wait(SpeedAngle);
wait(20);
offset(PS4_LX,-50);
wait(SpeedAngle);
wait(20);
} 
combo CrouchShotCmb {
set_val(Crouch,100);
wait(50);
set_val(Crouch,0);
wait(CrouchSpeed);
}
combo HoldBreath {
set_val(Sprint,0);
wait(60);
set_val(Sprint,100);
wait(110);
set_val(Sprint,0);
wait(110);
}
combo Bunnyhop{
set_val(Jump, 100);
wait(30);
set_val(Jump, 0);
wait(30);
set_val(Jump, 100);
wait(30);
set_val(Jump, 0);
wait(30);
}
combo CancelSlideMW {              
set_val(Crouch, 100);          
wait(SlideDelay);                         
set_val(Crouch, 0);            
wait(60);                          
set_val(Crouch, 100);          
wait(50);                          
set_val(Crouch, 100);          
set_val(Jump, 100);           
wait(60);                          
set_val(Crouch, 0);            
set_val(Jump, 100);          
wait(10);                        
set_val(Jump, 0);
} 
combo CancelSlideCW {
set_val(Crouch, 100);
wait(SlideDelay);
set_val(Crouch, 0);
wait(20);
set_val(Sprint, 0);
set_val(Crouch, 100);
set_val(Sprint, 100);
wait(20);
set_val(Crouch, 0);
set_val(Sprint, 0);
wait(20);
}
combo CancelReload {
set_val(Swap,100);
wait(20);
wait(20)
set_val(Swap,100);
wait(20);
ReloadInProgress = FALSE; }
combo StrafeShot{ 
offset(PS4_LX,100);
wait(StrafeShotTime);
wait(50);
offset(PS4_LX,-100);
wait(StrafeShotTime);
wait(20);
}
combo Saved { 
cls_oled(0); 
String(Misc[17],Medium,0,0);
wait(2000);
DisplayTitle = TRUE; 
} 
function GetRumble(f_rumble,f_strength,f_val,f_divide){ 

	f_rumble = get_rumble(RumbleToUse());

	if(f_rumble > 10 && f_rumble < 90) 
	{
		f_strength = f_val + f_rumble / f_divide;
	} 	
} 
combo QuickToggles{ 
wait(1500) 
DisplayTitle  = TRUE; 
reset_leds(); 
InitializeShapeChange();
} 
function ActivateAllButtons(){
    
    for (i = 0; i < ActivateButtonCount; i++) 
    {
        ActivateHoldButton[i]          = HoldBtns[clamp(ActivateHoldBtnIdx[i], 0, sizeof(HoldBtns))];
        ActivatePressButton[i]         = PressBtns[clamp(ActivatePressBtnIdx[i],0, sizeof(PressBtns))];
        ActivatePressButton1[i]        = PressBtns[clamp(ActivatePressBtnIdx1[i],0, sizeof(PressBtns))];
        ActivateIndividualButton       = PressBtns[clamp(ActivateIndividualBtnIdx, 0, sizeof(PressBtns))];   
    }
    return;   
} 
function correctAngle(angle){
  if(angle < 0) angle = 360 + (angle % 360);
  angle = (angle + 90) % 360;
  return angle;
}
function offset(Stick,Value) {
  set_val(Stick, clamp(Value * (100 - abs(get_val(Stick))) / 100 + get_val(Stick), -100, 100));
  return;
}
function sin(angle){
	if(ToggleAAType == 0) return PolarArray[correctAngle(angle)];
  	return LinearArray[correctAngle(angle)]; 
}
function cos(angle){
	if(ToggleAAType == 0) return PolarArray[(correctAngle(angle) + 90) % 360];
    return LinearArray[(correctAngle(angle) + 90) % 360];
}
combo RAPIDFIRE { 
wait(HoldTime);
set_val(Fire, 0);
wait(RestTime);
}		     
combo BLINK {
wait(LedOn);
led(7);
wait(LedOff);
} 
combo Blink{
led(6);
wait(LedOn);
led(7);
wait(LedOff);
}
combo RumbleOn {
set_ledx(2, 2);
set_rumble(RUMBLE_B, 50);
wait(150);
reset_rumble();
wait(100);
set_rumble(RUMBLE_B, 50);
wait(150);
reset_rumble();
reset_leds();
led(ProfileIdx);
}
combo RumbleOff {						
set_ledx(1, 1);
set_rumble(RUMBLE_A, 50);
wait(300);
reset_rumble();
wait(400);
reset_leds();
led(ProfileIdx);
}
function LedBlink(f_on,f_off) {
	LedOn  = f_on;
	LedOff = f_off;
	combo_run(BLINK);
}
function MenuStatus(f_display,f_mainmenu,f_modmenu,f_editmenu,f_adjustables,f_displaytitle) { 

    DisplayMenu      = f_display;
	ModOrEditMenu[0] = f_mainmenu;
	ModOrEditMenu[1] = f_modmenu;
	ModOrEditMenu[2] = f_editmenu;
	ModOrEditMenu[3] = f_adjustables;
	DisplayTitle     = f_displaytitle;
	
} 
function Refresh(Value,Min,Max){  
 	
    if(Value > Max) return Min;
    if(Value < Min) return Max;  
   		   
    return Value; 
}
function String (stringLabel,fontSize,offsetY,offsetX) {
    
    if (fontSize == Small) {
        stringPosition = (127 - get_string_length(stringLabel) * 7) / 2;
        stringHeight = (64 - 10) / 2;
    } 
    
    else if (fontSize == Medium) {
        stringPosition = (127 - get_string_length(stringLabel) * 10) / 2;
        stringHeight = (64 - 16) / 2;
    }
    
    else if (fontSize == Large) {
        stringPosition = (127 - get_string_length(stringLabel) * 15) / 2;
        stringHeight = (64 - 21) / 2;
    }
    Print(stringPosition,stringHeight,stringLabel,fontSize,offsetY,offsetX);
}
function get_string_length(offset) { 
    stringLength = 0;
    do { 
        offset++;
        stringLength++;
    } while (duint8(offset));
    return stringLength;
}
function Print (positionString,heightString,captionString,sizeFont,offSetY,offSetX) {
    
        printf(positionString + offSetX,heightString + offSetY,sizeFont,1,captionString);
}
function led(f_color){
for(i = 0; i <= 3; i++) 
{
 set_led(i,duint8((f_color * 4) + i));
 }
}
function GetEntriesStrings(x) {
    do {
        x++;
    } while (MainMenuId[x] != -1);
    return x;
}

function GetCharsStrings(x){
	if (MainMenuId[x + 1] != -1) return MainMenuId[x + 1] - MainMenuId[x] - 1;
 	return sizeof(MainMenuId) - MainMenuId[x];
}
function RumbleToUse() {
    if(get_rumble(RUMBLE_A) == get_rumble(RUMBLE_B)) 
    {
        return RUMBLE_A;
    }
    if(get_rumble(RUMBLE_A) == 100) 
    {
    	return RUMBLE_B;
	}
	if(get_rumble(RUMBLE_B) == 100) 
	{
    	return RUMBLE_A;
	}
    if(get_rumble(RUMBLE_A) > get_rumble(RUMBLE_B)) 
    {
        return RUMBLE_A;
    }
    if(get_rumble(RUMBLE_A) < get_rumble(RUMBLE_B)) 
    {
        return RUMBLE_B;
    }
    return 0;
}
int bufferIndex;
int charIndex,digitIndex;
function NumberToString(f_val,f_digits) {
    bufferIndex = 1;  
    digitIndex = 10000;
    if(f_val < 0) {                    //--neg numbers
         putc_oled(bufferIndex,45);    //--add leading "-"
         bufferIndex += 1;
         f_val = abs(f_val);
    } 
    for(charIndex = 5; charIndex >= 1; charIndex--) {
        if(f_digits >= charIndex) {
            putc_oled(bufferIndex,(f_val / digitIndex) + 48);
            f_val %= digitIndex;
            bufferIndex ++; 
            if(charIndex == 4) {
                putc_oled(bufferIndex,44);//--add ","
                bufferIndex ++;
            }
        }
        digitIndex /= 10;
    } 
    puts_oled(64 - ((OLED_FONT_MEDIUM_WIDTH * bufferIndex - 1) / 2),30,OLED_FONT_MEDIUM,bufferIndex - 1,OLED_WHITE);
} 
int logVal,i;
function FindDigits(num) {
   logVal = 0;
   do {
      num /= 10;
      logVal++;
   } while (num);
   return logVal;
}	
	// Led's For Zen Eyes \\
data(
//  0 Blue    1 Pink   2 SkyBlue  3 Green         
    1,0,0,0,  0,0,0,1,  1,0,1,0,  0,0,1,0,
//  4 Yellow  5 White   6 Red      7 OFF         
    0,1,1,0,  1,1,1,0,  0,1,0,0,  0,0,0,0 );
const uint8 MenuOnlyButtons [] = {  
  PS4_L2,PS4_OPTIONS,PS4_LEFT, PS4_RIGHT,PS4_UP,PS4_DOWN,PS4_CROSS,PS4_CIRCLE,PS4_SQUARE,PS4_TRIANGLE,PS4_L1,PS4_R1,PS4_R2};

function BlockButtons (){  
    for(i = 0; i < 13; i++){
    	if(get_ival(MenuOnlyButtons[i]) || event_press(MenuOnlyButtons[i])){
        	set_val(MenuOnlyButtons[i],0); 
        	set_val(Tactical,0);
        	set_val(Ping,0);
        }    
    }
}
int mask;
int ret;
int pval_data;

function pack_usigned(int pvar, int ret, int position, int number_of_bits){ 
	for(i = position; i< (number_of_bits + position); i++)
	{
		pvar = pvar & (~(1 << i));
	}
	pvar = pvar | (ret<<position);
return pvar;
}
function unpack_usigned(int pvar, int position, int number_of_bits){
	mask = 0;
	ret = 0;
	for(i = 0; i< number_of_bits ; i++)
	{
		mask = mask | (1 << i);
	}
	mask = mask <<position
	ret = (pvar & mask) >> position
return ret;
}
function pack_int8_to_int16(int var1, int var2){

	ret = 0;
	if(var1 < 0)
  	{
   		var1 = abs(var1) | 0x80;
  	}
	ret = (abs(var2)<<8)|var1;
	
	if(var2<0)
		ret *= -1;
return ret;
}
function unpack_int16_to_int8(int pvar, int var){
	ret = 0;
	if(var == 0)
	{	 
		ret = 0x80 & abs(pvar) ;
		ret = ret >> 7;
		ret = ((-2) * ret) + 1;
		ret = ( abs(pvar) & 0x7F) * ret;
	}
	else
	{
		ret = pvar>>8;

	    if(pvar<0)
	    {
			ret += 1;
		}
	}
	return ret;
}
function Load(){ 

 pval_data = get_pvar(SPVAR_1, -32767, 32767, 0);
 TaylorARVert[0]       = unpack_int16_to_int8(pval_data, 0);
 TaylorARVert[1]       = unpack_int16_to_int8(pval_data, 1);
 
 pval_data = get_pvar(SPVAR_2, -32767, 32767, 0);
 TaylorARVert[2]       = unpack_int16_to_int8(pval_data, 0);
 TaylorARHoriz[0]      = unpack_int16_to_int8(pval_data, 1);
 
 pval_data = get_pvar(SPVAR_3, -32767, 32767, 0);
 TaylorARHoriz[1]      = unpack_int16_to_int8(pval_data, 0);
 TaylorARHoriz[2]      = unpack_int16_to_int8(pval_data, 1);
 
 pval_data = get_pvar(SPVAR_4, -32767, 32767, 0);
 VerticalStart   [0]       = unpack_int16_to_int8(pval_data, 0);
 VerticalStart   [1]       = unpack_int16_to_int8(pval_data, 1);

 pval_data = get_pvar(SPVAR_5, -32767, 32767, 0);
 VerticalMid     [0]      = unpack_int16_to_int8(pval_data, 0);
 VerticalMid     [1]      = unpack_int16_to_int8(pval_data, 1);
 
 pval_data = get_pvar(SPVAR_6, -32767, 32767, 0);
 VerticalEnd     [0]       = unpack_int16_to_int8(pval_data, 0);
 VerticalEnd     [1]       = unpack_int16_to_int8(pval_data, 1);
 	
 pval_data = get_pvar(SPVAR_7, 1, 32767, 0);
 VerticalTime    [0]       = unpack_int16_to_int8(pval_data, 0);
 VerticalTime    [1]       = unpack_int16_to_int8(pval_data, 1);
 
 pval_data = get_pvar(SPVAR_8, -32767, 32767, 0);
 HorizontalStart [0]      = unpack_int16_to_int8(pval_data, 0);
 HorizontalStart [1]      = unpack_int16_to_int8(pval_data, 1);	
 
 pval_data = get_pvar(SPVAR_9, -32767, 32767, 0);
 HorizontalMid [0]      = unpack_int16_to_int8(pval_data, 0);
 HorizontalMid [1]      = unpack_int16_to_int8(pval_data, 1);
 
 pval_data = get_pvar(SPVAR_10, -32767, 32767, 0);
 HorizontalEnd [0]      = unpack_int16_to_int8(pval_data, 0);
 HorizontalEnd [1]      = unpack_int16_to_int8(pval_data, 1);
 
 pval_data = get_pvar(SPVAR_11, 1, 32767, 0);
 HorizontalTime [0]      = unpack_int16_to_int8(pval_data, 0);
 HorizontalTime [1]      = unpack_int16_to_int8(pval_data, 1);
 
 pval_data = get_pvar(SPVAR_12, -32767, 32767, 0);
 VerticalStart[2]  = unpack_int16_to_int8(pval_data, 0);
 VerticalMid[2]    = unpack_int16_to_int8(pval_data, 1);
 
 pval_data = get_pvar(SPVAR_13, -32767, 32767, 0);
 VerticalEnd     [2]       = unpack_int16_to_int8(pval_data, 0);
 HorizontalStart [2]       = unpack_int16_to_int8(pval_data, 1);
 
 pval_data = get_pvar(SPVAR_14, -32767, 32767, 0);
 HorizontalMid    [2]       = unpack_int16_to_int8(pval_data, 0);
 HorizontalEnd    [2]       = unpack_int16_to_int8(pval_data, 1);

 pval_data = get_pvar(SPVAR_15, 1, 32767, pack_int8_to_int16(0, 0));
 VerticalTime     [2]       = unpack_int16_to_int8(pval_data, 0);
 HorizontalTime   [2]       = unpack_int16_to_int8(pval_data, 1);
 
 pval_data = get_pvar(SPVAR_16, 1, 32767, pack_int8_to_int16(0,0));
 ToggleTaylorAA             = unpack_int16_to_int8(pval_data, 0);
 TaylorShapes               = unpack_int16_to_int8(pval_data, 1);
 
 pval_data = get_pvar(SPVAR_17, 1, 32767, pack_int8_to_int16(15,15));
 TaylorRadius               = unpack_int16_to_int8(pval_data, 0);
 TaylorAngle                = unpack_int16_to_int8(pval_data, 1);
 
 pval_data = get_pvar(SPVAR_18, 1, 32767, pack_int8_to_int16(10,10));
 AdsSpeed               = unpack_int16_to_int8(pval_data, 0);
 AdsRadius              = unpack_int16_to_int8(pval_data, 1);

 pval_data = get_pvar(SPVAR_19, 1, 32767, pack_int8_to_int16(2,2));
 TrackingSize     = unpack_int16_to_int8(pval_data,0);
 TrackingSpeed    = unpack_int16_to_int8(pval_data,1);

 pval_data = get_pvar(SPVAR_20, 1, 32767, pack_int8_to_int16(10,5));
 TaylorPBoostStr     = unpack_int16_to_int8(pval_data, 0);
 TaylorABoostSpd     = unpack_int16_to_int8(pval_data, 1);
 
 pval_data = get_pvar(SPVAR_21, 1, 32767, pack_int8_to_int16(15,10));
 AimAssistSize          = unpack_int16_to_int8(pval_data, 0);
 AimAssistTime          = unpack_int16_to_int8(pval_data, 1);
 
 pval_data = get_pvar(SPVAR_22, 1, 32767, pack_int8_to_int16(20,30));
 HeadShotStrength        = unpack_int16_to_int8(pval_data, 0);
 Smoothing               = unpack_int16_to_int8(pval_data, 1);
 
 HeadShotHold            = get_pvar(SPVAR_23, 1,2000, 800);
 
 pval_data = get_pvar(SPVAR_24, 1, 32767, pack_int8_to_int16(1,1));
 RateOfFire[0]         = unpack_int16_to_int8(pval_data, 0);
 RateOfFire[1]         = unpack_int16_to_int8(pval_data, 1);
 
 pval_data = get_pvar(SPVAR_25, 1, 32767, pack_int8_to_int16(1,0));
 RateOfFire[2]         = unpack_int16_to_int8(pval_data, 0);
 ToggleTaylorAR[0]     = unpack_int16_to_int8(pval_data, 1); 
 
 pval_data = get_pvar(SPVAR_26, 1, 32767, pack_int8_to_int16(0,0));
 ToggleTaylorAR[1]     = unpack_int16_to_int8(pval_data, 0);
 ToggleTaylorAR[2]     = unpack_int16_to_int8(pval_data, 1);
 
 pval_data = get_pvar(SPVAR_27, 1, 32767, 0);
 ToggleAAType        = unpack_usigned(pval_data, 0, 1);
 TaylorTracking      = unpack_usigned(pval_data, 1, 1);
 ToggleBoostFire     = unpack_usigned(pval_data, 2, 1);
 ToggleBattsStickyAim = unpack_usigned(pval_data,3, 1);
 ShapeDirection      = unpack_usigned(pval_data, 4, 1);
 HeadAssist    	    = unpack_usigned(pval_data, 5, 1);
 ToggleBlockRumble  = unpack_usigned(pval_data, 6, 1);
 ToggleJumpShot[0]  = unpack_usigned(pval_data, 7, 1);
 ToggleJumpShot[1]  = unpack_usigned(pval_data, 8, 1);
 ToggleJumpShot[2]  = unpack_usigned(pval_data,9, 1);
 ToggleFastMelee[0]= unpack_usigned(pval_data,10, 1);
 ToggleFastMelee[1]= unpack_usigned(pval_data,11, 1);
 ToggleFastMelee[2] = unpack_usigned(pval_data,12, 1);
 
 
 pval_data = get_pvar(SPVAR_28, 1, 32767, 0);
 ToggleRapidFire[0]	= unpack_usigned(pval_data, 0, 1);
 ToggleRapidFire[1]	= unpack_usigned(pval_data, 1, 1);
 ToggleRapidFire[2]	= unpack_usigned(pval_data, 2, 1);
 ToggleBurstFire[0]	= unpack_usigned(pval_data, 3, 1);
 ToggleBurstFire[1]	= unpack_usigned(pval_data, 4, 1);
 ToggleBurstFire[2]	= unpack_usigned(pval_data, 5, 1);
 ToggleStrafeShot[0]= unpack_usigned(pval_data, 6, 1);
 ToggleStrafeShot[1]= unpack_usigned(pval_data, 7, 1);
 ToggleStrafeShot[2]= unpack_usigned(pval_data, 8, 1);
 ToggleCancelReload = unpack_usigned(pval_data, 9, 1);
 ToggleTaylorSens   = unpack_usigned(pval_data,10, 1);
 ToggleEnemyPing    = unpack_usigned(pval_data,11, 1);
 
 
 pval_data = get_pvar(SPVAR_29, 1, 32767, 0);
 ToggleHoldBreath[0] = unpack_usigned(pval_data,0, 1);
 ToggleHoldBreath[1] = unpack_usigned(pval_data,1, 1);
 ToggleHoldBreath[2] = unpack_usigned(pval_data,2, 1);
 ToggleBunnyHop  	 = unpack_usigned(pval_data,3, 1);
 ToggleProneShot[0]  = unpack_usigned(pval_data,4, 1);
 ToggleProneShot[1]  = unpack_usigned(pval_data,5, 1);
 ToggleProneShot[2]  = unpack_usigned(pval_data,6, 1);
 ToggleAutoAim[0]    = unpack_usigned(pval_data,7, 1);
 ToggleAutoAim[1]    = unpack_usigned(pval_data,8, 1);
 ToggleAutoAim[2]    = unpack_usigned(pval_data,9, 1);
 ToggleSniperMode[0]= unpack_usigned(pval_data,10, 1);
 ToggleSniperMode[1]= unpack_usigned(pval_data,11, 1);
 ToggleSniperMode[2]= unpack_usigned(pval_data,12, 1); 
 
 pval_data = get_pvar(SPVAR_30, 1, 32767, 0);
 ToggleAutoRF       = unpack_usigned(pval_data,0, 1);
 ToggleAutoHB       = unpack_usigned(pval_data,1, 1);
 RfFireType[0]      = unpack_usigned(pval_data,2, 1);
 RfFireType[1]      = unpack_usigned(pval_data,3, 1);
 RfFireType[2]      = unpack_usigned(pval_data,4, 1);
 BfFireType[0]      = unpack_usigned(pval_data,5, 1);
 BfFireType[1]      = unpack_usigned(pval_data,6, 1);
 BfFireType[2]      = unpack_usigned(pval_data,7, 1);
 ToggleSpeedStrafe[0]= unpack_usigned(pval_data,8, 1);
 ToggleSpeedStrafe[1]= unpack_usigned(pval_data,9, 1);
 ToggleSpeedStrafe[2]= unpack_usigned(pval_data,10,1);
 
 GeneralSens        = get_pvar(SPVAR_31,   1, 327,  100); 
 AdsSens            = get_pvar(SPVAR_32,   1, 327,  100); 
 FireSens           = get_pvar(SPVAR_33,   1, 327,  100);
 AdsFireSens        = get_pvar(SPVAR_34,   1, 327,  100); 
 MaxReloadTime      = get_pvar(SPVAR_35,   1,9000, 2000);
 SlideDelay         = get_pvar(SPVAR_36,   1, 200,  120);
 StrafeShotTime     = get_pvar(SPVAR_37,   1, 999,  500);
 BurstFireHold      = get_pvar(SPVAR_38,   1, 999,  150); 
 BurstFireRelease   = get_pvar(SPVAR_39,   1, 999,  150); 
 CrouchSpeed        = get_pvar(SPVAR_40,   1, 120,   60);
 StrafeTime         = get_pvar(SPVAR_41,   1, 999,  300);
 
 pval_data = get_pvar(SPVAR_42, 1, 32767,pack_int8_to_int16(0, 0));
 ToggleProgressive[0] = unpack_int16_to_int8(pval_data, 0);
 ToggleProgressive[1] = unpack_int16_to_int8(pval_data, 1);
 
 pval_data = get_pvar(SPVAR_43, 1, 32767,pack_int8_to_int16(0, 0));
 ToggleProgressive[2] = unpack_int16_to_int8(pval_data, 0);
 ToggleCrouchShot[0]  = unpack_int16_to_int8(pval_data, 1);
 
 pval_data = get_pvar(SPVAR_44, 1, 32767,pack_int8_to_int16(0, 0));
 ToggleCrouchShot[1] = unpack_int16_to_int8(pval_data, 0);
 ToggleCrouchShot[2] = unpack_int16_to_int8(pval_data, 1);
 
 pval_data = get_pvar(SPVAR_45, 1, 32767, pack_int8_to_int16(0, 0));
 ActivateIndividualBtnIdx = unpack_int16_to_int8(pval_data, 0);
 ToggleCancelSlide        = unpack_int16_to_int8(pval_data, 1);
 
pval_data = get_pvar(SPVAR_46, 1, 32767, pack_int8_to_int16(0, 0));
ActivateHoldBtnIdx [0]      = unpack_int16_to_int8(pval_data, 0);
ActivatePressBtnIdx[0]      = unpack_int16_to_int8(pval_data, 1);

pval_data = get_pvar(SPVAR_47, 1, 32767, pack_int8_to_int16(0, 0));
ActivateHoldBtnIdx [1]      = unpack_int16_to_int8(pval_data, 0);
ActivatePressBtnIdx[1]      = unpack_int16_to_int8(pval_data, 1);

pval_data = get_pvar(SPVAR_48, 1, 32767, pack_int8_to_int16(0, 0));
ActivateHoldBtnIdx [2]      = unpack_int16_to_int8(pval_data, 0);
ActivatePressBtnIdx[2]      = unpack_int16_to_int8(pval_data, 1);

pval_data = get_pvar(SPVAR_49, 1, 32767, pack_int8_to_int16(0, 0));
ActivateHoldBtnIdx [3]      = unpack_int16_to_int8(pval_data, 0);
ActivatePressBtnIdx[3]      = unpack_int16_to_int8(pval_data, 1);

pval_data = get_pvar(SPVAR_50, 1, 32767, pack_int8_to_int16(0, 0));
ActivateHoldBtnIdx [4]      = unpack_int16_to_int8(pval_data, 0);
ActivatePressBtnIdx[4]      = unpack_int16_to_int8(pval_data, 1);

pval_data = get_pvar(SPVAR_51, 1, 32767, pack_int8_to_int16(0, 0));
ActivateHoldBtnIdx [5]     = unpack_int16_to_int8(pval_data, 0);
ActivatePressBtnIdx[5]     = unpack_int16_to_int8(pval_data, 1);
 
pval_data = get_pvar(SPVAR_52, 1, 32767, pack_int8_to_int16(5,5));
HandGunAASpeed             = unpack_int16_to_int8(pval_data, 0);
HandGunAASize              = unpack_int16_to_int8(pval_data, 1);

HandGunVertical      = get_pvar(SPVAR_53,   -99, 99,  5);     
 
pval_data = get_pvar(SPVAR_54, 1, 32767, pack_int8_to_int16(0, 0));
Buttons                   = unpack_int16_to_int8(pval_data, 0);
ToggleVmSpeed             = unpack_int16_to_int8(pval_data, 1);

pval_data = get_pvar(SPVAR_55, 1, 32767, pack_int8_to_int16(0, 0));
ActivatePressBtnIdx1[6]   = unpack_int16_to_int8(pval_data, 0);
ActivatePressBtnIdx[6]    = unpack_int16_to_int8(pval_data, 1);

ActiveTime      = get_pvar(SPVAR_56,1, 2000,900); 
PingDelay       = get_pvar(SPVAR_57,1, 5000,1000); 

pval_data = get_pvar(SPVAR_58, 1, 32767, pack_int8_to_int16(84, 97));
Ascii[0]  = unpack_int16_to_int8(pval_data, 0);
Ascii[1]  = unpack_int16_to_int8(pval_data, 1);

pval_data = get_pvar(SPVAR_59, 1, 32767, pack_int8_to_int16(121,108));
Ascii[2]  = unpack_int16_to_int8(pval_data, 0);
Ascii[3]  = unpack_int16_to_int8(pval_data, 1);

pval_data = get_pvar(SPVAR_60, 1, 32767, pack_int8_to_int16(111,114));
Ascii[4]  = unpack_int16_to_int8(pval_data, 0);
Ascii[5]  = unpack_int16_to_int8(pval_data, 1);

pval_data = get_pvar(SPVAR_61, 1, 32767, pack_int8_to_int16(100,114));
Ascii[6]  = unpack_int16_to_int8(pval_data, 0);
Ascii[7]  = unpack_int16_to_int8(pval_data, 1);

pval_data = get_pvar(SPVAR_62, 1, 32767, pack_int8_to_int16(105,102));
Ascii[8]  = unpack_int16_to_int8(pval_data, 0);
Ascii[9]  = unpack_int16_to_int8(pval_data, 1);

Ascii[10] = get_pvar(SPVAR_63,32,122,116); 

}
function Save(){ 

 pval_data = pack_int8_to_int16(TaylorARVert[0],TaylorARVert[1]);    
 set_pvar(SPVAR_1,pval_data); 
 pval_data = pack_int8_to_int16(TaylorARVert[2],TaylorARHoriz[0]);    
 set_pvar(SPVAR_2,pval_data);
 pval_data = pack_int8_to_int16(TaylorARHoriz[1],TaylorARHoriz[2]);    
 set_pvar(SPVAR_3,pval_data);
 pval_data = pack_int8_to_int16(VerticalStart[0],VerticalStart[1]);     
 set_pvar(SPVAR_4,pval_data);
 pval_data = pack_int8_to_int16(VerticalMid[0],VerticalMid[1]); 
 set_pvar(SPVAR_5,pval_data); 
 pval_data = pack_int8_to_int16(VerticalEnd[0],VerticalEnd[1]);     
 set_pvar(SPVAR_6,pval_data); 
 pval_data = pack_int8_to_int16(VerticalTime[0],VerticalTime[1]); 
 set_pvar(SPVAR_7,pval_data);
 pval_data = pack_int8_to_int16(HorizontalStart[0],HorizontalStart[1]);     
 set_pvar(SPVAR_8,pval_data);
 pval_data = pack_int8_to_int16(HorizontalMid[0],HorizontalMid[1]);     
 set_pvar(SPVAR_9,pval_data);
 pval_data = pack_int8_to_int16(HorizontalEnd[0],HorizontalEnd[1]);     
 set_pvar(SPVAR_10,pval_data);
 pval_data = pack_int8_to_int16(HorizontalTime[0],HorizontalTime[1]);     
 set_pvar(SPVAR_11,pval_data);
 pval_data = pack_int8_to_int16(VerticalStart[2],VerticalMid[2]);    
 set_pvar(SPVAR_12,pval_data);
 pval_data = pack_int8_to_int16(VerticalEnd[2],HorizontalStart[2]);     
 set_pvar(SPVAR_13,pval_data);
 pval_data = pack_int8_to_int16(HorizontalMid[2],HorizontalEnd[2]);     
 set_pvar(SPVAR_14,pval_data);
 pval_data = pack_int8_to_int16(VerticalTime[2],HorizontalTime[2]);     
 set_pvar(SPVAR_15,pval_data);
 pval_data = pack_int8_to_int16(ToggleTaylorAA,TaylorShapes);    
 set_pvar(SPVAR_16,pval_data); 
 pval_data = pack_int8_to_int16(TaylorRadius,TaylorAngle);    
 set_pvar(SPVAR_17,pval_data); 
 pval_data = pack_int8_to_int16(AdsSpeed,AdsRadius);    
 set_pvar(SPVAR_18,pval_data); 
 pval_data = pack_int8_to_int16(TrackingSize,TrackingSpeed);    
 set_pvar(SPVAR_19,pval_data);
 pval_data = pack_int8_to_int16(TaylorPBoostStr,TaylorABoostSpd);    
 set_pvar(SPVAR_20,pval_data); 
 pval_data = pack_int8_to_int16(AimAssistSize,AimAssistTime);    
 set_pvar(SPVAR_21,pval_data); 
 pval_data = pack_int8_to_int16(HeadShotStrength,Smoothing);      
 set_pvar(SPVAR_22,pval_data);
 set_pvar(SPVAR_23,HeadShotHold);  
 pval_data = pack_int8_to_int16(RateOfFire[0],RateOfFire[1]);    
 set_pvar(SPVAR_24,pval_data);
 pval_data = pack_int8_to_int16(RateOfFire[2],ToggleTaylorAR[0]);    
 set_pvar(SPVAR_25,pval_data);
 pval_data = pack_int8_to_int16(ToggleTaylorAR[1],ToggleTaylorAR[2]);    
 set_pvar(SPVAR_26,pval_data);
 
 pval_data = pack_usigned(pval_data, ToggleAAType         ,0, 1);
 pval_data = pack_usigned(pval_data, TaylorTracking       ,1, 1);
 pval_data = pack_usigned(pval_data, ToggleBoostFire      ,2, 1);
 pval_data = pack_usigned(pval_data, ToggleBattsStickyAim ,3, 1);
 pval_data = pack_usigned(pval_data, ShapeDirection       ,4, 1);
 pval_data = pack_usigned(pval_data, HeadAssist          , 5, 1);
 pval_data = pack_usigned(pval_data, ToggleBlockRumble   , 6, 1);
 pval_data = pack_usigned(pval_data, ToggleJumpShot[0]    ,7, 1);
 pval_data = pack_usigned(pval_data, ToggleJumpShot[1]    ,8, 1);
 pval_data = pack_usigned(pval_data, ToggleJumpShot[2]   , 9, 1);
 pval_data = pack_usigned(pval_data, ToggleFastMelee[0]  ,10, 1);
 pval_data = pack_usigned(pval_data, ToggleFastMelee[1]  ,11, 1);
 pval_data = pack_usigned(pval_data, ToggleFastMelee[2]  ,12, 1);
 set_pvar(SPVAR_27,pval_data);
 
 pval_data = pack_usigned(pval_data, ToggleRapidFire[0]    ,0, 1);
 pval_data = pack_usigned(pval_data, ToggleRapidFire[1]    ,1, 1);
 pval_data = pack_usigned(pval_data, ToggleRapidFire[2]    ,2, 1);
 pval_data = pack_usigned(pval_data, ToggleBurstFire[0]    ,3, 1);
 pval_data = pack_usigned(pval_data, ToggleBurstFire[1]    ,4, 1);
 pval_data = pack_usigned(pval_data, ToggleBurstFire[2]    ,5, 1);
 pval_data = pack_usigned(pval_data, ToggleStrafeShot[0], 6, 1);
 pval_data = pack_usigned(pval_data, ToggleStrafeShot[1], 7, 1);
 pval_data = pack_usigned(pval_data, ToggleStrafeShot[2], 8, 1);
 pval_data = pack_usigned(pval_data, ToggleCancelReload , 9, 1);
 pval_data = pack_usigned(pval_data, ToggleTaylorSens   ,10, 1);
 pval_data = pack_usigned(pval_data, ToggleEnemyPing    ,11, 1);
 set_pvar(SPVAR_28,pval_data);
 
 pval_data = pack_usigned(pval_data, ToggleHoldBreath[0], 0, 1);
 pval_data = pack_usigned(pval_data, ToggleHoldBreath[1], 1, 1);
 pval_data = pack_usigned(pval_data, ToggleHoldBreath[2], 2, 1);
 pval_data = pack_usigned(pval_data, ToggleBunnyHop      ,3, 1);
 pval_data = pack_usigned(pval_data, ToggleProneShot[0]  ,4, 1);
 pval_data = pack_usigned(pval_data, ToggleProneShot[1]  ,5, 1);
 pval_data = pack_usigned(pval_data, ToggleProneShot[2]  ,6, 1);
 pval_data = pack_usigned(pval_data, ToggleAutoAim[0]    ,7, 1);
 pval_data = pack_usigned(pval_data, ToggleAutoAim[1]    ,8, 1);
 pval_data = pack_usigned(pval_data, ToggleAutoAim[2]    ,9, 1);
 pval_data = pack_usigned(pval_data, ToggleSniperMode[0],10, 1);
 pval_data = pack_usigned(pval_data, ToggleSniperMode[1],11, 1);
 pval_data = pack_usigned(pval_data, ToggleSniperMode[2],12, 1);
 set_pvar(SPVAR_29,pval_data);
 
 pval_data = pack_usigned(pval_data, ToggleAutoRF       ,0, 1);
 pval_data = pack_usigned(pval_data, ToggleAutoHB       ,1, 1);
 pval_data = pack_usigned(pval_data, RfFireType[0]      ,2, 1);
 pval_data = pack_usigned(pval_data, RfFireType[1]      ,3, 1);
 pval_data = pack_usigned(pval_data, RfFireType[2]      ,4, 1);
 pval_data = pack_usigned(pval_data, BfFireType[0]      ,5, 1);
 pval_data = pack_usigned(pval_data, BfFireType[1]      ,6, 1);
 pval_data = pack_usigned(pval_data, BfFireType[2]      ,7, 1);
 pval_data = pack_usigned(pval_data, ToggleSpeedStrafe[0],8, 1);
 pval_data = pack_usigned(pval_data, ToggleSpeedStrafe[1],9, 1);
 pval_data = pack_usigned(pval_data, ToggleSpeedStrafe[2],10,1);
 set_pvar(SPVAR_30,pval_data);

 set_pvar(SPVAR_31,GeneralSens       ); 
 set_pvar(SPVAR_32,AdsSens           ); 
 set_pvar(SPVAR_33,FireSens          ); 
 set_pvar(SPVAR_34,AdsFireSens       ); 
 set_pvar(SPVAR_35,MaxReloadTime     ); 
 set_pvar(SPVAR_36,SlideDelay        ); 
 set_pvar(SPVAR_37,StrafeShotTime    ); 
 set_pvar(SPVAR_38,BurstFireHold     ); 
 set_pvar(SPVAR_39,BurstFireRelease  ); 
 set_pvar(SPVAR_40,CrouchSpeed       );
 set_pvar(SPVAR_41,StrafeTime        ); 
 
 pval_data = pack_int8_to_int16(ToggleProgressive[0],ToggleProgressive[1]);     
 set_pvar(SPVAR_42,pval_data);
 pval_data = pack_int8_to_int16(ToggleProgressive[2],ToggleCrouchShot[0]);     
 set_pvar(SPVAR_43,pval_data);
 pval_data = pack_int8_to_int16(ToggleCrouchShot[1],ToggleCrouchShot[2]);     
 set_pvar(SPVAR_44,pval_data);
 
 pval_data = pack_int8_to_int16(ActivateIndividualBtnIdx,ToggleCancelSlide);    
 set_pvar(SPVAR_45,pval_data);
 
 pval_data = pack_int8_to_int16(ActivateHoldBtnIdx[0],ActivatePressBtnIdx [0]);     
 set_pvar(SPVAR_46,pval_data);
  
 pval_data = pack_int8_to_int16(ActivateHoldBtnIdx[1],ActivatePressBtnIdx [1]);     
 set_pvar(SPVAR_47,pval_data);
  
 pval_data = pack_int8_to_int16(ActivateHoldBtnIdx[2],ActivatePressBtnIdx [2]);     
 set_pvar(SPVAR_48,pval_data);
  
 pval_data = pack_int8_to_int16(ActivateHoldBtnIdx[3],ActivatePressBtnIdx [3]);     
 set_pvar(SPVAR_49,pval_data);
  
 pval_data = pack_int8_to_int16(ActivateHoldBtnIdx[4],ActivatePressBtnIdx [4]);     
 set_pvar(SPVAR_50,pval_data);
 
 pval_data = pack_int8_to_int16(ActivateHoldBtnIdx[5],ActivatePressBtnIdx[5]);     
 set_pvar(SPVAR_51,pval_data);
 
 pval_data = pack_int8_to_int16(HandGunAASpeed,HandGunAASize);     
 set_pvar(SPVAR_52,pval_data);
 
 set_pvar(SPVAR_53,HandGunVertical);
 
 pval_data = pack_int8_to_int16(Buttons,ToggleVmSpeed);     
 set_pvar(SPVAR_54,pval_data);
 
 pval_data = pack_int8_to_int16(ActivatePressBtnIdx1[6],ActivatePressBtnIdx[6]);     
 set_pvar(SPVAR_55,pval_data);
 
 set_pvar(SPVAR_56,ActiveTime);
 set_pvar(SPVAR_57,PingDelay);
 
 pval_data = pack_int8_to_int16(Ascii[0],Ascii[1]);     
 set_pvar(SPVAR_58,pval_data);
 
 pval_data = pack_int8_to_int16(Ascii[2],Ascii[3]);     
 set_pvar(SPVAR_59,pval_data);
 
 pval_data = pack_int8_to_int16(Ascii[4],Ascii[5]);     
 set_pvar(SPVAR_60,pval_data);
 
 pval_data = pack_int8_to_int16(Ascii[6],Ascii[7]);     
 set_pvar(SPVAR_61,pval_data);
 
 pval_data = pack_int8_to_int16(Ascii[8],Ascii[9]);     
 set_pvar(SPVAR_62,pval_data);
 
 set_pvar(SPVAR_63,Ascii[10]);
 }
int introScrollTimer, introScrollPauseTime;
int introScrollTextOffset;
int introScrollTextIndex;
int introScrollCharIndex = 1;

function MenuScroll() {
    introScrollTimer += get_rtime();
    if(introScrollTimer >= introScrollPauseTime) {
        introScrollPauseTime = 30;
        for (introScrollTextIndex = 1; introScrollTextIndex <= 18; introScrollTextIndex++) {
            if (introScrollTextIndex + introScrollTextOffset >= sizeof(MENU_SCROLL_TEXT)) {
                putc_oled(introScrollTextIndex, MENU_SCROLL_TEXT[introScrollTextIndex + (introScrollTextOffset - sizeof(MENU_SCROLL_TEXT))]);
            }
            else {
                putc_oled(introScrollTextIndex, MENU_SCROLL_TEXT[introScrollTextIndex + introScrollTextOffset]);
            }
        }
        puts_oled(1, 53,OLED_FONT_SMALL, introScrollTextIndex, OLED_WHITE);
        introScrollTextOffset++;
        if (introScrollTextOffset >= sizeof(MENU_SCROLL_TEXT)) {
            introScrollTextOffset = 0;
        }
        introScrollCharIndex--;
        if (introScrollCharIndex < 1) {
            introScrollCharIndex = 18;
            introScrollPauseTime = 2000;

        }
        introScrollTimer = 0;
    }
}
const uint8 MENU_SCROLL_TEXT[] = {
//    1			2		   3		4	     5		     6		   7		  8		     9         10	       11	   12		  13	  14		 15		  16		17        18
     _space, _left,	   _space,   _right,	_space,    _N,	      _e,         _x,       _t,        _space,    _M,      _o,       _d,     _slash,    _V,      _a,       _l,       _space,        
     _space,   _o,	     _r,     _space,    _up,	  _space,	  _down,	 _space,	_F,        _o,		  _r,	   _space,   _T,     _o, 	     _g,	  _g,		_l,	      _e,
     _space, _X,       _slash,       _A,       _space,     _F,	  _o,	      _r,		_space,	   _E,	      _d,	   _i,		  _t,		 _space,	 _M,	  _e,		_n,      _u,
     _space, _space,  _O,        _slash,   _B, _space,     _T,       _o,       _space,     _E,       _x,         _i,       _t,      _space,    _M,     _e,        _n,     _u,
     _space, _Y,_triangle, _space, _C,_h,_a,_n,_g,_e, _space, _P,_r,_o,_f,_i,_l,_e,
     _space,   _H,	  _o,	    _l,		_d,	      _space,	 _L,	    _2, 	    _slash,    _L,	  _T,    _space,		_left,       _space, _O, _r, _space,_right,
     _space,   _T,	   _o,    _space,   _A,	    _d, _j,	      _u,	 _s,	_t,     _space,		   _V,	  _a,		 _l, 	     _u,	  _e,		_s,	     _space,
     _space, _O,	   _r,     _space,    _B,   _u,		_t,	      _t,		 _o,		_n,	        _space,		   _C,		  _h,		 _o,	 _i,	  _c,		_e,      _s
};    


define  _0 = 48,   _A = 65,   _K = 75,   _U =  85,   _e = 101,   _o = 111,   _y       = 121,    _plus      = 43, _slash     = 47 , _dot     =  46;
define  _1 = 49,   _B = 66,   _L = 76,   _V =  86,   _f = 102,   _p = 112,   _z       = 122;
define  _2 = 50,   _C = 67,   _M = 77,   _W =  87,   _g = 103,   _q = 113,   _space   =  32;
define  _3 = 51,   _D = 68,   _N = 78,   _X =  88,   _h = 104,   _r = 114,   _bang    =  33;
define  _4 = 52,   _E = 69,   _O = 79,   _Y =  89,   _i = 105,   _s = 115,   _quote   =  34;
define  _5 = 53,   _F = 70,   _P = 80,   _Z =  90,   _j = 106,   _t = 116,   _hash    =  35;
define  _6 = 54,   _G = 71,   _Q = 81,   _a =  97,   _k = 107,   _u = 117,   _dollar  =  36;
define  _7 = 55,   _H = 72,   _R = 82,   _b =  98,   _l = 108,   _v = 118,   _percent =  37;
define  _8 = 56,   _I = 73,   _S = 83,   _c =  99,   _m = 109,   _w = 119,   _and     =  38;
define  _9 = 57,   _J = 74,   _T = 84,   _d = 100,   _n = 110,   _x = 120,   _tick    =  39;
define _left     = 133,   _right = 134,_up       = 131,_down     = 132,_cross    = 127, _circle   = 128, _triangle = 130;
const uint8 Layouts[][] = {            
 	  //Fire   ADS	  Lethal Tactical  Jump	 Crouch	  Melee	  Sprint  Reload WSwap,  Ping 	
	{ XB1_RT, XB1_LT, XB1_RB, XB1_LB, XB1_A,  XB1_B,  XB1_RS, XB1_LS ,XB1_X, XB1_Y, XB1_UP }, // DEFAULT = 0
	{ XB1_RT, XB1_LT, XB1_RB, XB1_LB, XB1_A,  XB1_RS, XB1_B,  XB1_LS ,XB1_X, XB1_Y, XB1_UP }, // TACTICAL = 1
	{ XB1_LT, XB1_RT, XB1_LB, XB1_RB, XB1_A,  XB1_B,  XB1_LS, XB1_RS ,XB1_X, XB1_Y, XB1_UP }, // LEFTY = 2
	{ XB1_RT, XB1_RB, XB1_LT, XB1_LB, XB1_A,  XB1_B,  XB1_RS, XB1_LS ,XB1_X, XB1_Y, XB1_UP }, // N0M4D/CHARLIE = 3
	{ XB1_RT, XB1_RB, XB1_LT, XB1_LB, XB1_A,  XB1_RS, XB1_B,  XB1_LS ,XB1_X, XB1_Y, XB1_UP }, // N0M4D/CHARLIE TACTICAL = 4
	{ XB1_LT, XB1_LB, XB1_RT, XB1_RB, XB1_A,  XB1_B,  XB1_LS, XB1_RS ,XB1_X, XB1_Y, XB1_UP }, // N0M4D/CHARLIE LEFTY = 5
	{ XB1_RT, XB1_LT, XB1_RB, XB1_A,  XB1_LB, XB1_B,  XB1_RS, XB1_LS ,XB1_X, XB1_Y, XB1_UP }, // BUMPER JUMPER = 6 
	{ XB1_RT, XB1_LT, XB1_RB, XB1_A,  XB1_LB, XB1_RS, XB1_B,  XB1_LS ,XB1_X, XB1_Y, XB1_UP }, // BUMPER JUMPER TACTICAL = 7
	{ XB1_LB, XB1_LT, XB1_RT, XB1_RB, XB1_A,  XB1_B,  XB1_RS, XB1_LS ,XB1_X, XB1_Y, XB1_UP }, // ONE-HAND GUNSLINGER = 8
	{ XB1_RT, XB1_LT, XB1_RB, XB1_LB, XB1_RS, XB1_B,  XB1_A,  XB1_LS ,XB1_X, XB1_Y, XB1_UP }, // STICK AND MOVE = 9
	{ XB1_RT, XB1_LT, XB1_RB, XB1_LB, XB1_A,  XB1_B,  XB1_RS, XB1_LS ,XB1_X, XB1_Y, XB1_UP }, // BRAWLER = 10
	{ XB1_RT, XB1_LT, XB1_RS, XB1_A,  XB1_LB, XB1_B,  XB1_RB, XB1_LS ,XB1_X, XB1_Y, XB1_UP }, // BEASTY = 11
	{ XB1_RT, XB1_LT, XB1_RB, XB1_RB, XB1_A,  XB1_B,  XB1_RS, XB1_LS ,XB1_X, XB1_Y, XB1_LB }, // BUMPER PING = 12
	{ XB1_RT, XB1_LT, XB1_RB, XB1_RB, XB1_A,  XB1_RS, XB1_B,  XB1_LS ,XB1_X, XB1_Y, XB1_LB }, // BUMPER PING TACTICAL = 13
	{ XB1_RB, XB1_LB, XB1_RT, XB1_LT, XB1_A,  XB1_B,  XB1_RS, XB1_LS ,XB1_X, XB1_Y, XB1_UP }, // DEFAULT SWAPPED = 14
	{ XB1_RB, XB1_LB, XB1_RT, XB1_LT, XB1_A,  XB1_RS, XB1_B,  XB1_LS ,XB1_X, XB1_Y, XB1_UP }, // TACTICAL SWAPPED = 15
	{ XB1_RB, XB1_LB, XB1_RT, XB1_A,  XB1_LT, XB1_B,  XB1_RS, XB1_LS ,XB1_X, XB1_Y, XB1_UP }, // BUMPER JUMPER SWAPPED = 16 
	{ XB1_RB, XB1_LB, XB1_RT, XB1_A,  XB1_LT, XB1_RS, XB1_B,  XB1_LS ,XB1_X, XB1_Y, XB1_UP }, // BUMPER JUMPER TACTICAL SWAPPED = 17 
	{ XB1_RB, XB1_LB, XB1_RT, XB1_LT, XB1_RS, XB1_B,  XB1_A,  XB1_LS ,XB1_X, XB1_Y, XB1_UP }, // STICK AND MOVE SWAPPED = 18
	{ XB1_RB, XB1_LB, XB1_RS, XB1_A,  XB1_LB, XB1_B,  XB1_RB, XB1_LS ,XB1_X, XB1_Y, XB1_UP }, // BEASTY SWAPPED 19
	{ XB1_RB, XB1_LB, XB1_RT, XB1_RT, XB1_A,  XB1_B,  XB1_RS, XB1_LS ,XB1_X, XB1_Y, XB1_LT }, // BUMPER PING = 18
	{ XB1_RB, XB1_LB, XB1_RT, XB1_RT, XB1_A,  XB1_RS, XB1_B,  XB1_LS ,XB1_X, XB1_Y, XB1_LT }}; // BUMPER PING TACTICAL = 19		

function Buttons(Type) {
	
	Fire     = Layouts[Type][0];
	Ads      = Layouts[Type][1];
	Lethal   = Layouts[Type][2];
	Tactical = Layouts[Type][3];
	Jump     = Layouts[Type][4];
	Crouch   = Layouts[Type][5];
	Melee    = Layouts[Type][6];
	Sprint   = Layouts[Type][7];
	Reload   = Layouts[Type][8];
	Swap     = Layouts[Type][9];
	Ping     = Layouts[Type][10];
	
} 

