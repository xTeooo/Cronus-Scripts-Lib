                                                                                                                                                                                                                                                                                             /*
              zen3.31                   
                             

                                                                                                                                                                                                                                                                                             */






define Green   = 0;
define White   = 1;
define Red     = 2;
define Off     = 3;
define Yellow  = 4;
define Pink    = 5;
define SkyBlue = 6;

int BATTERY;


data(

0,0,1,0, // Green
1,1,1,0, // White
0,1,0,0, // Red
0,0,0,0, // Off
0,1,1,0, // Yellow
0,0,0,1, // Pink
1,0,1,0  // SkyBlue


);
int UP_PRESS
int RIGHT_PRESS
int LEFT_PRESS
int PERSONAL_WEAPONS, REPEATER, SNIPER_RIFLE; 
int Better_AA_ON;
int Better_AA2_ON;
int AIM_ASSIST_ON;
int AUTO_HEADSHOT_RUNNING2;
int AUTO_HEADSHOT_RUNNING;
int MENU_SECTION_RUNNING;
int AIM_ASSIST_RUNNING;
int SELECTOR_RUNNING;
int MIDDLE_RUNNING;
int LONG_RUNNING;
int LONG_RUNNING2;
int MIDDLE_RUNNING2;

int SELECTOR_SECTION;
int R3_ACTIVATION;
int PLACE_ON_MENU;
int RX;
int RY;


int L1_PRESS;
int R1_PRESS;
int HEADSHOT_MODE2;
int HEADSHOT_MODE;
int SNIPER_MODE;

int WAIT;
int TONICS_RX;
int TONICS_RY;
int VIBRATE_RUMBLE;





main 

{



/////////////////////////////////////////////////////////////////////   CHANGE_SETTINGS_OF_MODES

     if(!MENU_SECTION_RUNNING&&!AIM_ASSIST_RUNNING&&!AUTO_HEADSHOT_RUNNING&&!AUTO_HEADSHOT_RUNNING2&&get_lval(PS4_L1))
    {
    	SELECTOR_RUNNING=TRUE;
    	if(event_press(PS4_R1)) SELECTOR_SECTION=!SELECTOR_SECTION;
    	RX=get_lval(PS4_RX);
    	RY=get_lval(PS4_RY);    
    }
    
    
    if(SELECTOR_RUNNING&&event_release(PS4_L1))
    {
    	SELECTOR_RUNNING=FALSE;
    	if(!SELECTOR_SECTION)
    	{
    		if((RX*RX+RY*RY)>=150)
    		{ 
    			RY=-1*RY;   
    			if(((100*RY)-(41*RX))>0)                                 
    			{   
    				if(((100*RY)+(41*RX))>0)                             { PERSONAL_WEAPONS=TRUE;  REPEATER=FALSE; SNIPER_RIFLE=FALSE; }
    				else                                                 { PERSONAL_WEAPONS=FALSE; REPEATER=TRUE;  SNIPER_RIFLE=FALSE; }
    			} 
    			else
    			{
    				if((((100*RY)-(241*RX))>0)||(((100*RY)+(241*RX))>0)) { PERSONAL_WEAPONS=FALSE; REPEATER=FALSE; SNIPER_RIFLE=FALSE; }
    				else                                                 { PERSONAL_WEAPONS=FALSE; REPEATER=FALSE; SNIPER_RIFLE=TRUE;  }
    			}    
    		}
    	}
    	SELECTOR_SECTION=FALSE;
    	RX=0;
    	RY=0;
    }
    
    if(get_lval(PS4_R1) && get_lval(PS4_SQUARE))
	{
		set_val(PS4_R1,100);
		set_val(PS4_SQUARE,100);
		if(get_lval(PS4_R1) && (PS4_SQUARE))
		{
			if(get_lval(PS4_R1) && (PS4_SQUARE))                         { TONICS_RX = -100; TONICS_RY = -100; }
		    combo_run(TONICS);
	    }
	
	}	
    
    if(get_lval(PS4_R1) && get_lval(PS4_TRIANGLE))
	{
		set_val(PS4_L1,100);
		set_val(PS4_TRIANGLE,100);
		if(get_lval(PS4_R1) && (PS4_TRIANGLE))
		{
			if(get_lval(PS4_R1) && (PS4_TRIANGLE))                         { TONICS_RX = 0;    TONICS_RY = -100; }
		    combo_run(TONICS);
	    }
	
	}	
	
	if(get_lval(PS4_R1) && get_lval(PS4_CIRCLE))
	{
		set_val(PS4_R1,100);
		set_val(PS4_CIRCLE,100);
		if(get_lval(PS4_R1) && (PS4_CIRCLE))
		{
			if(get_lval(PS4_R1) && (PS4_CIRCLE))                         { TONICS_RX = 100;  TONICS_RY = -100; }
		    combo_run(TONICS);
	    }
	
	}	
	if(get_lval(PS4_R1) && get_lval(PS4_CROSS))    
	{
	    set_val(PS4_R1,100);
	    set_val(PS4_CROSS,100);
	    if(get_lval(PS4_R1) && get_lval(PS4_CROSS))
	    combo_run(HAT);
	}


	
    
    if(get_battery()<=1) combo_run(LOW_BATTERY);
    if(!BATTERY)
    {   
    	if(MENU_SECTION_RUNNING)set_ds4_led(Yellow);
    	else
    	if(!SNIPER_RIFLE&&!PERSONAL_WEAPONS&&!REPEATER) set_ds4_led(White);
    	
    	if(SNIPER_RIFLE)
    	{
    		if(!SNIPER_MODE)set_ds4_led(White);
    		else
    		{
    			if(test_bit(SNIPER_MODE,0))set_ds4_led(Green);
    			else set_ds4_led(Red);
    		}
    	}
    	
    	if(REPEATER)
    	{
    		if(!HEADSHOT_MODE)set_ds4_led(White);
    		else
    		{
    			if(test_bit(HEADSHOT_MODE,0))set_ds4_led(SkyBlue);
    			else set_ds4_led(Pink);
    		}
    	}
    	
    	if(PERSONAL_WEAPONS)
    	{
    		if(!HEADSHOT_MODE2)set_ds4_led(White);
    		else
    		{
    			if(test_bit(HEADSHOT_MODE2,0))set_ds4_led(SkyBlue);
    			else set_ds4_led(Pink);
    		}
    	}
    	
    	
    	
    }
    
    
    
    deadzone(PS4_L2,PS4_R2,99,99);
     
/////////////////////////////////////////////////////////////////////   CHANGE_SETTINGS_OF_MODES



/////////////////////////////////////////////////////////////////////   MENU_SECTION
    
  if(MENU_SECTION_RUNNING)
    {
    	if(event_press(PS4_CROSS)) PLACE_ON_MENU = PLACE_ON_MENU + 1;  
    	if(event_press(PS4_CIRCLE))PLACE_ON_MENU = PLACE_ON_MENU - 1; 
    	if((PLACE_ON_MENU<0)||(get_lval(PS4_CIRCLE)&&get_ptime(PS4_CIRCLE)>800)){ SNIPER_RIFLE=TRUE; PLACE_ON_MENU=0; MENU_SECTION_RUNNING=FALSE;  } 
    }
    else
    if(get_lval(PS4_CROSS)&&get_ptime(PS4_CROSS)>2000)combo_run(RUN_HORSE); 
    
/////////////////////////////////////////////////////////////////////   MENU_SECTION



/////////////////////////////////////////////////////////////////////   SNIPER
    if(SNIPER_RIFLE&&!SELECTOR_RUNNING)
    {
    	if(get_lval(PS4_L2))
    	{
    		set_val(PS4_L1,0);
    		AIM_ASSIST_RUNNING=TRUE;
    		
    		if(event_release(PS4_RIGHT)) SNIPER_MODE = SNIPER_MODE + 1;
    		if(get_lval(PS4_RIGHT)&&get_ptime(PS4_RIGHT)>500) SNIPER_MODE = 0;
    		
    		if(!L1_PRESS&&get_lval(PS4_L1)){ L1_PRESS=TRUE; AIM_ASSIST_ON=!AIM_ASSIST_ON; vibrate(AIM_ASSIST_ON); } 
    		
    		if(AIM_ASSIST_ON)combo_run(AIM_ASSIST);
    		
    		if(SNIPER_MODE)
    		{
    			if(test_bit(SNIPER_MODE,0)&&get_lval(PS4_R2))  { set_val(PS4_R2,0); combo_run(RAPID_CARCANO); }
    			if(!test_bit(SNIPER_MODE,0)&&get_lval(PS4_R2)) { set_val(PS4_R2,0); combo_run(HORSE_RAPID_CARCANO); }
    		}
    	}
    	
    	if(event_release(PS4_L2))AIM_ASSIST_RUNNING=FALSE;
    	
    	if(SNIPER_MODE)
    	{
    		if(!SELECTOR_RUNNING)
    		{
    			set_val(PS4_R2,0);
    			if(!get_lval(PS4_L2)&&get_lval(PS4_R2)) combo_run(HIP_FIRE); 
    		}
    		
    		if((get_lval(PS4_LEFT)&&get_ptime(PS4_LEFT)>800)||(get_lval(PS4_RIGHT)&&get_ptime(PS4_RIGHT)>800)||event_press(PS4_OPTIONS))
    		{
    			MENU_SECTION_RUNNING=TRUE; 
    			SNIPER_RIFLE=FALSE;
    		}
    	}
    }
    
    
    if(L1_PRESS&&!get_lval(PS4_L1)) L1_PRESS=FALSE;
/////////////////////////////////////////////////////////////////////   SNIPER



/////////////////////////////////////////////////////////////////////   AUTO_HEADSHOT
    if((PERSONAL_WEAPONS)&&!SELECTOR_RUNNING)
    {
    	if(get_lval(PS4_L2))
    	{ set_val(PS4_UP,0);
    	  Better_AA_ON=TRUE;
    	

    		if(event_release(PS4_RIGHT)) HEADSHOT_MODE2 = HEADSHOT_MODE2 + 1;
    		if(get_lval(PS4_RIGHT)&&get_ptime(PS4_RIGHT)>500) HEADSHOT_MODE2 = 0;
    		
    		AUTO_HEADSHOT_RUNNING2=TRUE;
    		
    		set_val(PS4_L1,0);
    		if(!UP_PRESS&&get_lval(PS4_UP)){ UP_PRESS=TRUE; Better_AA_ON=!Better_AA_ON; vibrate(Better_AA_ON); } 
    		
    		if(Better_AA_ON)combo_run(Better_Aim_Assist);
    		
    		if(!HEADSHOT_MODE2)
    		{
    			if(event_press(PS4_R3))R3_ACTIVATION = !R3_ACTIVATION;
    			if(!LONG_RUNNING2&&get_lval(PS4_L1)){ WAIT=100; combo_run(LONG_DISTANCE2); if(!R3_ACTIVATION) combo_run(R3_PRESS); }
    			
    			if(LONG_RUNNING2)
    			{
    				if(!MIDDLE_RUNNING2&&get_lval(PS4_L1))combo_run(PLUS_DISTANCE2);
    				else MIDDLE_RUNNING2=TRUE; 
    			}
    		}
    		
    		if(HEADSHOT_MODE2&&!LONG_RUNNING2&&!MIDDLE_RUNNING2)
    		{
    			if(!LONG_RUNNING2&&test_bit(HEADSHOT_MODE2,0))   {  WAIT=250; combo_run(LONG_DISTANCE2);   }  
    			if(!MIDDLE_RUNNING2&&!test_bit(HEADSHOT_MODE2,0)){  WAIT=250; combo_run(MIDDLE_DISTANCE2); }
    			combo_run(R3_PRESS); 
    		}
    		
    		
    	}
    	
    	if(event_release(PS4_L2)){ combo_stop(R3_PRESS); combo_stop(LONG_DISTANCE2); combo_stop(PLUS_DISTANCE2); combo_stop(MIDDLE_DISTANCE2); MIDDLE_RUNNING2=FALSE; LONG_RUNNING2=FALSE; R3_ACTIVATION=FALSE; AUTO_HEADSHOT_RUNNING2=FALSE; }
    	
    	if(get_lval(PS4_R2)&&get_ptime(PS4_R2)>130)
    	{
    		if(!get_lval(PS4_L2))combo_run(R2_PRESS);
    		else 
    		if(PERSONAL_WEAPONS)combo_run(R2_PRESS);
    	}
    }
    
    
    if((REPEATER)&&!SELECTOR_RUNNING)
    {
    	if(get_lval(PS4_L2))
    	{  set_val(PS4_LEFT,0);
    	  Better_AA2_ON=TRUE;
    	  
    	 if(!LEFT_PRESS&&get_lval(PS4_LEFT)){ LEFT_PRESS=TRUE; Better_AA2_ON=!Better_AA_ON; vibrate(Better_AA_ON); } 
    		
    		if(Better_AA_ON)combo_run(Better_Aim_Assist); 
    	  
    	  
    		if(event_release(PS4_RIGHT)) HEADSHOT_MODE = HEADSHOT_MODE + 1;
    		if(get_lval(PS4_RIGHT)&&get_ptime(PS4_RIGHT)>500) HEADSHOT_MODE = 0;
    		
    		AUTO_HEADSHOT_RUNNING=TRUE;
    		
    		set_val(PS4_L1,0);
    		
    		if(!HEADSHOT_MODE)
    		{
    			if(event_press(PS4_R3))R3_ACTIVATION = !R3_ACTIVATION;
    			if(!LONG_RUNNING&&get_lval(PS4_L1)){ WAIT=100; combo_run(LONG_DISTANCE); if(!R3_ACTIVATION) combo_run(R3_PRESS); }
    			
    			if(LONG_RUNNING)
    			{
    				if(!MIDDLE_RUNNING&&get_lval(PS4_L1))combo_run(PLUS_DISTANCE);
    				else MIDDLE_RUNNING=TRUE; 
    			}
    		}
    		
    		if(HEADSHOT_MODE&&!LONG_RUNNING&&!MIDDLE_RUNNING)
    		{
    			if(!LONG_RUNNING&&test_bit(HEADSHOT_MODE,0))   {  WAIT=250; combo_run(LONG_DISTANCE);   }  
    			if(!MIDDLE_RUNNING&&!test_bit(HEADSHOT_MODE,0)){  WAIT=250; combo_run(MIDDLE_DISTANCE); }
    			combo_run(R3_PRESS); 
    		}
    		
    		
    	}
    	
    	if(event_release(PS4_L2)){ combo_stop(R3_PRESS); combo_stop(LONG_DISTANCE); combo_stop(PLUS_DISTANCE); combo_stop(MIDDLE_DISTANCE); MIDDLE_RUNNING=FALSE; LONG_RUNNING=FALSE; R3_ACTIVATION=FALSE; AUTO_HEADSHOT_RUNNING=FALSE; }
    	
    	if(get_lval(PS4_R2)&&get_ptime(PS4_R2)>130)combo_run(R2_PRESS);
    	
    	
    		 
    	
    }
    }
    
    
    
/////////////////////////////////////////////////////////////////////   AUTO_HEADSHOT
combo Better_Aim_Assist {
    set_val(PS4_RX, XY(PS4_RX, 20)); 
	wait(40); 
	wait(40);
	set_val(PS4_RX, XY(PS4_RX, -20)); 
	wait(40);
	wait(40);
	set_val(PS4_RY, XY(PS4_RY, 20)); 
	wait(40); 
	wait(40);
	set_val(PS4_RY, XY(PS4_RY, -20)); 
	wait(40); 
	wait(40); 
    }

combo Better_Aim_Assist2 {
    set_val(PS4_RX, XY(PS4_RX, 20)); 
	wait(40); 
	wait(40);
	set_val(PS4_RX, XY(PS4_RX, -20)); 
	wait(40);
	wait(40);
	set_val(PS4_RY, XY(PS4_RY, 20)); 
	wait(40); 
	wait(40);
	set_val(PS4_RY, XY(PS4_RY, -20)); 
	wait(40); 
	wait(40);
    }




combo HAT
{
	set_val(PS4_L1,100);
	set_val(PS4_R1,100);
	wait(60); 
	set_val(PS4_RX, -100);
	set_val(PS4_RY, 100);
	wait(80); 
	wait(100);
}

combo LOW_BATTERY{
BATTERY=TRUE;
set_ds4_led(Off);
wait(500);
BATTERY=FALSE;
wait(1500);
}

combo RUN_HORSE
{
	set_val(PS4_CROSS,0);
	wait(50);
	wait(100);
}

combo R2_PRESS
{
	set_val(PS4_R2,0);
	wait(50);
	wait(50);
}

combo HORSE_RAPID_CARCANO
{
	set_val(PS4_R2,100);
	set_val(PS4_TOUCH,100);
	wait(50);
	wait(50);
}

combo R3_PRESS
{
	wait(WAIT); 
	set_val(PS4_R3,100);
	wait(100);
	wait(110);
}

combo HIP_FIRE
{
	set_val(PS4_L2,100);
	wait(20);
	set_val(PS4_L2,100);
	set_val(PS4_R2,100);
	wait(40);
	wait(400);
	set_val(PS4_L2,100);
	wait(60);
	wait(100);
}

combo TONICS
{
	set_val(PS4_L1,100);
	set_val(PS4_R1,100);
	wait(60); 
	set_val(PS4_RX, TONICS_RX);
	set_val(PS4_RY, TONICS_RY);
	set_val(PS4_SQUARE,100);
	wait(80); 
	wait(100);
}

combo RAPID_CARCANO
{                        
	set_val(PS4_R2,100);
	set_val(PS4_CROSS,100);
	wait(40);
	wait(180);
	set_val(PS4_R2,100);
	set_val(PS4_CROSS,100);
	wait(40);
	wait(50);
}
combo LONG_DISTANCE
{
	wait(WAIT);
	set_val(PS4_RY, -100);
	wait(140);
	LONG_RUNNING=TRUE;
}

combo PLUS_DISTANCE
{
	set_val(PS4_RY, -100);
	wait(40); 
	MIDDLE_RUNNING=TRUE;
}

combo MIDDLE_DISTANCE
{
	call(LONG_DISTANCE);
	call(PLUS_DISTANCE);
}
combo LONG_DISTANCE2
{
	wait(WAIT);
	set_val(PS4_RY, -100);
	wait(140);
	LONG_RUNNING2=TRUE;
}

combo PLUS_DISTANCE2
{
	set_val(PS4_RY, -100);
	wait(40); 
	MIDDLE_RUNNING2=TRUE;
}

combo MIDDLE_DISTANCE2
{
	call(LONG_DISTANCE2);
	call(PLUS_DISTANCE2);
}
combo AIM_ASSIST
{
	set_val(PS4_RX, XY(PS4_RX, 50)); 
	wait(40); 
	wait(40);
	set_val(PS4_RX, XY(PS4_RX, -50)); 
	wait(40);
	wait(40);
	set_val(PS4_RY, XY(PS4_RY, 50)); 
	wait(40); 
	wait(40);
	set_val(PS4_RY, XY(PS4_RY, -50)); 
	wait(40); 
	wait(40);
}
 
combo vibrate
{
	set_rumble(VIBRATE_RUMBLE,100);
	wait(200);
	reset_rumble();
}

function XY(BUTTON, VALUE)
{
	if(abs(get_lval(BUTTON))<25)
	return VALUE;
	return get_lval(BUTTON);
}

function set_ds4_led(colour) 
{
	set_led(LED_1, duint8(colour * 4));
	set_led(LED_2, duint8((colour * 4) + 1));
	set_led(LED_3, duint8((colour * 4) + 2));
	set_led(LED_4, duint8((colour * 4) + 3)); 
}


function vibrate(BOOL)
{
	if(BOOL) VIBRATE_RUMBLE = RUMBLE_A; 
	if(!BOOL)VIBRATE_RUMBLE = RUMBLE_B;
	combo_run(vibrate);
}