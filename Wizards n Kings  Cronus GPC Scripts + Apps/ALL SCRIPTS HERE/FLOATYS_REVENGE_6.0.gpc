/*

.%%%%%%..%%.......%%%%....%%%%...%%%%%%..%%..%%...%%%%...........%%%%%...%%%%%%..%%..%%..%%%%%%..%%..%%...%%%%...%%%%%%.
.%%......%%......%%..%%..%%..%%....%%.....%%%%...%%..............%%..%%..%%......%%..%%..%%......%%%.%%..%%......%%.....
.%%%%....%%......%%..%%..%%%%%%....%%......%%.....%%%%...........%%%%%...%%%%....%%..%%..%%%%....%%.%%%..%%.%%%..%%%%...
.%%......%%......%%..%%..%%..%%....%%......%%........%%..........%%..%%..%%.......%%%%...%%......%%..%%..%%..%%..%%.....
.%%......%%%%%%...%%%%...%%..%%....%%......%%.....%%%%...........%%..%%..%%%%%%....%%....%%%%%%..%%..%%...%%%%...%%%%%%.
........................................................................................................................
					:::       :::     :::     :::::::::  ::::::::: ::::::::  ::::    ::: :::::::::: 
					:+:       :+:   :+: :+:   :+:    :+:      :+: :+:    :+: :+:+:   :+: :+:        
					+:+       +:+  +:+   +:+  +:+    +:+     +:+  +:+    +:+ :+:+:+  +:+ +:+        
					+#+  +:+  +#+ +#++:++#++: +#++:++#:     +#+   +#+    +:+ +#+ +:+ +#+ +#++:++#   
					+#+ +#+#+ +#+ +#+     +#+ +#+    +#+   +#+    +#+    +#+ +#+  +#+#+# +#+        
					 #+#+# #+#+#  #+#     #+# #+#    #+#  #+#     #+#    #+# #+#   #+#+# #+#        
					  ###   ###   ###     ### ###    ### ######### ########  ###    #### ########## 


*/
// 
                                              
//===============================================================
//    ADJUSTABLE VARIABLES  MENU 1                                     
//===============================================================
// Index to find Value Name string - switchable in game with left/right in ModEdit
    int valName_idx;                  
int DeadZone;               // 0     
int drop_shot_hold;         // 1
int drop_shot_rest;         // 2
int AimAssistTime = 10;     // 3 
int AimAssistSize = 10;     // 4
int VerticalStrength  = 15; // 5
int HorizontalStrength=  0; // 6
int HeadShotStrength;       // 7
int HeadShotHoldTime;       // 8
int polar_aasist_radius  = 12    // 9
int polar_aasist_steps  = 10    // 10
int antirecoil_start   [2]; // 11
int antirecoil_end     [2]; // 12
int antirecoil_time    [2]; // 13  //-- 10ms increments (2500 = 2,5 seconds)
int antirecoil_H_start [2]; // 14
int antirecoil_H_end   [2]; // 15
int antirecoil_H_time  [2]; // 16  //-- 10ms increments 
int ar_invert          = 1; // 17  // set -1 for inverted Y antirecoil, else set 1
//---Adjustable Variables Count                          
define AMOUNT_OF_VALNAME_IDX = 17; 

//===============================================================
//    TOGGLE VARIABLES                                       
//===============================================================
int modName_idx;  
//   Toggles for MENU 1
  int USE_HAIR_TRIGGER ;     // 0 
  int rumble_onoff ;         // 1
  int stick_noise_onoff;     // 2 
  int dropshot_onoff ;       // 3
  int holdbreath_onoff ;     // 4
  int BUTTON_LAYOUT;         // 5
  int STICK_LAYOUT;          // 6
  int ToggleBattsStickyAim ; // 7 Batts Sticky Aim
  int AR_Groundloot;         // 8
  int AutoSlideCancelEasy= 0;// 9 
  int AutoSlideCancel = 0 ;  // 10
  int HeadShotAssist_onoff;  // 11
  int Zen_Assist;// 12
  int progressive_ar_onoff = 1  // 13
  int inverted_ar_onoff;     // 14
  // modName # of the last Mod Name string - Used for cycle modName_idx        
   define MAX_MODS_COUNT = 14;
   
// SUB MENU 2 
  int menu2_indx; 
int ToggleTaylorAA  =  2;// 0 Toggle = 1 For Aim Assist v1 , Toggle 2 for Aim Assist V2 
int ToggleAAType    =  1;// 1 Toggle  0 = OFF, 1 = Polar - 2 = Linear - 3 = Mixed - This is for the shapes ( Aim Assist Type For Shapes ) 
int TaylorShapesv1  =  2;// 2 WideOval= 2; Shape Selection 0 to 12 - names of the shapes are in the script next to the table   
int BoostFirev1     = TRUE;// 3 Toggle On/Off ( Boost On Fire ) 
int BoostReducer    = FALSE;// 4 Toggle On/Off ( Boost Reducer - Makes the Shape smaller instead ) 
// Version v4 & v5 & v5 + SpeedBoost 
int TaylorAssist    =  4;// 5  Toggle options 0 to 4 ,  1 - V4 , 2 - V5 , 3 - V5 Plus SpeedBoost , 4 V6 AA \\ 
int ToggleAATypev2  =  1;// 6  Toggle options 0 to 3 ,  0 = OFF, 1 = Polar - 2 = Linear - 3 = Mixed \\ // 
int TaylorShapesv2  =  2;// 7 Shape Selection 0 to 12 ( shape names are in the script next to the table ) 
int ShapeDirection  =  1;// 8 Toggle - On/Off  ( Shape Direction ) 
int ToggleBoostFire = FALSE;// 9 Toggle - On/Off ( Boost On Fire ) 
int BoostReducerv2  = FALSE;// 10 Toggle - On/Off ( Boost Reducer On Fire - Reduces the shape Size ) 
int TaylorTracking  =  1; // 11 Toggle On/Off 
//  MODs MENU 2 Count
int MAX_MODS_COUNT_2 = 11;
//=============================
// Variable for EDIT MENU
int MOD_Call;

const uint8 OptRange_2 [][] = {
  { 0 , 1 }, //0 ToggleTaylorAA  # 0
  { 0 , 0 }, //1 ToggleAAType    # 1
  { 0 , 0 }, //2 TaylorShapesv1  # 2
  { 2 , 5 }, //3 BoostFirev1     # 3
  { 0 , 0 }, //4 BoostReducer    # 4
  { 6 , 8 }, //5 TaylorAssist    # 5
  { 0 , 0 }, //6 ToggleAATypev2  # 6
  { 0 , 0 }, //7 TaylorShapesv2  # 7
  { 0 , 0 }, //8 ShapeDirection  # 8
  { 0 , 0 }, //9 ToggleBoostFire # 9 
  { 0 , 0 }, //10 BoostReducerv2  # 10
  { 9 ,10 }  //11 TaylorTracking  # 11
};
//--- MENU 2 ARRAYS
const uint8 Options_2 [] = {
  7 , // ToggleTaylorAA  // 0 Toggle = 1 For Aim Assist v1 , Toggle 2 for Aim Assist V2 
  8 , // ToggleAAType    // 1 Toggle  0 = OFF, 1 = Polar - 2 = Linear - 3 = Mixed - This is for the shapes ( Aim Assist Type For Shapes ) 
  9 , // TaylorShapesv1  // 2 Shape Selection 0 to 12 - names of the shapes are in the script next to the table 
  1 , // BoostFirev1     // 3 Toggle On/Off ( Boost On Fire ) 
  1 , // BoostReducer    // 4 Toggle On/Off ( Boost Reducer - Makes the Shape smaller instead )
 10 , // TaylorAssist    // 5 Toggle options 0 to 4 ,  1 - V4 , 2 - V5 , 3 - V5 Plus SpeedBoost , 4 V6 AA \\ 
  8 , // ToggleAATypev2  // 6 Toggle options 0 to 3 ,  0 = OFF, 1 = Polar - 2 = Linear - 3 = Mixed \\ // 
  9 , // TaylorShapesv2  // 7 Shape Selection 0 to 12 ( shape names are in the script next to the table ) 
  1 , // ShapeDirection  // 8 Toggle - On/Off  ( Shape Direction )
  1 , // ToggleBoostFire // 9 Toggle - On/Off ( Boost On Fire )
  1 , // BoostReducerv2  // 10 Toggle - On/Off ( Boost Reducer On Fire - Reduces the shape Size )
  1   // TaylorTracking  // 11 Toggle On/Off 
};
const uint8 EditVal_2 [] = {
  1 , //0 ToggleTaylorAA
  0 , //1 ToggleAAType
  0 , //2 TaylorShapesv1
  1 , //3 BoostFirev1
  0 , //4 BoostReducer
  1 , //5 TaylorAssist
  0 , //6 ToggleAATypev2
  0 , //7 TaylorShapesv2
  0 , //8 ShapeDirection
  0 , //9 ToggleBoostFire
  0 , //10 BoostReducerv2
  1   //11 TaylorTracking
};
const uint8 Min_Max_Options_2 [][]= {
{ 0 , 2 },//0 Toggle = 1 For Aim Assist v1 , Toggle 2 for Aim Assist V2 
{ 0 , 3 },//1 Toggle  0 = OFF, 1 = Polar - 2 = Linear - 3 = Mixed - This is for the shapes ( Aim Assist Type For Shapes )
{ 0 ,12 },//2 Shape Selection 0 to 12 ( shape names are in the script next to the table ) 
{ 0 , 1 },//3 Toggle On/Off ( Boost On Fire ) 
{ 0 , 1 },//4 Toggle On/Off ( Boost Reducer - Makes the Shape smaller instead ) 
{ 0 , 4 },//5 Toggle options 0 to 4 ,  1 - V4 , 2 - V5 , 3 - V5 Plus SpeedBoost , 4 V6 AA \\ 
{ 0 , 3 },//6 Toggle options 0 to 3 ,  0 = OFF, 1 = Polar - 2 = Linear - 3 = Mixed \\ // 
{ 0 ,12 },//7 Shape Selection 0 to 12 ( shape names are in the script next to the table ) 
{ 0 , 1 },//8 Toggle - On/Off  ( Shape Direction ) 
{ 0 , 1 },//9 Toggle - On/Off ( Boost On Fire ) 
{ 0 , 1 },//10 Toggle - On/Off ( Boost Reducer On Fire - Reduces the shape Size ) 
{ 0 , 1 } //11 Toggle On/Off 
};
const uint8 IncrDecr_2 [][] ={
{  1 ,  10},// 1 SpeedAA12
{  1 ,  10 },// 1 RadiusAA12 
{  1 ,  10 },// 2 BoostSpeedv1
{  1 ,  10 },// 3 BoostStrengthv1
{  1 ,  10 },// 4 TaylorPBoostStr
{  1 ,  10 },// 5 TaylorABoostSpd
{  1 ,  10 },// 6 AdsSpeed
{  1 ,  10 },// 7 TaylorAngle
{  1 ,  10 },// 10 TaylorRadius
{  1 ,  10 },// 9 TrackingSize
{  1 ,  10 } //1 TrackingSpeed
};

// Adustable Val for MENU 2
int adj_indx;// indx to find Adjustable variables
//--------------------------------
int SpeedAA12       = 15;//0 This is adjustable value - 0 to 99 max
int RadiusAA12      = 20;//1 This is adjustable value - 0 to 99 max

int BoostSpeedv1    =  5;//2 This is a adjustable value for Boost speed if Boost On Fire Is enabled ( 0 - 40 max ) 
int BoostStrengthv1 = 10;//3 This is a adjustable vaue for boost strength if Boost On Fire Is enabled ( 0 - 40 max )
int TaylorPBoostStr =  4;//4 Adjustable Value - 0 - 40 max ( Boost On Fire Strength ) 
int TaylorABoostSpd =  2;//5 Adjustable Value - 0 - 40 max ( Boost On Fire Speed )

int AdsSpeed        = 12;//6 Adjustable Value - 0 - 99 max ( Ads Speed ) 
int TaylorAngle     = 12;//7 Adjustable Value - 0 - 99 max ( Speed )  
int TaylorRadius    = 12;//8 Adjustable Value - 0 - 99 max ( Radius )

int TrackingSize    =  2;//9 Tracking Size  ( 0 - 8 max ) 
int TrackingSpeed   =  2;//10 Tracking Speed ( 0 - 8 max ) 
// --- SUB MENU ADJUSTABLE VAR      
int AMOUNT_OF_ADJUSTABLE_2 = 10;

const string NO_EDIT_VAR1  = "No Edit Variables";//  17 
const string NO_EDIT_VAR2  = "for this MOD";// 12 
////////////////////////////////////////////////////////
// WEAPONS with Anti Recoil Profiles
define Mac10_Weapon    = 1;
define Kilo_Weapon     = 2;
define Bullfrog_Weapon = 3;
define OTS_Weapon      = 4;
define Amax_Weapon     = 5;
const string AR_PRIM_SECOND  = "AR Prim/Sec";
const string AR_GROUNDLOOT   = "AR Groundlo";
int AR_Prim_Sec_onoff ;// automatic
int AR_GroundLot_onoff = TRUE;

int KS_Hold_Breath = TRUE;

////////////////////////////////////////////////////////
const uint8 Options [] = {
  1 ,  // HAIRTRIGGERS     # 0
  1 ,  // RUMBLESONOFF     # 1
  1 ,  // Stick Noise      # 2
  31,  // DROPSHOT         # 3
  1 ,  // HOLD BREATH      # 4
  81,  // BUTTON LAYOUT    # 5
  82,  // STICK LAYOUT     # 6
  1 ,  // Batts Sticky Aim # 7
  1 ,  // AR Groundloot    # 8
  1 ,  //                  # 9
  1 ,  //                  # 10
  1 ,  // Head Shot Assist # 11
  1 ,  // POLARAIMASSIST_TD# 12
  1 ,
  1 
};
const uint8 EditVal [] = {
  0 , // HAIRTRIGGERS # 1
  0 , // RUMBLESONOFF # 2
  1 , // Stick Nose   # 3
  1 , // DROPSHOT # 4
  0 , // HOLD BREATH
  0 , // BUTTON LAYOUT
  0 , // STICK LAYOUT
  1 , // Batts Sticky Aim
  1 , // AR Groundloot
  0 , //
  0 , //
  1 , // Head Shot Assist
  1 , // POLARAIMASSIST_TD # 12
  1 ,
  0
};
const uint8 OptRange [][] = {
  { 0 , 0 }, // HAIRTRIGGERS    # 0
  { 0 , 0 }, // RUMBLESONOFF    # 1
  { 0 , 0 }, // Stick Noise     # 2
  { 1 , 2 }, // DROPSHOT        # 3
  { 0 , 0 }, // HOLD BREATH     # 4
  { 0 , 0 }, // BUTTON LAYOUT   # 5
  { 0 , 0 }, // STICK LAYOUT    # 6
  { 3 , 4 }, // Batts Sticky Aim # 7
  { 5 , 6 }, // AR Ground loot   # 8
  { 0 , 0 }, // AUTOSLIDEEASY    # 9 
  { 0 , 0 }, // AUTOSLIDE        # 10
  { 7 , 8 }, // Head Shot Assist # 11
  { 9 ,10 }, // POLARAIMASSIST_TD # 12
  {11 ,22 }, // Progresive AR 
  { 0 , 0 }  //
};
const uint8 Min_Max_Options [][]={ 
  { 0 , 1 }, // HAIRTRIGGERS # 1
  { 0 , 1 }, // RUMBLESONOFF # 2
  { 0 , 1 }, // Stick Noise # 3
  { 0 , 3 }, // DROPSHOT # 4
  { 0 , 1 }, // HOLD BREATH
  { 0 ,16 }, // BUTTON LAYOUT
  { 0 , 5 }, // STICK LAYOUT
  { 0 , 1 }, // Batts Sticky Aim
  { 0 , 1 }, // AR Ground loot
  { 0 , 1 }, // AUTOSLIDEEASY # 1
  { 0 , 1 }, // AUTOSLIDE # 2
  { 0 , 1 }, // Head Shot Assist
  { 0 , 1 }, // POLARAIMASSIST_TD # 1
  { 0 , 1 }, //
  { 0 , 1 }  //
}; 
//===================================
const uint8 IncrDecr [][] = {
{ 1, 10 },   // DeadZone
{10,100 },   // DropShot Hold
{10,100 },   // DropShot Rest
{ 1, 10 },   // AimAssistTime
{ 1, 10 },   // AimAssistSize
{ 1, 10 },   // VerticalStrength
{ 1, 10 },   // HorizontalStrength
{ 1, 10 },   // HeadShotStrength
{10,100 },   // HeadShotHoldTime
{ 1, 10 },   // polar_aasist_radius
{ 1, 10 },   // polar_aasist_steps
{ 1, 10 },   // antirecoil_start
{ 1, 10 },   // antirecoil_end
{10,100 },   // antirecoil_time
{ 1, 10 },   // antirecoil_H_start
{ 1, 10 },   // antirecoil_H_end
{10,100 },   // antirecoil_H_time
{ 1, 10 },   // antirecoil_start
{ 1, 10 },   // antirecoil_end
{10,100 },   // antirecoil_time
{ 1, 10 },   // antirecoil_H_start
{ 1, 10 },   // antirecoil_H_end
{10,100 }    // antirecoil_H_time
};
  
define Edit_1 = 1;
define Edit_2 = 2;
define MOD_Menu_1 = 1;
define MOD_Menu_2 = 2;

const uint8 MenuSub [] = {
Edit_1,  // HAIRTRIGGERS
Edit_1,  // RUMBLESONOFF
Edit_1,  // Stick Noise
Edit_1,  // Drop Shot
Edit_1,  // Hold Breath
Edit_1,  // Button Layout
Edit_1,  // Stick Layout
Edit_1,  // Batts Sticky Aim
Edit_1,  // AR Ground Loot
Edit_1,  // Auto Slide Easy
Edit_1,  // Auto Slide
Edit_1,  // Head Shot Assist
Edit_2,  // Polar Aim Assist
Edit_1   // 
}
define PrimaryWeapon = 0;
define SecondWeapon  = 1;

//const string TITLE = "My Game"; // 18 char max 
const string TITLE = "My Script 1"; // 11 char max 
const string OFF   = "OFF";    
const string ON    = "ON";   
/////////////////////////////////////////////////////////////////////////////  
///   INITIALIZATION BLOCK                                                      
/////////////////////////////////////////////////////////////////////////////   
init {  
USE_HAIR_TRIGGER       = get_pvar(SPVAR_1,0,1,0); 
rumble_onoff           = get_pvar(SPVAR_2,0,1,0); 
stick_noise_onoff      = get_pvar(SPVAR_3,0,1,0); 
dropshot_onoff         = get_pvar(SPVAR_4,1,3,0); 
holdbreath_onoff       = get_pvar(SPVAR_5,0,1,0);
BUTTON_LAYOUT          = get_pvar(SPVAR_6,0,16,0);
STICK_LAYOUT           = get_pvar(SPVAR_7,0, 5,0);
DeadZone               = get_pvar(SPVAR_8, 1,100, 10);
drop_shot_hold         = get_pvar(SPVAR_9, 100,6000, 600);
drop_shot_rest         = get_pvar(SPVAR_10, 100,6000, 5000);
ToggleBattsStickyAim   = get_pvar(SPVAR_11,1,1,1);
AimAssistTime          = get_pvar(SPVAR_12,1,100,10);
AimAssistSize          = get_pvar(SPVAR_13,1,100,10);
AR_Groundloot          = get_pvar(SPVAR_14,1,1,1);
VerticalStrength       = get_pvar(SPVAR_15,1,100,20);
HorizontalStrength     = get_pvar(SPVAR_16,-99,99,0);
AutoSlideCancelEasy    = get_pvar(SPVAR_17,0,1,0);
AutoSlideCancel        = get_pvar(SPVAR_18,0,1,0);
HeadShotAssist_onoff   = get_pvar(SPVAR_19,1,1,1);
HeadShotHoldTime       = get_pvar(SPVAR_20,1,2000,800); 
HeadShotStrength       = get_pvar(SPVAR_21,1, 99,10);
Zen_Assist = get_pvar(SPVAR_22,1,5,1); 

polar_aasist_radius    = get_pvar(SPVAR_23, 1,30, 12);
polar_aasist_steps     = get_pvar(SPVAR_24,1,30, 12);

antirecoil_start[PrimaryWeapon] = get_pvar(SPVAR_25,1,99, 0); 
antirecoil_end  [PrimaryWeapon] = get_pvar(SPVAR_26,1,99, 0); 
antirecoil_time [PrimaryWeapon] = get_pvar(SPVAR_27,1,8000, 0); 

antirecoil_H_start [SecondWeapon] = get_pvar(SPVAR_28,-99,99, 0); 
antirecoil_H_end   [SecondWeapon] = get_pvar(SPVAR_29,-99,99, 0); 
antirecoil_H_time  [SecondWeapon] = get_pvar(SPVAR_30,1,8000, 0);

ar_invert              = get_pvar(SPVAR_31,0,1,0);

progressive_ar_onoff   = get_pvar(SPVAR_32,0,1,0);

// TD Aim Assist
ToggleTaylorAA  = get_pvar(SPVAR_33,1 , 2, 2 );
ToggleAAType    = get_pvar(SPVAR_34,1 , 3, 1 );
TaylorShapesv1  = get_pvar(SPVAR_35,1 ,12, 0 );
BoostFirev1     = get_pvar(SPVAR_36,1 , 1, 1 );
BoostReducer    = get_pvar(SPVAR_37,1 , 1, 0 );
TaylorAssist    = get_pvar(SPVAR_38,1 , 4, 4 );
ToggleAATypev2  = get_pvar(SPVAR_39,1 , 3, 2 );
TaylorShapesv2  = get_pvar(SPVAR_40,1 ,12, 1 );
ShapeDirection  = get_pvar(SPVAR_41,1 , 1, 1 );
ToggleBoostFire = get_pvar(SPVAR_42,1 , 1, 1 );
BoostReducerv2  = get_pvar(SPVAR_43,1 , 1, 0 );
TaylorTracking  = get_pvar(SPVAR_44,1, 1, 1 );
//TD  Adjustables
SpeedAA12       = get_pvar(SPVAR_45,12 ,99,15 );//   //0 This is adjustable value - 0 to 99 max
RadiusAA12      = get_pvar(SPVAR_46,11,99,20 );//20 //1 This is adjustable value - 0 to 99 max
BoostSpeedv1    = get_pvar(SPVAR_47,4 ,40, 10 );//5  //2 This is a adjustable value for Boost speed if Boost On Fire Is enabled ( 0 - 40 max ) 
BoostStrengthv1 = get_pvar(SPVAR_48,3 ,40,6 );//10 //3 This is a adjustable vaue for boost strength if Boost On Fire Is enabled ( 0 - 40 max )
TaylorPBoostStr = get_pvar(SPVAR_49,3 ,40, 4 );//4; //4 Adjustable Value - 0 - 40 max ( Boost On Fire Strength ) 
TaylorABoostSpd = get_pvar(SPVAR_50,5 ,40, 4 );//2; //5 Adjustable Value - 0 - 40 max ( Boost On Fire Speed )
AdsSpeed        = get_pvar(SPVAR_51,13 ,99,13 );//12;//6 Adjustable Value - 0 - 99 max ( Ads Speed ) 
TaylorAngle     = get_pvar(SPVAR_52,12 ,99,13 );//12;//7 Adjustable Value - 0 - 99 max ( Speed ) 
TaylorRadius    = get_pvar(SPVAR_53,10 ,99,11 );//12;//8 Adjustable Value - 0 - 99 max ( Radius )
TrackingSize    = get_pvar(SPVAR_54,2 , 8, 3 );//2;//9 Tracking Size  ( 0 - 8 max )
TrackingSpeed   = get_pvar(SPVAR_55,2 , 8, 3 );//2;//10 Tracking Speed ( 0 - 8 max )
if(ar_invert) invert = -1;
else invert = 1;

InitializeShapeChange(); 

 Run_Button_Configs();

slot_numb = get_slot();
}// end of init block
///////////////////////////////////////////////////////////////////////////// 
///   MAIN BLOCK                                                             
/////////////////////////////////////////////////////////////////////////////
main {//---------------------------------
    
   
    
    
   /////////////////////////////////////////
 if(get_ival(BTN_AIM)){
     if(event_press(PS4_SHARE)){
         EntireScript_OnOff    = !EntireScript_OnOff;
         blinck(EntireScript_OnOff);
         cls_oled(0);
         draw_rectangle();
         //display_mod(f_idx, f_string, mod_name, f_toggle, f_option)
         display_MOD_status(EntireScript_OnOff,sizeof(SCRIPT_ONOFF)- 1,SCRIPT_ONOFF[0]);
         
         show_mesage_time = 2000;
 //--- Set Virtual Machine Speed to Default if script is OFF    
 if(!EntireScript_OnOff) set_Virtual_Machine_Speed(VM_Default); 
     }
 }
                          
 if(show_mesage_time){
     show_mesage_time -= get_rtime();
     if(show_mesage_time <= 0) {
         cls_oled(0);    
     }
 }
                               
//============================================================
// KILL SWITCH FOR ENTIRE SCRIPT
//============================================================
 if(EntireScript_OnOff){
  //--- Set Virtual Machine Speed to Default for MENU                     
	if(ModEdit || ModMenu) set_Virtual_Machine_Speed(VM_Default);
    if(display_EDIT){                
    	  // Clear OLED screen         
        cls_oled(0);                        
       // display_edit(f_idx, f_string, f_print, f_val)
        if(MOD_Call == MOD_Menu_1){
			if(EditVal[ modName_idx ] == 0 ){  
				  //--- print label                
			    line_oled(1,45,127,45,1,0);    
			    print( center_x( 17, OLED_FONT_SMALL_WIDTH ), 20, OLED_FONT_SMALL, 1, NO_EDIT_VAR1[0] ); 
			    print( center_x( 12, OLED_FONT_SMALL_WIDTH ), 33, OLED_FONT_SMALL, 1, NO_EDIT_VAR2[0] ); 
			}                                                                                            
			else {//----  ELSE BEGIN --------------  
	             /////////////////////////////////////////////
	             if(valName_idx == 0){ 
	                  display_edit(DeadZone);
	                  DeadZone = edit_val(DeadZone,1,100 );
	             }         
	             /////////////////////////////////////////////
	             if(valName_idx == 1){ 
	                  display_edit(drop_shot_hold);
	                  drop_shot_hold = edit_val(drop_shot_hold, 100,6000);
	             }         
	             /////////////////////////////////////////////
	             if(valName_idx == 2){ 
	                  display_edit(drop_shot_rest);
	                  drop_shot_rest = edit_val(drop_shot_rest, 100,6000);
	             } 
	             /////////////////////////////////////////////
	             if(valName_idx == 3){ 
	                  display_edit(AimAssistTime);
	                  AimAssistTime = edit_val(AimAssistTime, 0,100);
	             } 
	             /////////////////////////////////////////////
	             if(valName_idx == 4){ 
	                  display_edit(AimAssistSize);
	                  AimAssistSize = edit_val(AimAssistSize, 0,100);
	             }
	             /////////////////////////////////////////////
	             if(valName_idx == 5){ 
	                  display_edit(VerticalStrength);
	                  VerticalStrength = edit_val(VerticalStrength, 0,100);
	             }
	             /////////////////////////////////////////////
	             if(valName_idx == 6){ 
	                  display_edit(HorizontalStrength);
	                  HorizontalStrength = edit_val(HorizontalStrength, -99,99);
	             }
	             /////////////////////////////////////////////
	             if(valName_idx == 7){ 
	                  display_edit(HeadShotStrength);
	                  HeadShotStrength = edit_val(HeadShotStrength, 1,99);
	             }
	             /////////////////////////////////////////////
	             if(valName_idx == 8){ 
	                  display_edit(HeadShotHoldTime);
	                  HeadShotHoldTime = edit_val(HeadShotHoldTime, 1,2000);
	             }
	             
	             /////////////////////////////////////////////
	             if(valName_idx == 9){ 
	                  display_edit(polar_aasist_radius);
	                  polar_aasist_radius = edit_val(polar_aasist_radius, 1,30);
	             }
	             /////////////////////////////////////////////
	             if(valName_idx == 10){ 
	                  display_edit(polar_aasist_steps);
	                  polar_aasist_steps = edit_val(polar_aasist_steps, 1,30);
	             }
	             
	             /////////////////////////////////////////////
	             if(valName_idx == 11){ 
	                  display_edit(antirecoil_start[PrimaryWeapon]);
	                  antirecoil_start[PrimaryWeapon] = edit_val(antirecoil_start[PrimaryWeapon], 0,99);
	             }
	             /////////////////////////////////////////////
	             if(valName_idx == 12){ 
	                  display_edit(antirecoil_end[PrimaryWeapon]);
	                  antirecoil_end[PrimaryWeapon] = edit_val(antirecoil_end[PrimaryWeapon], 0,99);
	             }
	             /////////////////////////////////////////////
	             if(valName_idx == 13){ 
	                  display_edit(antirecoil_time[PrimaryWeapon]);
	                  antirecoil_time[PrimaryWeapon] = edit_val(antirecoil_time[PrimaryWeapon], 0,8000);
	             }
	             
	             /////////////////////////////////////////////
	             if(valName_idx == 14){ 
	                  display_edit(antirecoil_H_start[PrimaryWeapon]);
	                  antirecoil_H_start[PrimaryWeapon] = edit_val(antirecoil_H_start[PrimaryWeapon], -99,99);
	             }
	             /////////////////////////////////////////////
	             if(valName_idx == 15){ 
	                  display_edit(antirecoil_H_end[PrimaryWeapon]);
	                  antirecoil_H_end[PrimaryWeapon] = edit_val(antirecoil_H_end[PrimaryWeapon], -99,99);
	             }
	             /////////////////////////////////////////////
	             if(valName_idx == 16){ 
	                  display_edit(antirecoil_H_time[PrimaryWeapon]);
	                  antirecoil_H_time[PrimaryWeapon] = edit_val(antirecoil_H_time[PrimaryWeapon], 0,8000);
	             }
	             
	             //----------------------------------
	             // SECONDARY WEAPON
	             /////////////////////////////////////////////
	             if(valName_idx == 17){ 
	                  display_edit(antirecoil_start[SecondWeapon]);
	                  antirecoil_start[SecondWeapon] = edit_val(antirecoil_start[SecondWeapon], 0,99);
	             }
	             /////////////////////////////////////////////
	             if(valName_idx == 18){ 
	                  display_edit(antirecoil_end[SecondWeapon]);
	                  antirecoil_end[SecondWeapon] = edit_val(antirecoil_end[SecondWeapon], 0,99);
	             }
	             /////////////////////////////////////////////
	             if(valName_idx == 19){ 
	                  display_edit(antirecoil_time[SecondWeapon]);
	                  antirecoil_time[SecondWeapon] = edit_val(antirecoil_time[SecondWeapon], 0,8000);
	             }
	             // HORIZONTAL
	             if(valName_idx == 20){ 
	                  display_edit(antirecoil_H_start[SecondWeapon]);
	                  antirecoil_H_start[SecondWeapon] = edit_val(antirecoil_H_start[SecondWeapon],-99,99);
	             }
	             /////////////////////////////////////////////
	             if(valName_idx == 21){ 
	                  display_edit(antirecoil_H_end[SecondWeapon]);
	                  antirecoil_H_end[SecondWeapon] = edit_val(antirecoil_H_end[SecondWeapon], -99,99);
	             }
	             /////////////////////////////////////////////
	             if(valName_idx == 22){ 
	                  display_edit(antirecoil_H_time[SecondWeapon]);
	                  antirecoil_H_time[SecondWeapon] = edit_val(antirecoil_H_time[SecondWeapon], 0,8000);
	             }
	             
	             
			 }
		//--- ELSE END   -----------
		}
		else if(MOD_Call == MOD_Menu_2){
			if(EditVal_2[ menu2_indx ] == 0 ){  
				  //--- print label                
			    line_oled(1,45,127,45,1,0);    
			    print( center_x( 17, OLED_FONT_SMALL_WIDTH ), 20, OLED_FONT_SMALL, 1, NO_EDIT_VAR1[0] ); 
			    print( center_x( 12, OLED_FONT_SMALL_WIDTH ), 33, OLED_FONT_SMALL, 1, NO_EDIT_VAR2[0] ); 
			} else {
				/////////////////////////////////////////////
				if(adj_indx == 0){ 
					display_edit(SpeedAA12);
					SpeedAA12 = edit_val(SpeedAA12,0,99 );
				} 
				/////////////////////////////////////////////
				if(adj_indx == 1){ 
					display_edit(RadiusAA12);
					RadiusAA12 = edit_val(RadiusAA12,0,99 );
				}
				/////////////////////////////////////////////
				if(adj_indx == 2){ 
					display_edit(BoostSpeedv1);
					BoostSpeedv1 = edit_val(BoostSpeedv1,0,40 );
				}    
				/////////////////////////////////////////////
				if(adj_indx == 3){ 
					display_edit(BoostStrengthv1);
					BoostStrengthv1 = edit_val(BoostStrengthv1,0,40 );
				} 
				/////////////////////////////////////////////
				if(adj_indx == 4){ 
					display_edit(TaylorPBoostStr);
					TaylorPBoostStr = edit_val(TaylorPBoostStr,0,40 );
				}
				/////////////////////////////////////////////
				if(adj_indx == 5){ 
					display_edit(TaylorABoostSpd);
					TaylorABoostSpd = edit_val(TaylorABoostSpd,0,40 );
				}
				/////////////////////////////////////////////
				if(adj_indx == 6){ 
					display_edit(AdsSpeed);
					AdsSpeed = edit_val(AdsSpeed,0,99 );
				}
				/////////////////////////////////////////////
				if(adj_indx == 7){ 
					display_edit(TaylorAngle);
					TaylorAngle = edit_val(TaylorAngle,0,99 );
				}
				/////////////////////////////////////////////
				if(adj_indx == 8){ 
					display_edit(TaylorRadius);
					TaylorRadius = edit_val(TaylorRadius,0,99 );
				}
				/////////////////////////////////////////////
				if(adj_indx == 9){ 
					display_edit(TrackingSize);
					TrackingSize = edit_val(TrackingSize,0, 8 );
				}
				/////////////////////////////////////////////
				if(adj_indx == 10){ 
					display_edit(TrackingSpeed);
					TrackingSpeed = edit_val(TrackingSpeed,0, 8 );
				}
			}			
		}// end of MOD Menu 2 call EDIT
		
   }//  end of display edit  
    if(refresh_OLED)
    { 
        // Clear OLED screen 
        cls_oled(0);       
                           
        // Draw Rectangle 
        draw_rectangle();
        if(ModMenu  == MOD_Menu_1){
	        // Display Mod Name and togle status  : ON/OFF   
	        if(modName_idx == 0)display_mod( USE_HAIR_TRIGGER      );
	        if(modName_idx == 1)display_mod( rumble_onoff          );
	        if(modName_idx == 2)display_mod( stick_noise_onoff     );
	        if(modName_idx == 3)display_mod( dropshot_onoff        );
	        if(modName_idx == 4)display_mod( holdbreath_onoff      );
	        if(modName_idx == 5)display_mod( BUTTON_LAYOUT         );
	        if(modName_idx == 6)display_mod( STICK_LAYOUT          );
	        if(modName_idx == 7)display_mod( ToggleBattsStickyAim  );
	        if(modName_idx == 8)display_mod( AR_Groundloot         );
	        if(modName_idx == 9)display_mod( AutoSlideCancelEasy   );
	        if(modName_idx ==10)display_mod( AutoSlideCancel       );
	        if(modName_idx ==11)display_mod( HeadShotAssist_onoff  );
	        if(modName_idx ==12)display_mod( Zen_Assist);
	        if(modName_idx ==13)display_mod( progressive_ar_onoff  );
	        if(modName_idx ==14)display_mod( inverted_ar_onoff     );
        }else{
        	if(menu2_indx  == 0)display_mod( ToggleTaylorAA  );//ToggleTaylorAA
        	if(menu2_indx  == 1)display_mod( ToggleAAType    );//ToggleAAType
        	if(menu2_indx  == 2)display_mod( TaylorShapesv1  );
        	if(menu2_indx  == 3)display_mod( BoostFirev1     );
        	if(menu2_indx  == 4)display_mod( BoostReducer    );
        	if(menu2_indx  == 5)display_mod( TaylorAssist    );
        	if(menu2_indx  == 6)display_mod( ToggleAATypev2  );// 6 ToggleAATypev2
        	if(menu2_indx  == 7)display_mod( TaylorShapesv2  );// 7
        	if(menu2_indx  == 8)display_mod( ShapeDirection  );// 8 ShapeDirection
        	if(menu2_indx  == 9)display_mod( ToggleBoostFire );
        	if(menu2_indx  ==10)display_mod( BoostReducerv2  );
        	if(menu2_indx  ==11)display_mod( TaylorTracking  );
     	
        }
         refresh_OLED = FALSE; 
    } 
    if(display_title){           
          // clear OLED screen    
    	    cls_oled(0);            
    	    // Display Script Title      
            DrawLogo(0, 0, 0);
           // screen saver          
	         ModMenu = FALSE;   
           display_title = FALSE;  
           display_black = TRUE;
    }                            
      
    //-----------------------------
    // Screen saver (OLED off)   
    if(display_black )         
    {                            
        count_black += get_rtime();
        if(count_black >= 15000)   
        {                        
            cls_oled(0);         
            count_black = 0;      
            display_black = FALSE; 
        }                         
    }                           
                                
   /////////////////////////////////////////////////////////
   // MENU EDIT VALUES             
   if(ModEdit){ 
        block_all_inputs(); 
        if(MenuTimeOut){
            CheckIfBtnIsPressed();
        } 
       //--- Exit from EDIT MENU  
       if(event_release(PS4_CIRCLE)){
			if( MOD_Call  == MOD_Menu_1){
				ModEdit      = FALSE;           
				display_EDIT = FALSE;           
				ModMenu      = TRUE;            
				refresh_OLED = TRUE;   // display MODS 
            }
            else if( MOD_Call  == MOD_Menu_2){
            	ModEdit      = FALSE;           
				display_EDIT = FALSE;           
				ModMenu      = MOD_Menu_2;
				MOD_Call     = MOD_Menu_2;
				refresh_OLED = TRUE;   // display MODS 
            }
       }                    
        ////////////////////////////////////////////////////////////////////////////////  
        //  GO FORWARD                                                                      
        if(!get_ival(BTN_AIM) && event_press(PS4_DOWN)){ 
        	if( MOD_Call  == MOD_Menu_1){
				valName_idx ++;                 
				if(valName_idx > OptRange[ modName_idx ][ 1 ])  valName_idx = OptRange[ modName_idx ][ 1 ]; 
				refresh_OLED = FALSE;      
				display_EDIT = TRUE;
            }
            else if( MOD_Call  == MOD_Menu_2){
            	adj_indx ++;                 
				if(adj_indx > OptRange_2[ menu2_indx ][ 1 ])  adj_indx = OptRange_2[ menu2_indx ][ 1 ]; 
				refresh_OLED = FALSE;      
				display_EDIT = TRUE;
            }
        }          
        ///////////////////////////////////////////////////////////////////////////////  
        //  GO BACK                                                                      
        if(!get_ival(BTN_AIM) && event_press(PS4_UP)){  
             if( MOD_Call  == MOD_Menu_1){
				valName_idx --;                 
				if(valName_idx < OptRange[ modName_idx ][ 0 ])  valName_idx = OptRange[ modName_idx ][ 0 ]; 
				refresh_OLED = FALSE;      
				display_EDIT = TRUE;
            }
            else if( MOD_Call  == MOD_Menu_2){
            	adj_indx --;                 
				if(adj_indx < OptRange_2[ menu2_indx ][ 0 ])  adj_indx = OptRange_2[ menu2_indx ][ 0 ]; 
				refresh_OLED = FALSE;      
				display_EDIT = TRUE;
            }                                                  
        	        
        }                                                           

   }// end of EDIT MENU    
   /////////////////////////////////////////////////////////
   // EDIT MENU ON/OFF            
   if(get_ival(BTN_AIM) && event_press(PS4_OPTIONS)){  
        ModMenu = TRUE;  
        // toggle EditMenu ON/OFF                      
                 modName_idx  = 0;                   
                 refresh_OLED = TRUE;   // display Title    
                 display_EDIT = FALSE;        
                 MenuTimeOut  = menu_time_active;
   }      
   /////////////////////////////////////////////////////////
   // MENU SYSTEM              
   if(ModMenu){  
        block_all_inputs(); 
      //--- Exit from MENU  
      if(event_press(PS4_CIRCLE)){
      	  if(ModMenu == MOD_Menu_1){// exit to desctop
	          ModMenu = FALSE;                     
	          ModEdit = FALSE;              
	          combo_run(MESSAGE);// exit Menu
          }else{//  exit to MENU 1
          	  ModMenu  = MOD_Menu_1;
          	  MOD_Call = MOD_Menu_1;
	          ModEdit      = FALSE;           
              display_EDIT = FALSE;           
              refresh_OLED = TRUE;   // display MODS               
          }
      }                    
      //--- Enter in EDIT MENU 
      if(event_press(PS4_CROSS)){
		  if(ModMenu == MOD_Menu_1){
	      	  if(MenuSub[modName_idx] == Edit_1){
		          ModMenu     = FALSE;
		          MOD_Call    = MOD_Menu_1; // Menu 1 Call Edit
		          valName_idx = OptRange[ modName_idx ][ 0 ]; 
		          ModEdit     = TRUE;   
		          display_EDIT= TRUE;
	          }else{
	          	  ModMenu     = MOD_Menu_2;
	          	  MOD_Call    = MOD_Menu_2; 
		          ModEdit     = FALSE;
		          refresh_OLED = TRUE;   // display MODS in MENU 2
	          }
          }else if(MOD_Call == MOD_Menu_2){
          		  ModMenu     = FALSE;
		          MOD_Call    = MOD_Menu_2; // Menu 2 Call Edit
		          adj_indx    = OptRange_2[ menu2_indx ][ 0 ]; 
		          ModEdit     = TRUE;   
		          display_EDIT= TRUE;
          }
      }                    
                                  
        //Display MOD NAME and togle status 
        // Switch MODs                     
        if( !get_ival(BTN_AIM) && event_press(PS4_DOWN)){ 
        	if( ModMenu == MOD_Menu_1){                                
        	   modName_idx ++;                 
        	   if(modName_idx > MAX_MODS_COUNT) modName_idx = 0; 
    	    }else{
    	    	menu2_indx ++;
    	    	if(menu2_indx > MAX_MODS_COUNT_2) menu2_indx = 0; 
    	    }
          //////////////////////////////////////
        	if( ModMenu == MOD_Menu_1){
        	   blinck(modName_idx[ modName_idx + 1]);
    	    }else{
    	    	blinck(menu2_indx[ menu2_indx + 1]);
    	    }
        }                          
        if(!get_ival(BTN_AIM) && event_press(PS4_UP)){  
        	if( ModMenu == MOD_Menu_1){                                                       
        	    modName_idx --;                                      
        	    if(modName_idx < 0) modName_idx = MAX_MODS_COUNT;
    	    }else{
    	    	menu2_indx --;
    	    	if(menu2_indx  < 0) menu2_indx = MAX_MODS_COUNT_2; 
    	    }
          //////////////////////////////////////
        	if( ModMenu == MOD_Menu_1){
        	   blinck(modName_idx[ modName_idx + 1]);
    	    }else{
    	    	blinck(menu2_indx[ menu2_indx + 1]);
    	    }
          /////////////////////////////////////
          }                        
        	//////////////////////////
        // screen saver           
        display_black = FALSE;    
        display_title = FALSE;    
        //////////////////////////////  
        // display mod name and Toggle ON/OFF | Scroll Options 
        if(!get_ival(BTN_AIM) ){    
             if(event_press(PS4_LEFT)){ //   go back
             	if( ModMenu == MOD_Menu_1){
                    modName_idx[ modName_idx + 1] = f_go_back( modName_idx[modName_idx + 1] );
                }else{
                	menu2_indx[ menu2_indx + 1] = f_go_back( menu2_indx[menu2_indx + 1] );
                }
             }// go back 
             if(event_press(PS4_RIGHT)){//   go forward
             	if( ModMenu == MOD_Menu_1){
                    modName_idx[ modName_idx + 1] = f_go_forward( modName_idx[ modName_idx + 1]);
                }else{
                	menu2_indx[ menu2_indx + 1] = f_go_forward( menu2_indx[ menu2_indx + 1]);
                }
             }// go forward 
             
                
			    
             if( ModMenu == MOD_Menu_2){
             	min_opt = Min_Max_Options_2[menu2_indx][0];
             	max_opt = Min_Max_Options_2[menu2_indx][1];
             	
             	set_val(TRACE_1,ModMenu);
			    set_val(TRACE_2,menu2_indx);
			    set_val(TRACE_3,menu2_indx[ menu2_indx + 1]);
			    set_val(TRACE_4, min_opt);
			    set_val(TRACE_5, max_opt);
				//----print right RIGHT ARROW --------------------
				if( menu2_indx[ menu2_indx + 1] >= min_opt && menu2_indx[ menu2_indx + 1]<  max_opt  ){
					putc_oled(1,RIGHT_arrow); 
					puts_oled(3, 37, OLED_FONT_SMALL, 1, col_char_right);
				}else{
					rect_oled(4, 36, OLED_FONT_SMALL_WIDTH + 2, OLED_FONT_SMALL_HEIGHT + 2, OLED_BLACK , col_char_left); // rectangle left (line 2)
				}
				// print right LEFT ARROW
				if( menu2_indx[ menu2_indx + 1] > min_opt  && menu2_indx[ menu2_indx + 1] <= max_opt){
					putc_oled(1,LEFT_arrow); 
					puts_oled(121, 37, OLED_FONT_SMALL, 1, col_char_right);
				}else{
					rect_oled(120, 36, OLED_FONT_SMALL_WIDTH + 2, OLED_FONT_SMALL_HEIGHT + 2, OLED_BLACK , col_char_left); // rectangle left (line 2)
				}
			//---------------------
			}
       } 
        refresh_OLED = TRUE;   
        set_val(PS4_LEFT,0); 
        set_val(PS4_RIGHT,0); 
        set_val(PS4_UP,0); 
        set_val(PS4_DOWN,0); 
        if(MenuTimeOut){
            CheckIfBtnIsPressed();
        }
    } 
    /////////////////////////////////////////////////////////////
    ///    END OF MENU  /////////////////////////////////////////
    /////////////////////////////////////////////////////////////
//========================================================================================================== 
   if(!ModEdit && !ModMenu){//  code for MODS
            
            //======================================================
            //   HEAD SHOT ASSIST
            //======================================================
			if(HeadShotAssist_onoff ) {
				RY = HeadShotStrength * -1;
				if(get_ival(BTN_FIRE) && get_ptime(BTN_FIRE) < HeadShotHoldTime) { 	
					offset(aim_y,RY);	
				}
			}            
            
            
            //======================================================
            //   ANTI RECOIL PRIMARY / SECONDARY WEAPON 
            //======================================================
            if(progressive_ar_onoff){
	            if(get_ival(PS4_L2) && event_press(PS4_LEFT) ) {
	                AR_Prim_Sec_onoff  =  TRUE;
	                AR_GroundLot_onoff = FALSE;
	                second_weapon      = FALSE;// Re-sync to Primary
	                set_rumble_tipe(AR_Prim_Sec_onoff);
	                display_MOD_status(AR_Prim_Sec_onoff,sizeof(AR_PRIM_SEC_)- 1,AR_PRIM_SEC_[0]);
	                set_val(PS4_LEFT,0);
	            }
            }
             //======================================================
            //   ANTI RECOIL GROUNDLOOT WEAPON 
            //======================================================
            if(AR_Groundloot){
	            if(get_ival(PS4_L2) && event_press(PS4_RIGHT) ) {
	                AR_GroundLot_onoff =  TRUE;
	                AR_Prim_Sec_onoff  = FALSE;
	                set_rumble_tipe(AR_GroundLot_onoff);
	                display_MOD_status(AR_GroundLot_onoff,sizeof(AR_GROUNDLOOT_)- 1,AR_GROUNDLOOT_[0]);
	                set_val(PS4_RIGHT,0);
	            }
            }
            //---Anti Recoil Primary/Secondary Weapon
            if(AR_Prim_Sec_onoff){
                //---1. Automatic Switch
                if(AR_Prim_Sec_onoff ){
                    if(get_ival(PS4_TOUCH) || get_ival(XB1_VIEW)){
                        if(event_press(XB1_Y)){
                            second_weapon = FALSE;// Re-sync to Primary
                            set_up_Progressive_AR ();
                            set_profile_notify( PRIMARY_Profile, RUMBLE_A);// one heavy rumble
                            display_ar_profile();
                        }
                        if(event_press(XB1_B)){
                            second_weapon = TRUE;// Re-sync to Secondary
                            set_up_Progressive_AR ();
                            set_profile_notify( SECONDARY_Profile, RUMBLE_A);// two heavy rumble
                            display_ar_profile();
                        }
                        set_val(BTN_SWAP,0);
                    }
                    else if(event_press(BTN_SWAP)){
                        second_weapon = !second_weapon; 
                        set_up_Progressive_AR ();
                        display_ar_profile();
                        if(second_weapon)
                        {
                            set_profile_notify(PRIMARY_Profile, RUMBLE_A);// one heavy rumble
                        }
                        else
                        {
                            set_profile_notify(SECONDARY_Profile, RUMBLE_A);// two heavy rumbles
                        }

                    }
                }// Automatic
            }
            //--- end of Anti Recoil Profiles Switch
            //======================================================
            //   ANTI RECOIL PRIMARY WEAPON 
            //======================================================
            //======================================================
            if(AR_Prim_Sec_onoff  && !second_weapon) {
				if(isqrt(pow(abs(get_ival(PS4_LX)),2) + pow(abs(get_ival(PS4_LY)),2)) <= DeadZone) {
					set_val(PS4_LX,0);
					set_val(PS4_LY,0);
				}
				
				if(isqrt(pow(abs(get_ival(PS4_RX)),2) + pow(abs(get_ival(PS4_RY)),2)) <= DeadZone) {
					set_val(PS4_RX,0);
					set_val(PS4_RY,0);
				}
                colourled(Green);
                //--reset counters/pointers
			    if(!get_lval(BTN_FIRE)) 
			    {
					// Vertical
			       ar_y = antirecoil_start[second_weapon];
			       i_cnt = 0;
			       i_num = 0;
			
					// Horizontal
			       ar_x = antirecoil_H_start[second_weapon];
			       i_cnt_h = 0;
			       i_num_h = 0;
			    }
			 
			 	set_val(TRACE_1,antirecoil_start[second_weapon]);
			 	set_val(TRACE_2,antirecoil_end[second_weapon]);
			 	set_val(TRACE_3,aim_y);
			 	set_val(TRACE_3,second_weapon);
			 	
			    //--RT
			    if(get_val(BTN_FIRE) && get_ival(BTN_AIM)) {
					// Vertical
			        if(!p_complete())  
			            ar_y = p_val();
			        else
			            ar_y = antirecoil_end[second_weapon];
			 
			        if(y_val() > 100)
			        {
			            set_val(aim_y, 100);
			        }
			        else  //--set RY to anti recoil value
			            set_val(aim_y,y_val());
			    
					// Horizontal
			        if(!p_complete_x())
			            ar_x = p_val_x();
			        else
			            ar_x = antirecoil_H_end[second_weapon];
			 
			        if(x_val() > 100)
			        {
			            set_val(aim_x, 100);
			        }
			        else //--set RX to anti recoil value
			            set_val(aim_x,x_val());
			    }   
            }
            //======================================================    
            //   ANTI RECOIL SECONDARY WEAPON 
            //======================================================
            //======================================================
            if(AR_Prim_Sec_onoff  &&  second_weapon) {
                colourled(Pink);
                //--reset counters/pointers
			    if(!get_lval(BTN_FIRE)) 
			    {
					// Vertical
			       ar_y = antirecoil_start[second_weapon];
			       i_cnt = 0;
			       i_num = 0;
			
					// Horizontal
			       ar_x = antirecoil_H_start[second_weapon];
			       i_cnt_h = 0;
			       i_num_h = 0;
			    }
			 	set_val(TRACE_1,antirecoil_start[second_weapon]);
			 	set_val(TRACE_2,antirecoil_end[second_weapon]);
			 	set_val(TRACE_3,aim_y);
			 	set_val(TRACE_3,second_weapon);
			 	
			    //--RT
			    if(get_val(BTN_FIRE) && get_ival(BTN_AIM)) {
					// Vertical
			        if(!p_complete())  
			            ar_y = p_val();
			        else
			            ar_y = antirecoil_end[second_weapon];
			 
			        if(y_val() > 100)
			        {
			            set_val(aim_y, 100);
			        }
			        else  //--set RY to anti recoil value
			            set_val(aim_y,y_val());
			    
					// Horizontal
			        if(!p_complete_x())
			            ar_x = p_val_x();
			        else
			            ar_x = antirecoil_H_end[second_weapon];
			 
			        if(x_val() > 100)
			        {
			            set_val(aim_x, 100);
			        }
			        else //--set RX to anti recoil value
			            set_val(aim_x,x_val());
			    }  
            } 
            //======================================================    
            //   ANTI RECOIL GROUND LOOT WEAPON 
            //======================================================
            //   Legacy Rumble AR / Polar Rumble AR 
            if(AR_GroundLot_onoff){
            	colourled(Blue);
	        	if(RumbleAR_toggle == 1 || RumbleAR_toggle == 2)  // If Modern Warfare Rumble OR Cold War Rumble Selected \\ 
			    {
			        if(get_ival(BTN_AIM) && get_ival(BTN_FIRE))  // If Press Fire Trigger , Activate Rumble AR \\ 
			        {
			            if(!get_rumble(RUMBLE_A) || !get_rumble(RUMBLE_B))  // Until Rumble Is Detected , Set the Strength To Maintain Anti-Recoil Until Rumble Detected \\ 
			    
			                SmartSens(VerticalStrength,aim_y);
			                
			            else
			            {
			                if(RumbleAR_toggle == 1) // Modern Warfare Rumble Option 
			                    SmartRumble = get_rumble(RumbleToUse())
			                    
			                else if(RumbleAR_toggle == 2)  // Cold War Rumble Option 
			                    AntirecoilStrength = get_rumble(RUMBLE_A)/2;
			                
			            }
			            if(AntirecoilStrength > 10 && AntirecoilStrength < 90)  // If Get Rumble \\ // Calculate The Rumble & Vertical Strength Divided By 4 \\
			            {
			                AntirecoilStrength = VerticalStrength + SmartRumble / 4;
			            }     
			            if(AntirecoilStrength < 10)   // If NO Rumble Is Detected \\// This Will Act Like Normal Anti-Recoil \\
			            {
			                SmartSens(VerticalStrength, aim_y);
			                SmartSens(HorizontalStrength,aim_x); 
			            }
			            else
			            {     
			                SmartSens(AntirecoilStrength,aim_y);  // If Get Rumble \\ //   
			                SmartSens(HorizontalStrength,aim_x);      
			            }
			            AntirecoilStrength  = 0;  // Reset Rumble Calculation
			            SmartRumble = 0;          // Reset RumbleToUse(); 
			        }
			    }
				/* =========================== POLAR RUMBLE AR ============================*/
			    if(RumbleAR_toggle == 3 || RumbleAR_toggle == 4)  // If Modern Warfare Rumble OR Cold War Rumble Selected \\ 
			    {
			        if(get_ival(BTN_FIRE) && get_ival(BTN_AIM))  // If Press Fire Btn , Activate Rumble AR \\ 
			        {
			            if(!get_rumble(RUMBLE_A) || !get_rumble(RUMBLE_B))  // Until Rumble Is Detected , Set the Strength To Maintain Anti-Recoil Until Rumble Detected \\ 
			    
			                SmartSens(VerticalStrength,POLAR_RY);
			                
			            else
			            {
			                if(RumbleAR_toggle == 3) // Modern Warfare Rumble Option 
			                    SmartRumble = get_rumble(RumbleToUse())
			                    
			                else if(RumbleAR_toggle == 4)  // Cold War Rumble Option 
			                    AntirecoilStrength = get_rumble(RUMBLE_A)/2;
			                
			            }
			            if(AntirecoilStrength > 10 && AntirecoilStrength < 90)  // If Get Rumble \\ // Calculate The Rumble & Vertical Strength Divided By 4 \\
			            {
			                AntirecoilStrength = VerticalStrength + SmartRumble / 4;
			            }     
			            if(AntirecoilStrength < 10)   // If NO Rumble Is Detected \\// This Will Act Like Normal Anti-Recoil \\
			            {
			                SmartSens(VerticalStrength, POLAR_RY);
			                SmartSens(HorizontalStrength,POLAR_RX); 
			            }
			            else
			            {     
			                SmartSens(AntirecoilStrength,POLAR_RY);  // If Get Rumble \\ //   
			                SmartSens(HorizontalStrength,POLAR_RX);      
			            }
			            AntirecoilStrength  = 0;  // Reset Rumble Calculation
			            SmartRumble = 0;          // Reset RumbleToUse(); 
			        }
			    }
            }
            //======================================================    
            //  AIM ASSIST TAYLORDRIFT with SHAPES
            //====================================================== 
            if(Zen_Assist){
	            if(ToggleTaylorAA == 1 || ToggleTaylorAA == 2 || TaylorAssist == 1 || TaylorAssist == 2 || TaylorAssist == 3 || TaylorAssist == 4){ 	// V1 && V6 										
					ActualMagnitude = isqrt(pow(RX_td, 2) + pow(RY_td, 2));   
					MaxMagnitude    = (ActualMagnitude < 100);  
					RX_td           = get_val(PS4_RX);
					RY_td           = get_val(PS4_RY); 
					CycleRefresh    += get_rtime();
					
					if(ToggleTaylorAA == 1 || ToggleTaylorAA == 2){ 
						angleVersionOne += SpeedAA12 + BoostAngle;
						GetAngle(TaylorShapesv1,angleVersionOne,RadiusAA12);
						if(BoostFirev1){
							if(get_ival(BTN_FIRE)){ 
								AimAssistBoost = get_rumble(RumbleToUse());
								BoostAngle = BoostSpeedv1;
				        		if(AimAssistBoost > 10 && AimAssistBoost < 90){  
						   			BoostedAimAssist  = (BoostStrengthv1 + AimAssistBoost / 6); 
					   			}
					   			if(BoostReducer){ 
									if(!get_rumble(RUMBLE_A) && !get_rumble(RUMBLE_B)){ 
										GetAngle(TaylorShapesv1,angleVersionOne,RadiusAA12 + inv(BoostStrengthv1));
									}else{ 
								   	 	GetAngle(TaylorShapesv1,angleVersionOne,inv(BoostedAimAssist/2));
							   		} 
							   	}else{
							   		if(!get_rumble(RUMBLE_A) && !get_rumble(RUMBLE_B)){ 
										GetAngle(TaylorShapesv1,angleVersionOne,RadiusAA12 + BoostStrengthv1);
									}else{ 
							   	 		GetAngle(TaylorShapesv1,angleVersionOne,BoostedAimAssist)
							   	    } 
						   		} 
					   		} 
					   		if(event_release(BTN_FIRE)){ 
					   			BoostedAimAssist = 0;
					   			AimAssistBoost   = 0;
					   		} 
					   	} 
					} 
					if(TaylorAssist == 1 || TaylorAssist == 2 || TaylorAssist == 4){ 
						GetAngle(TaylorShapesv2,angleVersionFive,TaylorRadius);
						if((abs(get_val(PS4_RX)) < 10) * (abs(get_val(PS4_RY)) < 10)) 
					    	angleVersionFive += AdsSpeed + BoostAnglev4;
					    else
					    	angleVersionFive +=  TaylorAngle + BoostAnglev4;
					    if(ToggleBoostFire){
							if(get_ival(BTN_FIRE)){ 
								AimAssistBoostv4 = get_rumble(RumbleToUse());
								BoostAnglev4 =  TaylorABoostSpd;
				        		if(AimAssistBoostv4 > 10 && AimAssistBoostv4 < 90){  
						   			BoostedAimAssistv4  = (TaylorPBoostStr + AimAssistBoostv4 / 6); 
					   			}
					   			if(BoostReducerv2){ 
									if(!get_rumble(RUMBLE_A) && !get_rumble(RUMBLE_B)){ 
										GetAngle(TaylorShapesv2,angleVersionFive,TaylorRadius + inv(TaylorPBoostStr));
									}else{ 
								   	 	GetAngle(TaylorShapesv2,angleVersionFive,inv(BoostedAimAssistv4/2));
							   		} 
							   	}else{ 
							   		if(!get_rumble(RUMBLE_A) && !get_rumble(RUMBLE_B)){ 
										GetAngle(TaylorShapesv2,angleVersionFive,TaylorRadius + TaylorPBoostStr);
									}else{ 
							   	 		GetAngle(TaylorShapesv2,angleVersionFive,BoostedAimAssistv4);
							   	 	} 
						   		} 
					   		} 
					   		if(event_release(BTN_FIRE)){ 
					   			BoostedAimAssistv4 = 0;
					   			AimAssistBoostv4   = 0;
					   		} 
					   	} 
				    }
				    if(TaylorAssist == 1 || TaylorAssist == 2 || TaylorAssist == 3 || TaylorAssist == 4){ 
				    	Tracking        = (Tracking + TrackingSpeed) % 360;
					    if(ShapeDirection){ 
					    	AngleDirection = (get_val(PS4_RX) > 0);
					    } 
					    if(TaylorTracking){ 
							Tracker1 = (TrackingSize * sin(Tracking)/100);
					        Tracker2 = (TrackingSize * cos(Tracking)/100);
					    }    
					}
					if(TaylorAssist == 3){ 
						angleVersionFive += get_rtime();
						GetAngle(TaylorShapesv2,SpeedAngle,TaylorRadius);
						SpeedAngle = (SpeedAngle  + (angleVersionFive / 100)) % 360;
					} 
					if(get_val(BTN_AIM) || get_val(BTN_FIRE)){ 
					
						if(ToggleTaylorAA == 1 || ToggleTaylorAA == 1 && BoostFirev1){ 	
							if(ActualMagnitude < RadiusAA12){
						   		SinAngle -= RX_td;                                                              
								CosAngle -= RY_td;
							}else{
								SinAngle = (SinAngle * (200 - ((abs(RY_td) + ActualMagnitude) / 10) * 10) / 200) * MaxMagnitude;  
								CosAngle = (CosAngle * (200 - ((abs(RX_td) + ActualMagnitude) / 10) * 10) / 200) * MaxMagnitude; 
							}
						}
						if(ToggleTaylorAA == 1 || TaylorAssist == 2 || TaylorAssist == 3) { 
							set_val(PS4_RX, clamp(RX_td + CosAngle, -100, 100));
							set_val(PS4_RY, clamp(RY_td + SinAngle, -100, 100));
						} 
						if(ToggleTaylorAA == 2 || TaylorAssist == 1){ 
							offset(POLAR_RS + 8,SinAngle);
							offset(POLAR_RS + 7,CosAngle);
						}
							
					} 
					if(event_release(BTN_AIM)){ 
				    	angleVersionFive = 0;
				    }
				    if(TaylorAssist == 4){ 
				    	if(get_ival(BTN_AIM) && !get_ival(BTN_FIRE)){ 
				    		offset(POLAR_RS + 8,SinAngle);
							offset(POLAR_RS + 7,CosAngle);
						}
						if(get_ival(BTN_FIRE)){ 
							PolarAimAssist = get_ptime(BTN_FIRE);	
							if(PolarAimAssist <= PolarStart){
				         		offset(POLAR_RS + 8,SinAngle);
								offset(POLAR_RS + 7,CosAngle);
				     		}
				     		if((PolarAimAssist > PolarStart) && (PolarAimAssist <= PolarMid)){
				         		set_val(PS4_RX, clamp(RX_td + CosAngle, -100, 100));
								set_val(PS4_RY, clamp(RY_td + SinAngle, -100, 100));
				     		}
				     		if(PolarAimAssist > PolarMid) {
				         		set_val(PS4_RX, clamp(RX_td + CosAngle, -100, 100));
								set_val(PS4_RY, clamp(RY_td + SinAngle, -100, 100));
				     		}
						} 
					}
				} 
			}
	        //===========================================
	        //   Stick Noise                      
	        //===========================================
	        if( stick_noise_onoff ) { 
		        RemoveStickNoise();
	        }// end user MOD 4
            //===========================================
            //   IN GAME RUMBLE                          
            //===========================================
            if(!rumble_onoff)
                block_rumble();
                                
			//===========================================
			//   DROP SHOT 
			//===========================================
	        if(get_ival(PS4_L2)){
	            if(event_press(PS4_DOWN)){
	                KS_drop_shot = !KS_drop_shot;
	                set_rumble_tipe(KS_drop_shot); 
	                display_MOD_status(KS_drop_shot,sizeof(DROP_SHOT_)- 1,DROP_SHOT_[0]);
	            }
	             set_val(PS4_DOWN,0);
	        }
	        if(dropshot_onoff  && KS_drop_shot) {     
	            if(dropshot_onoff == 1){
	                //--- FIRE ONLY
	                if(get_ival(BTN_FIRE) && !get_ival(BTN_AIM) ) combo_run(DROP_SHOT_cmb); 
	                /////////////////////////////////////////
	            }
	            if(dropshot_onoff == 2){
	                //--- ADS & FIRE
	                if(get_ival(BTN_FIRE) || get_ival(BTN_AIM) ) combo_run(DROP_SHOT_cmb); 
	                /////////////////////////////////////////
	            }
	            if(dropshot_onoff == 3){
	                //--- ADS ONLY
	                if(get_ival(!BTN_FIRE) && get_ival(BTN_AIM) ) combo_run(DROP_SHOT_cmb); 
	                /////////////////////////////////////////
	            } 
	        }                                   
            
            //===========================================
            //   HAIR TRIGGERS 
            //===========================================
            if(USE_HAIR_TRIGGER)
            {                                 
                 deadzone(PS4_L2,PS4_R2,99,99);
            }                                 
			//===========================================
			//   HOLD BREATH 
			//===========================================
			if(KS_Hold_Breath){ 
			    if(holdbreath_onoff  ) { // Like CoD
			         //----------------------------------------------
			         if( get_ival(BTN_AIM) ) set_val(BTN_SPRINT, 100);// SPRINT BTN 
			         //----------------------------------------------
			    } 
			}
			//===========================================
            //   Batts Sticky Aim 
            //===========================================
            if(ToggleBattsStickyAim){
                if(get_ival(BTN_FIRE))
                    combo_run(StickyAim);
            }
            //===========================================
		    //   AUTO SLIDE CANCEL 
		    //===========================================
			//===============================================  
			//--- Auto Slide Cancel with custom slide lenth (recommended for low skill players)ASCE 
			//===============================================                                        
		    if((event_press(PS4_UP) && get_ival(PS4_CIRCLE)) || (event_press(XB1_Y) && get_ival(PS4_UP))) {// 
		       AutoSlideCancelEasy = !AutoSlideCancelEasy;    
		       set_rumble_tipe (AutoSlideCancelEasy);         
		       if(AutoSlideCancelEasy)AutoSlideCancel = FALSE; 
		                                                      
		    }                         
		                              
		    if(AutoSlideCancelEasy){  
			     if(get_ival (BTN_CROUCH)){
					    combo_run(ASCE);
				   }                  
		    }                     
			//===============================================            actual_X
			//--- Auto Slide Cancel with the ability to choose the length of your slide. 
			//===============================================                                 
			if((event_press(PS4_UP) && get_ival(PS4_CROSS)) || (event_press(PS4_CROSS) && get_ival(PS4_UP))) {//- 
			   AutoSlideCancel = !AutoSlideCancel;                                        
			   if(AutoSlideCancel)AutoSlideCancelEasy = FALSE;                            
			   set_rumble_tipe (AutoSlideCancelEasy);                                
			}                                                                        
		                                                                        
		   	if(AutoSlideCancel)  {                                            
		                                                                    
		       if((get_ival(walk) < -60) || (get_ival(walk) > 60) || (get_ival(strafe) < -60) || (get_ival(strafe) > 60)){
				      if(event_release (BTN_CROUCH)){                
					       combo_run(ASC)                               
				      }                                              
			     }                                               
		    }
		    
		    //--- CLEAR OLED SCREEN after message                                       
            if(time_to_clear_screen){               
                time_to_clear_screen -= get_rtime();
                if(time_to_clear_screen <= 0 ){     
                    QT_MESSAGE_TIMEOUT();     
                }                              
            }            
                          
		    
        } //  end of MODS CODE 
    } //  ENTIRE SCRIPT KILL SWITCH 
} //  end of main block 
///////////////////////////////////////////////////////////////////////////// 
///   COMBO BLOCK                                                             
/////////////////////////////////////////////////////////////////////////////
int min_opt;
int max_opt;

const int8 Polar_Array[]={100,100,100,100,100,100,100,100,99,99,99,99,98,98,97,97,97,96,95,95,94,94,93,92,92,91,90,89,89,88,87,86,85,84,83,82,81,    
80,79,78,77,75,74,73,72,71,70,69,67,66,65,63,62,61,59,58,56,55,53,52,50,49,47,46,44,43,41,40,38,36,35,33,31,30,28,26,25,23,21,20,18,16,14,13,11,9,7, 
6,4,2,0,-1,-3,-5,-7,-8,-10,-12,-13,-15,-17,-19,-20,-22,-24,-25,-27,-29,-30,-32,-34,-35,-37,-39,-40,-42,-43,-45,-46,-48,-50,-51,-53,-54,-55,-57,-58,  
-60,-61,-62,-64,-65,-66,-68,-69,-70,-71,-73,-74,-75,-76,-77,-78,-79,-80,-81,-82,-83,-84,-85,-86,-87,-88,-89,-89,-90,-91,-92,-92,-93,-93,-94,-95,-95, 
-96,-96,-97,-97,-97,-98,-98,-99,-99,-99,-99,-100,-100,-100,-100,-100,-100,-100,-100,-100,-100,-100,-100,-100,-100,-99,-99,-99,-98,-98,-98,-97,-97,   
-96,-96,-95,-94,-94,-93,-93,-92,-91,-90,-90,-89,-88,-87,-86,-85,-84,-83,-82,-81,-80,-79,-78,-77,-76,-75,-74,-72,-71,-70,-69,-67,-66,-65,-63,-62,-61, 
-59,-58,-56,-55,-53,-52,-50,-49,-47,-46,-44,-43,-41,-40,-38,-36,-35,-33,-31,-30,-28,-26,-25,-23,-21,-20,-18,-16,-14,-13,-11,-9,-7,-6,-4,-2,0,2,4,6,7,
9,11,13,14,16,18,20,21,23,25,26,28,30,31,33,35,36,38,40,41,43,44,46,47,49,51,52,54,55,56,58,59,61,62,63,65,66,67,69,70,70,72,73,74,75,77,78,79,80,81,
82,83,84,85,86,87,88,89,89,90,91,92,92,93,94,94,95,95,96,97,97,97,98,98,99,99,99,99,100,100,100,100,100,100,100};                     

const int8 PolarArray[] = { -100,-100,-100,-100,-100,-100,-100,-100,-100,-99,-99,-99,-98,-98,-98,-97,-97,-96,-96,-95,-94,-94,-93,-93,-92,-91,-90,-90,-89,-88,-87,-86,-85,-84,-83,-82,-81,-80,-79,-78,-77,-76,-75,-74,-72,-71,-70,-69,-67,-66,-65,-63,-62,-61,-59,-58,-56,-55,-53,-52,-50,-49,-47,-46,-44,-43,-41,-40,-38,-36,-35,-33,-31,-30,-28,-26,-25,-23,-21,-20,-18,-16,-14,-13,-11,-9,-7,-6,-4,-2,0,2,4,6,7,9,11,13,14,16,18,20,21,23,25,26,28,30,31,33,35,36,38,40,41,43,44,46,47,49,51,52,54,55,56,58,59,61,62,63,65,66,67,69,70,70,72,73,74,75,77,78,79,80,81,82,83,84,85,86,87,88,89,89,90,91,92,92,93,94,94,95,95,96,97,97,97,98,98,99,99,99,99,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,99,99,99,99,98,98,97,97,97,96,95,95,94,94,93,92,92,91,90,89,89,88,87,86,85,84,83,82,81,80,79,78,77,75,74,73,72,71,70,69,67,66,65,63,62,61,59,58,56,55,53,52,50,49,47,46,44,43,41,40,38,36,35,33,31,30,28,26,25,23,21,20,18,16,14,13,11,9,7,6,4,2,0,-1,-3,-5,-7,-8,-10,-12,-13,-15,-17,-19,-20,-22,-24,-25,-27,-29,-30,-32,-34,-35,-37,-39,-40,-42,-43,-45,-46,-48,-50,-51,-53,-54,-55,-57,-58,-60,-61,-62,-64,-65,-66,-68,-69,-70,-71,-73,-74,-75,-76,-77,-78,-79,-80,-81,-82,-83,-84,-85,-86,-87,-88,-89,-89,-90,-91,-92,-92,-93,-93,-94,-95,-95,-96,-96,-97,-97,-97,-98,-98,-99,-99,-99,-99,-100,-100,-100,-100,-100};
const int8 LinearArray[] = { 100,-100,-99,-98,-97,-96,-95,-94,-93,-91,-90,-89,-88,-87,-86,-85,-84,-82,-81,-80,-79,-78,-77,-76,-75,-73,-72,-71,-70,-69,-68,-67,-66,-64,-63,-62,-61,-60,-59,-58,-57,-55,-54,-53,-52,-51,-50,-49,-48,-46,-45,-44,-43,-42,-41,-40,-39,-37,-36,-35,-34,-33,-32,-31,-30,-28,-27,-26,-25,-24,-23,-22,-21,-19,-18,-17,-16,-15,-14,-13,-12,-10,-9,-8,-7,-6,-5,-4,-3,-11,2,3,4,5,6,7,8,10,11,12,13,14,15,16,17,19,20,21,22,23,24,25,26,28,29,30,31,32,33,34,35,37,38,39,40,41,42,43,44,46,47,48,49,50,51,52,53,55,56,57,58,59,60,61,62,64,65,66,67,68,69,70,71,73,74,75,76,77,78,79,80,82,83,84,85,86,87,88,89,91,92,93,94,95,96,97,98,100,100,100,99,98,97,96,95,94,93,91,90,89,88,87,86,85,84,82,81,80,79,78,77,76,75,73,72,71,70,69,68,67,66,64,63,62,61,60,59,58,57,55,54,53,52,51,50,49,48,46,45,44,43,42,41,40,39,37,36,35,34,33,32,31,30,28,27,26,25,24,23,22,21,19,18,17,16,15,14,13,12,10,9,8,7,6,5,4,3,1,-1,-1,-2,-3,-4,-5,-6,-7,-8,-10,-11,-12,-13,-14,-15,-16,-17,-19,-20,-21,-22,-23,-24,-25,-26,-28,-29,-30,-31,-32,-33,-34,-35,-37,-38,-39,-40,-41,-42,-43,-44,-46,-47,-48,-49,-50,-51,-52,-53,-55,-56,-57,-58,-59,-60,-61,-62,-64,-65,-66,-67,-68,-69,-70,-71,-73,-74,-75,-76,-77,-78,-79,-80,-82,-83,-84,-85,-86,-87,-88,-89,-91,-92,-93,-94,-95,-96,-97,-98,-100};   




int Tracking,Tracker1,Tracker2;
int CosAngle,SinAngle;
int angleVersionOne,angleVersionFive;
int BoostedAimAssist,AimAssistBoost,BoostAngle; // V1 and V2 AimAssist 
int BoostedAimAssistv4,AimAssistBoostv4,BoostAnglev4; // v4 && v5 AimAssist 
int RX_td,RY_td,ActualMagnitude,MaxMagnitude;
int SpiralPosition1,InnerSpiral,OuterSpiral,SpiralPosition2,Position,SpeedAngle,AngleDirection,Positionv2;
int x,y,inc;
int CycleRefresh;
int TimeInterval = 4;
int PolarStart	 = 1000;
int PolarMid   	 = 1200;
int PolarAimAssist
define False     = FALSE;
define True      = TRUE; 
define ACTIVE_WHEN_ADS    = TRUE;                     
define ACTIVE_WHEN_FIRING = TRUE;  
define STEP_INTERVAL =  1;     
const int16 TaylorShapesInfo[][] = {
// Shape ID - CosAngle - SinAngle - DivisableRadiusCos - DivisableRadiusSin - NonSpiral 
{      0    ,    0     ,    0     ,          1         ,         1          ,     0 }, // Circular 
{      1    ,    0     ,    0     ,          2         ,         1          ,     0 }, // TallOval
{      2    ,    0     ,    1     ,          1         ,         2          ,     3 }, // WideOval
{      3    ,    0     ,    0     ,          2         ,         1          ,     1 }, // SpiralOval 
{      4    ,    0     ,    0     ,          2         ,         1          ,     1 }, // Spiral 
{      5    ,    0     ,    0     ,          1         ,         1          ,     2 }, // Helix 
{      6    ,    0     ,    0     ,          1         ,         0          ,     0 }, // Kitt 
{      7    ,    0     ,    0     ,          0         ,         1          ,     0 }, // Vertical Flare
{      8    ,   45    ,   135     ,          1         ,         1          ,     3 }, // Tartan Flex 
{      9    ,  180    ,   315     ,          1         ,         1          ,     0 }, // Jupiter
{     10    ,  135    ,    45     ,          1         ,         1          ,     0 }, // Bishop
{     11    ,   45    ,   135     ,          1         ,         1          ,     0 }, // Blade
{     12    ,  315    ,   180     ,          1         ,         1          ,     0 }  // Osclirate  
} 



function GetAngle(getShapes,getSinCos,Rad){ 

	if(TaylorShapesInfo[getShapes][5] == 0){
		if(AngleDirection){
			SinAngle  = (cos(TaylorShapesInfo[getShapes][1] + getSinCos) * Rad/TaylorShapesInfo[getShapes][3])/100 + Tracker1;
			CosAngle  = (sin(TaylorShapesInfo[getShapes][2] + getSinCos) * Rad/TaylorShapesInfo[getShapes][4])/100 + Tracker2; 
		}else{ 
			CosAngle  = (cos(TaylorShapesInfo[getShapes][1] + getSinCos) * Rad/TaylorShapesInfo[getShapes][3])/100 + Tracker1;
			SinAngle  = (sin(TaylorShapesInfo[getShapes][2] + getSinCos) * Rad/TaylorShapesInfo[getShapes][4])/100 + Tracker2; 
		} 
	} 
	if(TaylorShapesInfo[getShapes][5] == 1){ 
		Spiral(Rad);
		if(ShapeDirection){
			CosAngle  = (sin(TaylorShapesInfo[getShapes][1] + getSinCos) * InnerSpiral)/100 + Tracker1;
			SinAngle  = (cos(TaylorShapesInfo[getShapes][2] + getSinCos) * OuterSpiral)/100 + Tracker2;
		}else{ 
			CosAngle  = (cos(TaylorShapesInfo[getShapes][1] + getSinCos) * InnerSpiral)/100 + Tracker1;
			SinAngle  = (sin(TaylorShapesInfo[getShapes][2] + getSinCos) * OuterSpiral)/100 + Tracker2;
		} 
	}
	if(TaylorShapesInfo[getShapes][5] == 2){ 
		Helix();
		CosAngle  = (Rad * y)/100 + Tracker1;
		SinAngle  = (Rad * x)/100 + Tracker2;
	}
	if(TaylorShapesInfo[getShapes][5] == 3){ 
		if(Positionv2 == 0){ 
			CosAngle  = (cos(TaylorShapesInfo[getShapes][1] + getSinCos) * Rad/TaylorShapesInfo[getShapes][3])/100 + Tracker1;
			SinAngle  = (sin(TaylorShapesInfo[getShapes][2] + getSinCos) * Rad/TaylorShapesInfo[getShapes][4])/100 + Tracker2; 
		} 
		if(Positionv2 == 1){ 
			CosAngle  = (cos(TaylorShapesInfo[getShapes][2] + getSinCos) * Rad/TaylorShapesInfo[getShapes][3])/100 + Tracker1;
		    SinAngle  = (sin(TaylorShapesInfo[getShapes][1] + getSinCos) * Rad/TaylorShapesInfo[getShapes][4])/100 + Tracker2; 
		} 
	    Positionv2 ++ 
		if(Positionv2 == 2){ 
		  	Positionv2 = 0;
		}
	} 
} 
function InitializeShapeChange() { 
	if(TaylorShapesInfo[TaylorShapesv1][0] == 3) {
		if(ToggleTaylorAA == 1 || ToggleTaylorAA == 2){ 
			if(!ToggleBoostFire){
				InnerSpiral = RadiusAA12/2;	
				OuterSpiral = RadiusAA12;
			}else{ 
				InnerSpiral = BoostStrengthv1/2;	
				OuterSpiral = BoostStrengthv1;
			}
		}
	}
	if(TaylorShapesInfo[TaylorShapesv2][0] == 3) {
		if(TaylorAssist == 1 || TaylorAssist == 2){ 
			if(!ToggleBoostFire){ 
				InnerSpiral = TaylorRadius/2;	
				OuterSpiral = TaylorRadius;
			}else{ 
				InnerSpiral = TaylorPBoostStr/2;	
				OuterSpiral = TaylorPBoostStr;
			}
		}
	}
	
}
int i;
function Helix(){ 
	inc = (i % 100);
    if(Position == 0){ 
   		x = inc; y = 100 - inc;
   	} 
    else if (Position == 1){ 
    	x = 100 - inc; y = - inc; 
    }
    else if (Position == 2){
    	x = -inc; y = -100 + inc; 
    }
    else if(Position == 3) {  
    	x = -100 + inc; y = inc; 
    }
    Position ++;
   
    if(Position == 4){ 
    	Position = 0;
    }	
 } 
function Spiral(Rad){ 
	
		if(!(CycleRefresh++ % TimeInterval))
		{
			if(!SpiralPosition1)                                
			{
				InnerSpiral -= 1;
				if(InnerSpiral < Rad/2)
					SpiralPosition1 = True;   
			}
			else
			{
			    InnerSpiral += 1;
				if(InnerSpiral > Rad)
					SpiralPosition1 = False;
			}
			if(!SpiralPosition2)
			{
				OuterSpiral -= 1;
				if(OuterSpiral < Rad/2)
					SpiralPosition2 = True;
			}
			else
			{
				OuterSpiral += 1;
				if(OuterSpiral > Rad)
					SpiralPosition2 = False
			}
			CycleRefresh = 0;
		}
	
}
function correctAngle(angle){
  if(angle < 0) angle = 360 + (angle % 360);
  angle = (angle + 90) % 360;
  return angle;
}
function offset(Stick,Value) {
  set_val(Stick, clamp(Value * (100 - abs(get_val(Stick))) / 110 + get_val(Stick), -100, 100));
  return;
}
function sin(angle){
	
  	if(ToggleAAType == 1 || ToggleAATypev2 == 1)
		return PolarArray[correctAngle(angle)];
	else if(ToggleAAType == 2|| ToggleAATypev2 == 2)
    	return LinearArray[correctAngle(angle)];
    else if(ToggleAAType == 3|| ToggleAATypev2 == 3)
    	return PolarArray[correctAngle(angle)];
    	
    return 0;
}

function cos(angle){
	if(ToggleAAType == 1 || ToggleAATypev2 == 1) 
		return PolarArray[(correctAngle(angle) + 90) % 360];
	else if(ToggleAAType == 2|| ToggleAATypev2 == 2)
    	return LinearArray[(correctAngle(angle) + 90) % 360];
    else if(ToggleAAType == 3|| ToggleAATypev2 == 3)
    	return LinearArray[(correctAngle(angle) + 90) % 360]; 
    	
    return 0;   
}


// Variables \\
 
int MinRadius = 1;  // Leave Alone , This can be left alone and not need adjusted. \\
int time;                                             
int angle, cos_angle_tdrift, sin_angle_tdrift;                      
int actual_X, actual_Y, actual_Magnitude, max_Magnitude; 
function GetShapes(f_var) {     
   
    if(!SpiralPosition1)                                
    {
        InnerSpiral -= 1;
        if(InnerSpiral < MinRadius)
            SpiralPosition1 = TRUE;
    }
    else
    {
        InnerSpiral += 1;
        if(InnerSpiral > f_var)
            SpiralPosition1 = FALSE;
    }
    if(!SpiralPosition2)
    {
        OuterSpiral -= 1;
        if(OuterSpiral < MinRadius)
            SpiralPosition2 = TRUE;
    }
    else
    {
        OuterSpiral += 1;
        if(OuterSpiral >  f_var)
            SpiralPosition2 = FALSE;
    } 
    if( Zen_Assist == 1)                    
    { 
        sin_angle_tdrift = (sin_angle_tdrift * f_var) /100;
        cos_angle_tdrift = (cos_angle_tdrift * f_var) /100;  
    } 
    if( Zen_Assist == 2)        
    { 
        sin_angle_tdrift = (sin_angle_tdrift * f_var)/100;
        cos_angle_tdrift = (cos_angle_tdrift * f_var/2)/100; 
    }
    if( Zen_Assist == 3)                     
    { 
        cos_angle_tdrift = (cos_angle_tdrift * f_var) /100;  
        sin_angle_tdrift = (sin_angle_tdrift * f_var/2)/100;  
    } 
    if( Zen_Assist == 4)                  
    {
        sin_angle_tdrift = (sin_angle_tdrift * InnerSpiral) /100;
        cos_angle_tdrift = (cos_angle_tdrift * OuterSpiral) /100;  
    }
    if( Zen_Assist == 5)
    {
        if(Position == 0 || Position == 1)
        {  
            actual_X = (get_ival(aim_x)) + ((cos_angle_tdrift * f_var))/100;
        }
        if(Position == 2 || Position == 3)
        {  
            actual_Y = (get_ival(aim_y)) + ((sin_angle_tdrift * f_var))/100;
        }
            Position++;        
            
        if(Position == 4)
        {
            Position = 0;
        }    
    }
    if(Zen_Assist == 5 )
    {
           set_val(aim_x, actual_X);
           set_val(aim_y, actual_Y); 
    } 
    else
    {
        set_val(aim_x, calculate(actual_X + cos_angle_tdrift, -100, 100));
        set_val(aim_y, calculate(actual_Y + sin_angle_tdrift, -100, 100)); 
          
    }   
 }
function calculate(int v, int lo, int hi) { 
  if(v < lo) return lo;               
  if(v > hi) return hi;        
  return v;     
}     

// ANTI RECOIL
// Variables \\
int SmartRumble,AntirecoilStrength;
int SmartSens_side,SmartSens;
int polar_to_standard;
int final_val;
int range_min;
int range_max;
int RumbleAR_toggle = 1;// COD WF



function RumbleToUse() {
    if(get_rumble(RUMBLE_A) == get_rumble(RUMBLE_B)) 
    {
        return RUMBLE_A;
    }
    if(get_rumble(RUMBLE_A) == 100) 
    {
        return RUMBLE_B;
    }
    if(get_rumble(RUMBLE_B) == 100) 
    {
        return RUMBLE_A;
    }
    if(get_rumble(RUMBLE_A) > get_rumble(RUMBLE_B)) 
    {
        return RUMBLE_A;
    }
    if(get_rumble(RUMBLE_A) < get_rumble(RUMBLE_B)) 
    {
        return RUMBLE_B;
    }
    return 0;
}
function SmartSens(f_val, f_axis) { 
    
    if     (f_axis == POLAR_RX) polar_to_standard = PS4_RX;
    else if(f_axis == POLAR_RY) polar_to_standard = PS4_RY;
    else if(f_axis == POLAR_LX) polar_to_standard = PS4_LX;
    else if(f_axis == POLAR_LY) polar_to_standard = PS4_LY;
    else    polar_to_standard = f_axis;
    
    if(f_val < 0)
        SmartSens_side = -1; // Left / Up 
    else 
        SmartSens_side = 1; // Right / Down 

    if(SmartSens_side == -1) // if f_val has a negative value (Left side or Up) 
    {
        if(get_ival(f_axis) > 0) // if Right stick input has a positive value
            SmartSens = ((get_ival(polar_to_standard) * (100 - f_val)) / 100); 
        
        else if(get_ival(f_axis) <= 0) // if Right stick input has a negative value
            SmartSens = ((get_ival(polar_to_standard) * (100 + f_val)) / 100);
    }
    
    if(SmartSens_side == 1) // if f_val has a positive value (Right side or Down)
    {
        if(get_ival(f_axis) < 0) // if Right stick input has a negative value
            SmartSens = ((get_ival(polar_to_standard) * (100 + f_val)) / 100); 
            
        else if(get_ival(f_axis) >= 0) // if Right stick input has a positive value
            SmartSens = ((get_ival(polar_to_standard) * (100 - f_val)) / 100);
    }
            
    if(polar_to_standard == f_axis)
    {
        final_val = f_val + SmartSens;
        range_min = -100;
        range_max = 100;
    }
    else
    {
        final_val = (f_val + SmartSens) * 327;
        range_min = -32768;
        range_max = 32767;
    }
// Set axis to SmartSens value
    if(SmartSens_side == -1 && get_ival(f_axis) >= final_val || SmartSens_side == 1 && get_ival(f_axis) <= final_val)
        set_val(f_axis, clamp(final_val, range_min, range_max));
}
const string AR_PRIMARY_LABEL       = "PRIMARY W" ;
const string AR_SECONDARY_LABEL     = "SECONDARY" ;            
function display_ar_profile(){  
    if(!ModMenu && !ModEdit ){                                           
        // Clear OLED Screen                          
        cls_oled(0); // will clear oled                  
        if( !second_weapon ){
            print(sizeof(AR_PRIMARY_LABEL)- 1 ,3,OLED_FONT_MEDIUM,OLED_WHITE,AR_PRIMARY_LABEL[0]);// Primary AR Profile 
        }
        else {           
            print(sizeof(AR_SECONDARY_LABEL)- 1,3,OLED_FONT_MEDIUM,OLED_WHITE,AR_SECONDARY_LABEL[0]);//Secondary AR Profile                              
        }             
        print(center_x(sizeof(ON)- 1, OLED_FONT_LARGE_WIDTH),37,OLED_FONT_LARGE,OLED_WHITE, ON[0]);
        time_to_clear_screen = 1500; 
    } 

}
int KS_AntiRecoil = TRUE;


////////////////////////////////////////////////////////////
///// Batts Sticky Aim     /////////////////////////////////
////////////////////////////////////////////////////////////


combo StickyAim {
	offset_batts(PS4_RY,AimAssistSize);
	wait(AimAssistTime);
	offset_batts(PS4_RX,AimAssistSize);
	offset_batts(PS4_LX,AimAssistSize);
	wait(AimAssistTime);
	offset_batts(PS4_RY,inv(AimAssistSize));
	wait(AimAssistTime);
    offset_batts(PS4_RX,inv(AimAssistSize));
    offset_batts(PS4_LX,inv(AimAssistSize));
    wait(AimAssistTime);
}
function offset_batts(Stick,Value) {
  set_val(Stick, clamp(Value * (90 - abs(get_ival(Stick))) / 90 + get_ival(Stick), -110, 100));
  return;
}

//=============================================== 
//                 ASC_PRO_MOD                    
//=============================================== 
combo ASC { // Professional Slide Cancel.         
    wait(14); // If this becomes an issue, change it to 12 or 15. Worked fine here.
    set_val(BTN_CROUCH, 100);                                          
    wait(14); // If this becomes and issue, change to anything between 11-20. 
    set_val(BTN_CROUCH, 100);          
    set_val(BTN_JUMP, 100);          
    wait(12);                                     
    set_val(BTN_CROUCH, 0);            
    set_val(BTN_JUMP, 100);         
    wait(12);                                      
    set_val(BTN_JUMP, 0);             
}                                                   
//===============================================  
//                 ESC                             
//===============================================  
combo ASCE { //--- Easy Slide Cancel.              
    set_val(BTN_CROUCH, 100);          
    wait(380);                         
    set_val(BTN_CROUCH, 0);            
    wait(60);                          
    set_val(BTN_CROUCH, 100);          
    wait(50);                          
    set_val(BTN_CROUCH, 100);          
    set_val(BTN_JUMP, 100);           
    wait(60);                          
    set_val(BTN_CROUCH, 0);            
    set_val(BTN_JUMP, 100);          
    wait(10);                        
    set_val(BTN_JUMP, 0);         
}
//-- VM Speed
define VM_Default = 0;
function set_Virtual_Machine_Speed (f_speed){
    if     (f_speed == 0) vm_tctrl(-0);//10 ms Default
    else if(f_speed == 1) vm_tctrl(-2);// 8 ms
    else if(f_speed == 2) vm_tctrl(-4);// 6 ms
    else if(f_speed == 3) vm_tctrl(-6);// 4 ms
    else if(f_speed == 4) vm_tctrl(-8);// 2 ms
    else if(f_speed == 5) vm_tctrl(-9);// 1 ms
}
           
int second_weapon = TRUE;
int message_timeout;
int time_to_clear_screen;
function QT_MESSAGE_TIMEOUT (){     
	// Clear OLED Screen              
	cls_oled(0); // will clear oled   
	display_title  = FALSE;           
}                                  
                                      
                       
int exit_wait = 1500;
combo EXIT {     
	wait(exit_wait);     
	cls_oled(0);    
	ModMenu = FALSE;  
	ModEdit = FALSE;    
	display_EDIT = FALSE; 
	display_title = TRUE; 
	Run_Button_Configs();
}                      
int LED_OnOff;       
int rumble_tipe = RUMBLE_A;
       
//=============================================== 
//            LED BLINK                           
//=============================================== 
combo LED_BLINK {                                 
	colourled(LED_OnOff);                           
	wait(200);                                      
	colourled(ColorOFF);                            
	wait(100);                                      
	colourled(LED_OnOff);                           
	wait(200);                                      
	colourled(ColorOFF);                             
	wait(100);                                      
}                                                 
//=============================================== 
//            PROFILE VIBRATE 1 , 2 ,3                           
//=============================================== 
int profile_numbr;                                
combo PROFILES_VIBRATE_NOTIFY {                    
    if(profile_numbr >= 1) set_rumble(rumble_tipe, 100);
    wait(300);                                       
    reset_rumble();                                   
    wait(100);                                       
    if(profile_numbr > 1)set_rumble(rumble_tipe, 100);
    wait(300);                                       
    reset_rumble();                                  
    wait(100);                                       
    if(profile_numbr > 2)set_rumble(rumble_tipe, 100);
    wait(300);                                       
    reset_rumble();                                 
}
define PRIMARY_Profile   = 1;
define SECONDARY_Profile = 2;
function set_profile_notify(f_profile,rumbl_type){
    profile_numbr = f_profile;
    rumble_tipe   = rumbl_type;
    combo_run(PROFILES_VIBRATE_NOTIFY);
}

//=============================================== 
//                 VIBRATE SETUP                 
//=============================================== 
combo vibrate {                                   
	set_rumble(rumble_tipe, 100);                   
	wait(300);                                       
	reset_rumble();                                 
	wait(100);                                       
	set_rumble(rumble_tipe, 100);                   
	wait(300);                                       
	reset_rumble();                                 
}                                                 
//===============================================  
//                 RUMBLE_TIPE                     
//===============================================  
function set_rumble_tipe ( val) {                  
	if( val){ rumble_tipe = RUMBLE_A ; LED_OnOff = Green;}  
	else    { rumble_tipe = RUMBLE_B ; LED_OnOff = Red  ;} 
	combo_run(vibrate);                     
	combo_run(LED_BLINK);                   
}                                         
//===============================================  
//             DOUBLE CLICK 
//===============================================  
int b_dblclick;

function double_click (button) {                      
    if (b_dblclick) {                                 
        b_dblclick -=get_rtime();                                      
    }                                                 
    if (event_press(button) ) {
        if(b_dblclick){
            b_dblclick = 0;
            return TRUE;
        }else{
            b_dblclick = 300;
            return FALSE;
        }
    }                                                 
    return FALSE;                                        
}           

define ColorOFF  = 0;
define Blue      = 1;
define Red       = 2;
define Green     = 3;
define Pink      = 4;
define SkyBlue   = 5;
define Yellow    = 6;
define White     = 7;
                      
data(                 
  0,0,0, //0. ColorOFF
  2,0,0, //1. Blue     
  0,2,0, //2. Red      
  0,0,2, //3. Green    
  2,2,0, //4. Pink     
  2,0,2, //5. SkyBlue 
  0,2,2, //6. Yellow   
  2,2,2  //7. White    
); // end of data segment-------------- 
// COLOR LED function        
//-------------------------------------------------------------- 
                                       
int data_indx;
function colourled(color) {  
    for( data_indx = 0; data_indx < 3; data_indx++ ) {
        set_led(data_indx,duint8 ((color * 3) + data_indx));
    }
}

// Refresh OLED              
    int display_title = TRUE;
    int display_black;      
    int refresh_OLED;        
    int ModMenu;    
    int ModEdit;   
    int display_EDIT;   
    int EntireScript_OnOff = TRUE;// Kill Swith For Entire Script   
    int show_mesage_time; 
////////////////////////////////////// 
/////////////////////////////////////// 
int count_black;                      
int need_to_be_save;                 
int BlinckColor = 3;                 
int Col_ind;                         
//===============================================================
//   MODS COMBO SECTION
//===============================================================
int KS_drop_shot = TRUE; 
combo DROP_SHOT_cmb {                   
    set_val(BTN_CROUCH, 100); 
    wait(drop_shot_hold);  
    wait(drop_shot_rest); 
} 
int AntiRecoil_Y;
int AntiRecoil_X;



function SmartSens_func(f_val, f_axis) { 

    SmartSens = ( (f_val * ( 100 - abs( get_ival(f_axis) ) ) ) / 100); 

    return clamp(get_ival(f_axis) + SmartSens, -100, 100);    
}
///////////////////////////////



//////////////////////////////

function RemoveStickNoise() {

  if(isqrt(pow(abs(get_ival(PS4_LX)),2) + pow(abs(get_ival(PS4_LY)),2)) <= DeadZone) {
    set_val(PS4_LX,0);
    set_val(PS4_LY,0);
  }

  if(isqrt(pow(abs(get_ival(PS4_RX)),2) + pow(abs(get_ival(PS4_RY)),2)) <= DeadZone) {
    set_val(PS4_RX,0);
    set_val(PS4_RY,0);
  }
}
define FONT_STATS_INDEX_WIDTH    = 0; 
define FONT_STATS_INDEX_HEIGHT   = 1; 
define FONT_STATS_INDEX_MAXCHARS = 2; 
                                      
                                      
//////////////////////////////////////////////////////////////// 
function horizontal_center_offset(number_characters, font_size) { 
    return (128 - number_characters * FONT_STATS[font_size][FONT_STATS_INDEX_WIDTH]) / 2;
}             
              
const string EXIT_TXT1 = "SETTINGS";  
const string EXIT_TXT2 = "WAS SAVED"; 
                                     
////////////////////////////////////////////////////////////////////////////// 
///  SAVE  
function save_toggles () {  
                    
     set_pvar(SPVAR_1,USE_HAIR_TRIGGER); 
     set_pvar(SPVAR_2,rumble_onoff); 
     set_pvar(SPVAR_3,stick_noise_onoff); 
     set_pvar(SPVAR_4,dropshot_onoff); 
     set_pvar(SPVAR_5,holdbreath_onoff);
     set_pvar(SPVAR_6,BUTTON_LAYOUT);
     set_pvar(SPVAR_7,STICK_LAYOUT);
     set_pvar(SPVAR_8,DeadZone); 
     set_pvar(SPVAR_9,drop_shot_hold); 
     set_pvar(SPVAR_10,drop_shot_rest); 
     set_pvar(SPVAR_11,ToggleBattsStickyAim);
     set_pvar(SPVAR_12,AimAssistTime);
     set_pvar(SPVAR_13,AimAssistSize);
     set_pvar(SPVAR_14,AR_Groundloot);
     set_pvar(SPVAR_15,VerticalStrength);
     set_pvar(SPVAR_16,HorizontalStrength);
     set_pvar(SPVAR_17,AutoSlideCancelEasy);
     set_pvar(SPVAR_18,AutoSlideCancel);
     set_pvar(SPVAR_19,HeadShotAssist_onoff);
     set_pvar(SPVAR_20,HeadShotHoldTime);
     set_pvar(SPVAR_21,HeadShotStrength);
     set_pvar(SPVAR_22,Zen_Assist);
     set_pvar(SPVAR_23,polar_aasist_radius); 
     set_pvar(SPVAR_24,polar_aasist_steps); 
     
     set_pvar(SPVAR_25,antirecoil_start[PrimaryWeapon]); 
     set_pvar(SPVAR_26,antirecoil_end  [PrimaryWeapon]);
     set_pvar(SPVAR_27,antirecoil_time [PrimaryWeapon]);
     set_pvar(SPVAR_28,antirecoil_H_start [SecondWeapon]);
     set_pvar(SPVAR_29,antirecoil_H_end   [SecondWeapon]);
     set_pvar(SPVAR_30,antirecoil_H_time  [SecondWeapon]);
     
     set_pvar(SPVAR_31,ar_invert);
     set_pvar(SPVAR_32,progressive_ar_onoff);
     
     // TD Aim Assist
	set_pvar(SPVAR_33,ToggleTaylorAA   );
	set_pvar(SPVAR_34,ToggleAAType     );
	set_pvar(SPVAR_35,TaylorShapesv1   );
	set_pvar(SPVAR_36,BoostFirev1      );
	set_pvar(SPVAR_37,BoostReducer     );
	set_pvar(SPVAR_38,TaylorAssist     );
	set_pvar(SPVAR_39,ToggleAATypev2   );
	set_pvar(SPVAR_40,TaylorShapesv2   );
	set_pvar(SPVAR_41,ShapeDirection   );
	set_pvar(SPVAR_42,ToggleBoostFire  );
	set_pvar(SPVAR_43,BoostReducerv2   );
	set_pvar(SPVAR_44,TaylorTracking   );
	//TD  Adjustables
	set_pvar(SPVAR_45,SpeedAA12        );//   //0 This is adjustable value - 0 to 99 max
	set_pvar(SPVAR_46,RadiusAA12       );//20 //1 This is adjustable value - 0 to 99 max
	set_pvar(SPVAR_47,BoostSpeedv1     );//5  //2 This is a adjustable value for Boost speed if Boost On Fire Is enabled ( 0 - 40 max ) 
	set_pvar(SPVAR_48,BoostStrengthv1  );//10 //3 This is a adjustable vaue for boost strength if Boost On Fire Is enabled ( 0 - 40 max )
	set_pvar(SPVAR_49,TaylorPBoostStr  );//4; //4 Adjustable Value - 0 - 40 max ( Boost On Fire Strength ) 
	set_pvar(SPVAR_50,TaylorABoostSpd  );//2; //5 Adjustable Value - 0 - 40 max ( Boost On Fire Speed )
	set_pvar(SPVAR_51,AdsSpeed         );//12;//6 Adjustable Value - 0 - 99 max ( Ads Speed ) 
	set_pvar(SPVAR_52,TaylorAngle      );//12;//7 Adjustable Value - 0 - 99 max ( Speed ) 
	set_pvar(SPVAR_53,TaylorRadius     );//12;//8 Adjustable Value - 0 - 99 max ( Radius )
	set_pvar(SPVAR_54,TrackingSize     );//2;//9 Tracking Size  ( 0 - 8 max )
	set_pvar(SPVAR_55,TrackingSpeed    );//2;//10 Tracking Speed ( 0 - 8 max )
     
	if(ar_invert) invert = -1;
	else invert = 1;
     
    combo_run(EXIT);                  
      
}// end of save   
                    
combo MESSAGE {       
    wait(20);         
    save_toggles ();  
    cls_oled(0);      
    print(horizontal_center_offset(sizeof(EXIT_TXT1), OLED_FONT_MEDIUM ), 2, OLED_FONT_MEDIUM, 1, EXIT_TXT1[0]); 
    print(horizontal_center_offset(sizeof(EXIT_TXT2), OLED_FONT_MEDIUM ), 23, OLED_FONT_MEDIUM, 1, EXIT_TXT2[0]);
    exit_wait = 2000;     
}                        
function blinck ( var){  
	if(var){               
		BlinckColor = Green;
	}else{                 
		BlinckColor = Red;    
	}                       
	combo_run(BLINK_NOTIFY); 
}                           
                            
combo BLINK_NOTIFY {        
	colourled(BlinckColor);   
	wait(300);                 
	colourled(ColorOFF);        
	wait(100);                  
	colourled(BlinckColor);      
	wait(300);                   
	colourled(ColorOFF);          
}                                
int MOD_Color;
int blink_n ;
combo Blink_MOD_ON   {
    colourled(ColorOFF);   
    wait(500);                 
    colourled(ColorOFF);   
    wait(1000);
    blink_n +=1; 
    if( blink_n > 0)blink_n = 1; 
}                                
                                
                                
const uint8 FONT_STATS[][] = {  
    {  7, 10, 18 }, // Small    
    { 11, 18, 11 }, // Medium   
    { 16, 26,  7 }  // Large    
};                              
                                
function display_edit( f_val) {
    if( MOD_Call == MOD_Menu_1){
    	printf(center_x(Menu1_VariablesTxt(valName_idx), OLED_FONT_SMALL_WIDTH),2,OLED_FONT_SMALL,OLED_WHITE,VariablesMenu1Txt[valName_idx]); 
    }
    else if( MOD_Call == MOD_Menu_2){
    	printf(center_x(f_Menu2_VariablesTxt(adj_indx), OLED_FONT_SMALL_WIDTH),2,OLED_FONT_SMALL,OLED_WHITE,AdjustVarMenu2_str[adj_indx]); 
    }
    
    number_to_string(f_val, find_digits(f_val));     
} 
const string AdjustVarMenu2_str [] = {"Aim Assist Speed","Aim Assist Radius","Boost Speed 1","Boost Strangth 1","OnFire Strength","On Fire Speed","ADS Speed","TD Angle","TD Radius",
"Tracing Size","Tracing Speed",""};

function f_Menu2_VariablesTxt(f_idx){
	if (AdjustVarMenu2_str[f_idx + 1] != -1) 
		return AdjustVarMenu2_str[f_idx + 1] - AdjustVarMenu2_str[f_idx] - 1;
	return sizeof(AdjustVarMenu2_str) - AdjustVarMenu2_str[f_idx];		
}

const string VariablesMenu1Txt [] = {"Dead Zone Value","Drop Shot Hold","Drop Shot Rest","Aim Assist Time","Aim Assist Size","AnRecoil Vertical","AnRecoil Horizonl",
"HeadShot Strength","HeadShot WiteTime","Polar AAss Radius","Polar AAss Steps","AR Primary START","AR Primary END","AR Primary TIME","AR Prim H START",
"AR Prim H END","AR Prim H TIME","AR Second START","AR Secondary END","AR Secondary TIME","AR Sec H START","AR Sec H END","AR Sec H TIME",""};
function Menu1_VariablesTxt(f_idx){
	if (VariablesMenu1Txt[f_idx + 1] != -1) 
		return VariablesMenu1Txt[f_idx + 1] - VariablesMenu1Txt[f_idx] - 1;
	return sizeof(VariablesMenu1Txt) - VariablesMenu1Txt[f_idx];		
}
function f_go_forward (f_variable) {
    f_variable       +=1; 
    if( ModMenu == MOD_Menu_1){
    if(f_variable  > Min_Max_Options[modName_idx][1] )f_variable  = Min_Max_Options[modName_idx][1]; // max option
    	blinck( f_variable );
    }else{
    	if(f_variable  > Min_Max_Options_2[menu2_indx][1] )f_variable  = Min_Max_Options_2[menu2_indx][1];
    	
    	blinck( f_variable );
    }
    return f_variable;
}

function f_go_back (f_variable) {
    f_variable       -=1; 
    if( ModMenu == MOD_Menu_1){
	    if(f_variable  < Min_Max_Options[modName_idx][0] )f_variable  = Min_Max_Options[modName_idx][0]; 
	    	blinck( f_variable );
    }else{
    	if(f_variable  < Min_Max_Options_2[menu2_indx][0] )f_variable  = Min_Max_Options_2[menu2_indx][0];
    	
	   	 blinck( f_variable );
    }
    return f_variable;
}
// Variables for function number_to_string()  
int ssss;                            
int c_c_c,c_val; 

function number_to_string(f_val,f_digits) {                  
//=======================================================
//  number_to_string(value to convert, # of digits in value) 
//                                                           
//  Display Up to Max 16-bit Signed Integer (-32,768 to 32,767) 
//                                                      
//      Convert digits to ASCII                         
//      Add ASCII character to print buffer            
//      Print string centered X & Y on OLED             
//                                                       
//======================================================
    ssss = 1;  c_val = 10000;                            
                                                      
    if(f_val < 0) //--neg numbers                     
    {                                                 
         putc_oled(ssss,45);    //--add leading "-"      
         ssss += 1;                                      
         f_val = abs(f_val);                          
    }                                                 
                                                      
    for(c_c_c = 5; c_c_c >= 1; c_c_c--)                           
    {                                                 
        if(f_digits >= c_c_c)                             
        {                                             
            putc_oled(ssss,ASCII_NUM[f_val / c_val]);    
            f_val = f_val % c_val;                    
            ssss +=  1;                                  
            if(c_c_c == 4)                               
            {                                         
                putc_oled(ssss,44);   //--add ","        
                ssss += 1;                               
            }                                        
        }                                             
        c_val /= 10;                                  
    }                                                
    puts_oled(center_x(ssss - 1,OLED_FONT_MEDIUM_WIDTH),27,OLED_FONT_MEDIUM,ssss - 1,OLED_WHITE); // adjustable value centered in X 
}                                                     
int n_str_;                  
int horiz_X_center_sufix;    
                             
function print_number(f_val,f_digits ,print_s_x , print_s_y , f_font) { 
                                                      
    n_str_ = 1;  c_val = 10000;                       
                                                      
    if(f_val < 0) //--neg numbers                     
    {                                                 
         putc_oled(n_str_,45);    //--add leading "-" 
         n_str_ += 1;                                 
         f_val = abs(f_val);                          
                                                      
    }                                                 
                                                      
    for(c_c_c = 5; c_c_c >= 1; c_c_c--)                           
    {                                                 
        if(f_digits >= c_c_c)                             
        {                                              
            putc_oled(n_str_,ASCII_NUM[f_val / c_val]);
            f_val = f_val % c_val;                    
            n_str_ +=  1;                             
                                                      
        }                                             
        c_val /= 10;                                  
    }                                                 
    puts_oled(print_s_x,print_s_y,f_font,n_str_ - 1,OLED_WHITE); // adjustable value centered in X
}                                       
                                                      
const string EDIT_VALUE_TXT = "Hold LT/L2 +"; 
int f_incr1,f_incr2;
function edit_val( f_val, f_min, f_max ) {  // antirecoil = edit_val( 0 , antirecoil, 99  , 99  ) 
    line_oled(1,14,127,14,1,1);                                        
    // print the range values
    line_oled(1,48,127,48,1,1); 
    // print text 
    print( 2, 52, OLED_FONT_SMALL, 1, EDIT_VALUE_TXT[0] ); 
    // print Left/ Right arrow
    rect_oled(90, 50, 127, 60, OLED_WHITE , col_rec_left); // rectangle left (line 1)
	//rect_oled(100, 48, OLED_FONT_SMALL_WIDTH + 2, OLED_FONT_SMALL_HEIGHT + 2, OLED_WHITE, col_rec_right); // rectangle right (line 1)
	// print LEFT/RIGHT ARROW on the bottom
    putc_oled(1,LEFT_arrow); 
	puts_oled(91, 51, OLED_FONT_SMALL, 1, col_char_left); 	
	putc_oled(1,RIGHT_arrow); 
	puts_oled(101, 51, OLED_FONT_SMALL, 1, col_char_right);
	// print UP/DOWN ARROW
	putc_oled(1,UP_arrow); 
	puts_oled(111, 51, OLED_FONT_SMALL, 1, col_char_left); 	
	putc_oled(1,DOWN_arrow); 
	puts_oled(121, 51, OLED_FONT_SMALL, 1, col_char_right);
	
	//---- Edit was call from MENU 1
	
		
	if( MOD_Call == MOD_Menu_1){
		f_incr1 = IncrDecr[valName_idx][0];
    	f_incr2 = IncrDecr[valName_idx][1];
    	// if EDIT indx is on the First value - print DOWN ARROW
		if( OptRange[modName_idx][0] <= valName_idx && OptRange[modName_idx][1] > valName_idx){
			putc_oled(1,DOWN_arrow); 
			puts_oled(3, 37, OLED_FONT_SMALL, 1, col_char_right);
		}else{
			rect_oled(4, 36, OLED_FONT_SMALL_WIDTH + 2, OLED_FONT_SMALL_HEIGHT + 2, OLED_BLACK , col_char_left); // rectangle left (line 2)
		}
		// print right UP ARROW
		if( OptRange[modName_idx][0] < valName_idx && valName_idx <= OptRange[modName_idx][1]){
			putc_oled(1,UP_arrow); 
			puts_oled(121, 37, OLED_FONT_SMALL, 1, col_char_right);
		}else{
			rect_oled(120, 36, OLED_FONT_SMALL_WIDTH + 2, OLED_FONT_SMALL_HEIGHT + 2, OLED_BLACK , col_char_left); // rectangle left (line 2)
		}
	}else if( MOD_Call == MOD_Menu_2){
		f_incr1 = IncrDecr_2[adj_indx][0];
    	f_incr2 = IncrDecr_2[adj_indx][1];
    	// if EDIT indx is on the First value - print DOWN ARROW
		if( OptRange_2[menu2_indx][0] <= adj_indx && OptRange_2[menu2_indx][1] > adj_indx){
			putc_oled(1,DOWN_arrow); 
			puts_oled(3, 37, OLED_FONT_SMALL, 1, col_char_right);
		}else{
			rect_oled(4, 36, OLED_FONT_SMALL_WIDTH + 2, OLED_FONT_SMALL_HEIGHT + 2, OLED_BLACK , col_char_left); // rectangle left (line 2)
		}
		// print right UP ARROW
		if( OptRange_2[menu2_indx][0] < adj_indx && adj_indx <= OptRange_2[menu2_indx][1]){
			putc_oled(1,UP_arrow); 
			puts_oled(121, 37, OLED_FONT_SMALL, 1, col_char_right);
		}else{
			rect_oled(120, 36, OLED_FONT_SMALL_WIDTH + 2, OLED_FONT_SMALL_HEIGHT + 2, OLED_BLACK , col_char_left); // rectangle left (line 2)
		}
	}
    // on the left: min value                                          
    print_number(f_min ,find_digits(f_min) ,4 , 20 , OLED_FONT_SMALL); 
    // on the right: max value                                         
    print_number(f_max ,find_digits(f_max) ,97 , 20 , OLED_FONT_SMALL);
    
    
    
    // Increse RIGHT/decrease LEFT
    if(get_ival(BTN_AIM)){                  
		if(press_hold(PS4_RIGHT)){            
			f_val += f_incr1;                           
			if(f_val > f_max ) f_val = f_max;   
			display_EDIT = TRUE;                
		}                                     
		if(press_hold(PS4_LEFT)){             
			f_val -= f_incr1;                           
			if(f_val < f_min ) f_val = f_min;   
			display_EDIT = TRUE;                
		}                                     
		if(press_hold(PS4_UP)){               
			f_val += f_incr2;                         
			if(f_val > f_max ) f_val = f_max;   
			display_EDIT = TRUE;                
		}                                     
		if(press_hold(PS4_DOWN)){             
			f_val -= f_incr2;                         
			if(f_val < f_min ) f_val = f_min;   
			display_EDIT = TRUE;                
		}                                     
	}                                      
    return f_val;                        
}                                        
                                             
                                   
function press_hold(f_btn) {       
//  return TRUE - event_press()    
//- every 250ms when button is held 
	  return event_press(f_btn) || get_ival(f_btn) && get_ptime(f_btn) > 250 
	       && get_ptime(f_btn) % (get_rtime() * 8) == 0;
}               
                
function find_digits(f_num) {                         
//  find_digits(value)                                
//        return Number of Digits in Value Passed     
                                                      
    f_num = abs(f_num);                               
    if(f_num / 10000 > 0) return 5;                   
    if(f_num /  1000 > 0) return 4;                   
    if(f_num /   100 > 0) return 3;                   
    if(f_num /    10 > 0) return 2;                   
                          return 1;                  
}                                                     
///////////////////////////////////////////////
//  FUNCTIONS                                 
                                              
function center_x(f_chars,f_font) {           
//  center_x(number of chars,font size);     
//        return X for Centering String Horizontally 
                                                      
    return (OLED_WIDTH / 2) - ((f_chars * f_font) / 2); 
}                                                      
                                                       
function draw_rectangle()        
{
    rect_oled(0, 0,OLED_WIDTH,64,FALSE,1); 
    line_oled(1,12,127,12,1,1); 
    if( ModMenu == MOD_Menu_2){
    	rect_oled(1,12,3,14,1,1);// left Square
    	rect_oled(124,12,128,14,1,1);//right squar
    	
    	line_oled(2,25,127,25,1,1); 
    	
    	//line_oled(3,12,3,25,1,1);
    	//line_oled(124,12,124,25,1,1);
    }
    line_oled(1,48,127,48,1,1);  
}
const string ModOption_30_0 = "Disable"; 
const string ModOption_30_1 = "Circular"; 
const string ModOption_30_2 = "Tall Oval"; 
const string ModOption_30_3 = "Wide Oval"; 
const string ModOption_30_4 = "Spiral"; 
const string ModOption_30_5 = "Helix"; 

const string ModOption_56_0 = "Disabled"; 
const string ModOption_56_1 = "Mac 10"; 
const string ModOption_56_2 = "Kilo"; 
const string ModOption_56_3 = "Bullfrog"; 
const string ModOption_56_4 = "OTS"; 
const string ModOption_56_5 = "Amax"; 
define ShotModOptions = 31;
define FireModOptions =  9;
const string ModOption_31_0 = "Disable"; 
const string ModOption_31_1 = "Fire Only"; 
const string ModOption_31_2 = "ADS & Fire"; 
const string ModOption_31_3 = "ADS Only"; 
const string ModOption_31_4 = "On Fire"; 

const string ModOption_81_0 =	"DEFAULT";          // 0
const string ModOption_81_1 =	"TACTICAL";         // 1
const string ModOption_81_2 =	"LEFTY";            // 2
const string ModOption_81_3 =	"N0M4D/CHARLIE";    // 3
const string ModOption_81_4 =	"NOM4D/CH TACTICAL";// 4
const string ModOption_81_5 =	"NOM4D/CHARL L3F7Y";// 5
const string ModOption_81_6 =	"BUMPER JUMPER";    // 6
const string ModOption_81_7 =	"BUMP/JUM TACTICAL";// 7
const string ModOption_81_8 =	"ONE-HAND GUNSLING";// 8
const string ModOption_81_9 =	"STICK AND MOVE";   // 9
const string ModOption_81_10 =	"BRAWLER";          // 10
const string ModOption_81_11 =	"BEAST";            // 81
const string ModOption_81_12 =	"DEFAULT SWAPPED";  // 82
const string ModOption_81_13 =	"BUMP/J SWAPPED";   // 13 
const string ModOption_81_14 =	"BUMP/J TACT SWAPP";// 14
const string ModOption_81_15 =	"STICK & MOVE SWAP";// 15
const string ModOption_81_16 =	"TACTICAL SWAPPED"  // 16

const string ModOption_82_0 =	"DEFAULT";          // 0
const string ModOption_82_1 =	"SOUTHPAW";         // 1
const string ModOption_82_2 =	"LEGACY";           // 2
const string ModOption_82_3 =	"LEGACY SOUTHPAW";  // 3

const string ModOption_82_4 =	"SOUTHPAW";         // 4
const string ModOption_82_5 =	"NO CLICK SWAP";    // 5

const string ModOption_82_6 =	"LEGACY SOUTHPAW";  // 6
const string ModOption_82_7 =	"NO CLIC SWAP";     // 7


define SubMod     = 15;

define UP_arrow = 131; define DOWN_arrow = 132; define LEFT_arrow = 133; define RIGHT_arrow = 134; define TRIANGLE = 130; define Y = 89; define CROSS = 127; define A = 65;
int col_char_left; 
int col_char_right;
int col_rec_left = 1;
int col_rec_right = 1;

define Y_Arrow = 36;
const string NO_EDIT_VARIABLE =" No Adjustables";
const string PRESS_A_TO_EDIT  =" A/CROSS to Edit ";
const string MOD_LABEL        ="MOD:";
const string SLOT_LABEL       ="MSL:";
int slot_numb ;
int f_option;
define SINGLE_1   = 15;
define SINGLE_2   = 27;
define Menu_1_row_1 = 15;
define Menu_1_row_2 = 25;

int SINGLE     = 15;
int ROW_1      = 15;
int ROW_2      = 25;
// DISPLAY_MOD
function display_mod( f_toggle) { 
		
        // Display MOD_NAME
        if( ModMenu == MOD_Menu_1){
        	printf(center_x(MOD_Names_TXT(modName_idx), OLED_FONT_SMALL_WIDTH),2,OLED_FONT_SMALL,OLED_WHITE,MOD_Names[modName_idx]); 
        }
        else if( ModMenu == MOD_Menu_2){
        	rect_oled(1,1,127,12,1,1);
        	printf(center_x(MOD_Names_TXT(modName_idx), OLED_FONT_SMALL_WIDTH),2,OLED_FONT_SMALL,OLED_BLACK,MOD_Names[modName_idx]); 
        }
        // Debug 
        set_val(TRACE_6,f_toggle);
        
        if( ModMenu == MOD_Menu_1){
	        // display MOD : label with MOD number
	        print( 2,38,OLED_FONT_SMALL, OLED_WHITE, MOD_LABEL[0]); 
	        print_number(modName_idx + 1 ,find_digits(modName_idx + 1) ,28 , 38 , OLED_FONT_SMALL);
	        
	        SINGLE = SINGLE_1;
	        ROW_1  = Menu_1_row_1;
	        ROW_2  = Menu_1_row_2;
	        
	        // display Slot ; label and slot number
	        print( 84,38,OLED_FONT_SMALL, OLED_WHITE, SLOT_LABEL[0]); 
	        print_number(slot_numb ,find_digits(slot_numb) ,112 , 38 , OLED_FONT_SMALL); 
	        
	        // display Up / Down for scroll MODs
	        // Clears/fill rectangle
			rect_oled(55, Y_Arrow, OLED_FONT_SMALL_WIDTH + 2, OLED_FONT_SMALL_HEIGHT + 2, OLED_WHITE , col_rec_left); // rectangle left (line 2)
			rect_oled(63, Y_Arrow, OLED_FONT_SMALL_WIDTH + 2, OLED_FONT_SMALL_HEIGHT + 2, OLED_WHITE, col_rec_right); //  rectangle right (line 2)
			
	        putc_oled(1,DOWN_arrow); 
			puts_oled(56, 37, OLED_FONT_SMALL, 1, col_char_left); 	
			putc_oled(1,UP_arrow); 
			puts_oled(64, 37, OLED_FONT_SMALL, 1, col_char_right);
            f_option = Options[modName_idx];
			if(EditVal[ modName_idx ] == 0 ){ 
				print( 2, 52, OLED_FONT_SMALL, 1, NO_EDIT_VARIABLE[0] ); 
			}else{
				print( 2, 52, OLED_FONT_SMALL, 1, PRESS_A_TO_EDIT[0] ); 
			}
		}
		else if( ModMenu == MOD_Menu_2){
		    SINGLE = SINGLE_2;
		    
			f_option = Options_2[menu2_indx];
			printf(center_x(TD_SubModTXT(menu2_indx), OLED_FONT_SMALL_WIDTH),SubMod,OLED_FONT_SMALL,OLED_WHITE,TD_SubMODTxt[menu2_indx]); 
			if(EditVal_2[ menu2_indx ] == 0 ){ 
				print( 2, 52, OLED_FONT_SMALL, 1, NO_EDIT_VARIABLE[0] ); 
			}else{
				print( 2, 52, OLED_FONT_SMALL, 1, PRESS_A_TO_EDIT[0] ); 
			}
		}
		//==================================================
		// DISPLAY OPTIONS
        if(f_option == 1)                              
        {                                                     
        // Display Disable / Enable                                 
            if(f_toggle == 1)                                                             
                print(center_x(sizeof(ON)  - 1, OLED_FONT_SMALL_WIDTH),SINGLE,OLED_FONT_SMALL,OLED_WHITE, ON[0]);// Enable 
            else                                                                                               
                print(center_x(sizeof(OFF) - 1, OLED_FONT_SMALL_WIDTH),SINGLE,OLED_FONT_SMALL,OLED_WHITE,OFF[0]);// Disable 
        } 
        if(f_option == 81)                              
        {                                                     
        // Display Disable / Enable               // Display Disable / Enable                                 
            if(f_toggle == 0)                                                             
                print(center_x(sizeof(ModOption_81_0)  - 1, OLED_FONT_SMALL_WIDTH),SINGLE,OLED_FONT_SMALL,OLED_WHITE, ModOption_81_0[0]);// Disable
            if(f_toggle == 1)                                                             
                print(center_x(sizeof(ModOption_81_1)  - 1, OLED_FONT_SMALL_WIDTH),SINGLE,OLED_FONT_SMALL,OLED_WHITE, ModOption_81_1[0]);//
            if(f_toggle == 2)                                                             
                print(center_x(sizeof(ModOption_81_2)  - 1, OLED_FONT_SMALL_WIDTH),SINGLE,OLED_FONT_SMALL,OLED_WHITE, ModOption_81_2[0]);//
            if(f_toggle == 3)                                                             
                print(center_x(sizeof(ModOption_81_3)  - 1, OLED_FONT_SMALL_WIDTH),SINGLE,OLED_FONT_SMALL,OLED_WHITE, ModOption_81_3[0]);//    
            if(f_toggle == 4)                                                             
                print(center_x(sizeof(ModOption_81_4)  - 1, OLED_FONT_SMALL_WIDTH),SINGLE,OLED_FONT_SMALL,OLED_WHITE, ModOption_81_4[0]);//    
            if(f_toggle == 5)                                                             
                print(center_x(sizeof(ModOption_81_5)  - 1, OLED_FONT_SMALL_WIDTH),SINGLE,OLED_FONT_SMALL,OLED_WHITE, ModOption_81_5[0]);//
            if(f_toggle == 6)                                                             
                print(center_x(sizeof(ModOption_81_6)  - 1, OLED_FONT_SMALL_WIDTH),SINGLE,OLED_FONT_SMALL,OLED_WHITE, ModOption_81_6[0]);//    
            if(f_toggle == 7)                                                             
                print(center_x(sizeof(ModOption_81_7)  - 1, OLED_FONT_SMALL_WIDTH),SINGLE,OLED_FONT_SMALL,OLED_WHITE, ModOption_81_7[0]);//    
            if(f_toggle == 8)                                                             
                print(center_x(sizeof(ModOption_81_8)  - 1, OLED_FONT_SMALL_WIDTH),SINGLE,OLED_FONT_SMALL,OLED_WHITE, ModOption_81_8[0]);//    
            if(f_toggle == 9)                                                             
                print(center_x(sizeof(ModOption_81_9)  - 1, OLED_FONT_SMALL_WIDTH),SINGLE,OLED_FONT_SMALL,OLED_WHITE, ModOption_81_9[0]);//
            if(f_toggle == 10)                                                             
                print(center_x(sizeof(ModOption_81_10)  - 1, OLED_FONT_SMALL_WIDTH),SINGLE,OLED_FONT_SMALL,OLED_WHITE, ModOption_81_10[0]);//    
            if(f_toggle == 11)                                                             
                print(center_x(sizeof(ModOption_81_11)  - 1, OLED_FONT_SMALL_WIDTH),SINGLE,OLED_FONT_SMALL,OLED_WHITE, ModOption_81_11[0]);//    
            if(f_toggle == 12)                                                             
                print(center_x(sizeof(ModOption_81_12)  - 1, OLED_FONT_SMALL_WIDTH),SINGLE,OLED_FONT_SMALL,OLED_WHITE, ModOption_81_12[0]);//   
            if(f_toggle == 13)                                                             
                print(center_x(sizeof(ModOption_81_13)  - 1, OLED_FONT_SMALL_WIDTH),SINGLE,OLED_FONT_SMALL,OLED_WHITE, ModOption_81_13[0]);//    
            if(f_toggle == 14)                                                             
                print(center_x(sizeof(ModOption_81_14)  - 1, OLED_FONT_SMALL_WIDTH),SINGLE,OLED_FONT_SMALL,OLED_WHITE, ModOption_81_14[0]);//    
            if(f_toggle == 15)                                                             
                print(center_x(sizeof(ModOption_81_15)  - 1, OLED_FONT_SMALL_WIDTH),SINGLE,OLED_FONT_SMALL,OLED_WHITE, ModOption_81_15[0]);//    
            if(f_toggle == 16)                                                             
                print(center_x(sizeof(ModOption_81_16)  - 1, OLED_FONT_SMALL_WIDTH),SINGLE,OLED_FONT_SMALL,OLED_WHITE, ModOption_81_16[0]);//    
        } 
        if(f_option == 82)                              
        {  
        	if(f_toggle == 0)                                                             
                print(center_x(sizeof(ModOption_82_0)  - 1, OLED_FONT_SMALL_WIDTH),SINGLE,OLED_FONT_SMALL,OLED_WHITE, ModOption_82_0[0]);// Disable
            if(f_toggle == 1)                                                             
                print(center_x(sizeof(ModOption_82_1)  - 1, OLED_FONT_SMALL_WIDTH),SINGLE,OLED_FONT_SMALL,OLED_WHITE, ModOption_82_1[0]);//
            if(f_toggle == 2)                                                             
                print(center_x(sizeof(ModOption_82_2)  - 1, OLED_FONT_SMALL_WIDTH),SINGLE,OLED_FONT_SMALL,OLED_WHITE, ModOption_82_2[0]);//
            if(f_toggle == 3)                                                             
                print(center_x(sizeof(ModOption_82_3)  - 1, OLED_FONT_SMALL_WIDTH),SINGLE,OLED_FONT_SMALL,OLED_WHITE, ModOption_82_3[0]);//    
            if(f_toggle == 4){                                                             
                print(center_x(sizeof(ModOption_82_4)  - 1, OLED_FONT_SMALL_WIDTH),ROW_1,OLED_FONT_SMALL,OLED_WHITE, ModOption_82_4[0]);// 
                print(center_x(sizeof(ModOption_82_5)  - 1, OLED_FONT_SMALL_WIDTH),ROW_2,OLED_FONT_SMALL,OLED_WHITE, ModOption_82_5[0]);// 
            }
            if(f_toggle == 5){                                                             
                print(center_x(sizeof(ModOption_82_6)  - 1, OLED_FONT_SMALL_WIDTH),ROW_1,OLED_FONT_SMALL,OLED_WHITE, ModOption_82_6[0]);// 
                print(center_x(sizeof(ModOption_82_7)  - 1, OLED_FONT_SMALL_WIDTH),ROW_2,OLED_FONT_SMALL,OLED_WHITE, ModOption_82_7[0]);// 
            }
                
        }
        if(f_option == ShotModOptions)// 31    
        {                                                     
            if(f_toggle == 0)                                                             
                print(center_x(sizeof(ModOption_31_0)  - 1, OLED_FONT_SMALL_WIDTH),SINGLE,OLED_FONT_SMALL,OLED_WHITE, ModOption_31_0[0]);// Disable
                                                                                                                           
            if(f_toggle == 1)                                                             
                print(center_x(sizeof(ModOption_31_1)  - 1, OLED_FONT_SMALL_WIDTH),SINGLE,OLED_FONT_SMALL,OLED_WHITE, ModOption_31_1[0]);// Fire Only
                                                                                                                           
            if(f_toggle == 2)                                                             
                print(center_x(sizeof(ModOption_31_2)  - 1, OLED_FONT_SMALL_WIDTH),SINGLE,OLED_FONT_SMALL,OLED_WHITE, ModOption_31_2[0]);// ADS & Fire
                                                                                                                           
            if(f_toggle == 3)                                                             
                print(center_x(sizeof(ModOption_31_3)  - 1, OLED_FONT_SMALL_WIDTH),SINGLE,OLED_FONT_SMALL,OLED_WHITE, ModOption_31_3[0]);// ADS Only
                                                                                                                           
        }            
        if(f_option == FireModOptions)// 9 FireModOptions   
        {                                                     
            if(f_toggle == 0)                                                             
                print(center_x(sizeof(ModOption_31_0)  - 1, OLED_FONT_SMALL_WIDTH),SINGLE,OLED_FONT_SMALL,OLED_WHITE, ModOption_31_0[0]);// Disable
                                                                                                                           
            if(f_toggle == 1)                                                             
                print(center_x(sizeof(ModOption_31_1)  - 1, OLED_FONT_SMALL_WIDTH),SINGLE,OLED_FONT_SMALL,OLED_WHITE, ModOption_31_1[0]);// Fire Only
                                                                                                                           
            if(f_toggle == 2)                                                             
                print(center_x(sizeof(ModOption_31_2)  - 1, OLED_FONT_SMALL_WIDTH),SINGLE,OLED_FONT_SMALL,OLED_WHITE, ModOption_31_2[0]);// ADS & Fire
                                                                                                                 
            if(f_toggle == 3)                                                             
                print(center_x(sizeof(ModOption_31_4)  - 1, OLED_FONT_SMALL_WIDTH),SINGLE,OLED_FONT_SMALL,OLED_WHITE, ModOption_31_4[0]);// On Fire
                                                                                                                 
        }         
        if(f_option == 56)   
        {                                                     
            if(f_toggle == 0)                                                             
                print(center_x(sizeof(ModOption_56_0)  - 1, OLED_FONT_SMALL_WIDTH),SINGLE,OLED_FONT_SMALL,OLED_WHITE, ModOption_56_0[0]);// Disabled
                                                                                                                           
            if(f_toggle == 1)                                                             
                print(center_x(sizeof(ModOption_56_1)  - 1, OLED_FONT_SMALL_WIDTH),SINGLE,OLED_FONT_SMALL,OLED_WHITE, ModOption_56_1[0]);// Profile 1
                                                                                                                           
            if(f_toggle == 2)                                                             
                print(center_x(sizeof(ModOption_56_2)  - 1, OLED_FONT_SMALL_WIDTH),SINGLE,OLED_FONT_SMALL,OLED_WHITE, ModOption_56_2[0]);// Profile 2
                                                                                                                           
            if(f_toggle == 3)                                                             
                print(center_x(sizeof(ModOption_56_3)  - 1, OLED_FONT_SMALL_WIDTH),SINGLE,OLED_FONT_SMALL,OLED_WHITE, ModOption_56_3[0]);// Profile 3
                                                                                                                           
            if(f_toggle == 4)                                                             
                print(center_x(sizeof(ModOption_56_4)  - 1, OLED_FONT_SMALL_WIDTH),SINGLE,OLED_FONT_SMALL,OLED_WHITE, ModOption_56_4[0]);// Profile 4
                                                                                                                           
            if(f_toggle == 5)                                                             
                print(center_x(sizeof(ModOption_56_5)  - 1, OLED_FONT_SMALL_WIDTH),SINGLE,OLED_FONT_SMALL,OLED_WHITE, ModOption_56_5[0]);// Profile 5
                                                                                                                           
        }  
        if(f_option == 30)   
        {                                                     
            if(f_toggle == 0)                                                             
                print(center_x(sizeof(ModOption_30_0)  - 1, OLED_FONT_SMALL_WIDTH),SINGLE,OLED_FONT_SMALL,OLED_WHITE, ModOption_30_0[0]);// Disable
                                                                                                                           
            if(f_toggle == 1)                                                             
                print(center_x(sizeof(ModOption_30_1)  - 1, OLED_FONT_SMALL_WIDTH),SINGLE,OLED_FONT_SMALL,OLED_WHITE, ModOption_30_1[0]);// Circular
                                                                                                                           
            if(f_toggle == 2)                                                             
                print(center_x(sizeof(ModOption_30_2)  - 1, OLED_FONT_SMALL_WIDTH),SINGLE,OLED_FONT_SMALL,OLED_WHITE, ModOption_30_2[0]);// Tall Oval
                                                                                                                           
            if(f_toggle == 3)                                                             
                print(center_x(sizeof(ModOption_30_3)  - 1, OLED_FONT_SMALL_WIDTH),SINGLE,OLED_FONT_SMALL,OLED_WHITE, ModOption_30_3[0]);// Wide Oval
                                                                                                                           
            if(f_toggle == 4)                                                             
                print(center_x(sizeof(ModOption_30_4)  - 1, OLED_FONT_SMALL_WIDTH),SINGLE,OLED_FONT_SMALL,OLED_WHITE, ModOption_30_4[0]);// Spiral
                                                                                                                           
            if(f_toggle == 5)                                                             
                print(center_x(sizeof(ModOption_30_5)  - 1, OLED_FONT_SMALL_WIDTH),SINGLE,OLED_FONT_SMALL,OLED_WHITE, ModOption_30_5[0]);// Helix
                                                                                                                           
        }
        // ToggleTaylorAA  // 0 Toggle = 1 For Aim Assist v1 , Toggle 2 for Aim Assist V2 
        
        if(f_option == 7)
        {
        	printf(center_x(TD_AA_VersionTxt(f_toggle), OLED_FONT_SMALL_WIDTH),SINGLE,OLED_FONT_SMALL,OLED_WHITE,TD_AA_Version[f_toggle]); 
        }
        if(f_option == 8)
        {
        	printf(center_x(aimTypeTxt(f_toggle), OLED_FONT_SMALL_WIDTH),SINGLE,OLED_FONT_SMALL,OLED_WHITE,aimType[f_toggle]); 
        }
        if(f_option == 9)
        {
        	printf(center_x(f_TaylorShapesPolar(f_toggle), OLED_FONT_SMALL_WIDTH),SINGLE,OLED_FONT_SMALL,OLED_WHITE,TaylorShapesPolar[f_toggle]); 
        }
        if(f_option == 10)
        {
        	printf(center_x(f_AATypeV2_Txt(f_toggle), OLED_FONT_SMALL_WIDTH),SINGLE,OLED_FONT_SMALL,OLED_WHITE,AATypeV2_Txt[f_toggle]); 
        }
}//display mod end 
const string TD_SubMODTxt [] = {"AA Version","AA Type","AA Shapes","Boost Fire","Boost Reducer","TD Assist V2","AA Type 2","AA Shapes 2","Shape Direction","Boost Fire 2","Boost Reducer 2","TD Tracing",""};
const string TaylorShapesPolar[]= {"Circular","Tall Oval","Wide Oval","Spiral Oval","Spiral","Helix","Kitt","Vertical Flare","Tartan Flex","Jupiter","Bishop","Blade","Osclirate",""}; 
const string aimType[]= {"Disabled","Polar","Linear","Mixed",""};
const string TD_AA_Version[]={"DIsabled","Aim Assist V 1","Aim Assist V 2",""};
const string MOD_Names []= {"Hair Trigger","Contrller Rumbles","Remve Stick Noise","Drop Shot","Hold Breath","Button Layout","Stick Layout","Batts Sticky Aim","AR Gound Loot",
  "Auto Slide Easy","Auto Slide","Head Shot Assist","TD Polar A Assist","Progressive AntiR","Progr AR Inverted",""};
const string AATypeV2_Txt []={"Disabled","AA Version 4","AA Version 5","AA V.5+SpeedBoost","AA V.6",""};  

function f_AATypeV2_Txt(f_idx){
	if (AATypeV2_Txt[f_idx + 1] != -1) 
		return AATypeV2_Txt[f_idx + 1] - AATypeV2_Txt[f_idx] - 1;
	return sizeof(AATypeV2_Txt) - AATypeV2_Txt[f_idx];		
}

function MOD_Names_TXT(f_idx){
	if (MOD_Names[f_idx + 1] != -1) 
		return MOD_Names[f_idx + 1] - MOD_Names[f_idx] - 1;
	return sizeof(MOD_Names) - MOD_Names[f_idx];		
}
  
function TD_SubModTXT(f_idx){
	if (TD_SubMODTxt[f_idx + 1] != -1) 
		return TD_SubMODTxt[f_idx + 1] - TD_SubMODTxt[f_idx] - 1;
	return sizeof(TD_SubMODTxt) - TD_SubMODTxt[f_idx];		
}
function f_TaylorShapesPolar(f_idx){
	if (TaylorShapesPolar[f_idx + 1] != -1) 
		return TaylorShapesPolar[f_idx + 1] - TaylorShapesPolar[f_idx] - 1;
	return sizeof(TaylorShapesPolar) - TaylorShapesPolar[f_idx];		
}

function aimTypeTxt(f_idx){
	if (aimType[f_idx + 1] != -1) 
		return aimType[f_idx + 1] - aimType[f_idx] - 1;
	return sizeof(aimType) - aimType[f_idx];		
}

function TaylorShapesNames(f_idx){
	if (TaylorShapesPolar[f_idx + 1] != -1) 
		return TaylorShapesPolar[f_idx + 1] - TaylorShapesPolar[f_idx] - 1;
	return sizeof(TaylorShapesPolar) - TaylorShapesPolar[f_idx];		
}

function TD_AA_VersionTxt(f_idx){
	if (TD_AA_Version[f_idx + 1] != -1) 
		return TD_AA_Version[f_idx + 1] - TD_AA_Version[f_idx] - 1;
	return sizeof(TD_AA_Version) - TD_AA_Version[f_idx];		
}


/*     
======================================================
     Logo Picture : WARZONE
======================================================
*/                                                    
                               
 const int16 BOOT_LOGO[] = { 
128, 59,
    0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
    0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
    0x03FB,0x03F0,0xE1F9,0xCE7E,0x1F9F,0xB19F,0xB1DF,0x9F80,0x03FB,0x03F0,0xE1F8,0xCC7E,0x1F9F,0xB19F,0xB9DF,0x9F80,0x0303,0x0331,0xF060,0xFC60,0x1998,0x3198,0x3DD8,0x1800,0x0303,0x0331,0xB060,0x7860,0x1998,0x3B98,0x3FD8,0x1800,
    0x03F3,0x0331,0xB060,0x787E,0x1F9F,0x1B1F,0x3FD9,0x9F00,0x03F3,0x0333,0xB860,0x307E,0x1F1F,0x1B1F,0x3FD9,0x9F00,0x0303,0x0333,0xF860,0x3006,0x1B98,0x1B18,0x37D9,0x9800,0x0303,0x0333,0xF860,0x3006,0x1998,0x1F18,0x33D9,0x9800,
    0x0303,0xFBF3,0x1860,0x307E,0x199F,0x8E1F,0xB1DF,0x9F80,0x0303,0xFBF3,0x1860,0x307E,0x199F,0x8E1F,0xB1DF,0x9F80,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
    0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x001E,0x0000,0x0000,
    0x0000,0x0000,0x0000,0x0000,0x0000,0x0032,0x0000,0x0000,0x0000,0x0000,0x0000,0x7E3C,0x7C00,0x00C1,0x0000,0x7E00,0x0000,0x3800,0x0000,0x7E7E,0x7E00,0x0181,0x8000,0xC200,0x0000,0x2C00,0x0000,0x6066,0x6600,0x0200,0x8001,0x0200,
    0x0000,0x7700,0xF800,0x6066,0x6600,0x0200,0xE00F,0x0200,0x0001,0xC0F1,0x0E00,0x6066,0x6600,0x0400,0x2018,0x0300,0x0003,0x0001,0x01C0,0x6066,0x6600,0x0C00,0x19E0,0x0000,0x0004,0x000F,0x0020,0x6066,0x6600,0x1800,0x0E00,0x0100,
    0x000C,0x0002,0x0020,0x6066,0x6600,0x6000,0x0400,0x0180,0x0018,0x0006,0x0010,0x7E7E,0x7E00,0xC000,0x0200,0x0080,0x0060,0x000C,0x0010,0x7E3C,0x7C00,0x8000,0x0300,0x0080,0x00C0,0x001C,0x0008,0x0000,0x0002,0x0000,0x0100,0x0080,
    0x0780,0x0018,0x0006,0x0000,0x000C,0x0000,0x0100,0x00C0,0x1980,0x0000,0x0007,0xE000,0x1BB8,0x0000,0x0000,0x0040,0x1100,0x0000,0x0000,0x3FFF,0xB000,0x0000,0x0000,0x0040,0x1300,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0040,
    0x2200,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0020,0x2201,0xE3E1,0xE1FC,0x1FE0,0xFFE1,0xFC3F,0x1F3F,0xF020,0x6201,0xE3E1,0xE1FC,0x1FF8,0xFFE3,0xFE3F,0x1F3F,0xF020,0x4401,0xE3E1,0xE1FC,0x1FFC,0xFFE7,0xFF3F,0x9F3F,0xF020,
    0x4401,0xE3E1,0xE3FE,0x1FFC,0xFFE7,0xFF3F,0x9F3F,0xF010,0xC401,0xF3F3,0xE3FE,0x1E3C,0xFFE7,0x8FBF,0x9F3C,0x0010,0x8400,0xF3F3,0xC3DE,0x1E3C,0x03E7,0x8FBF,0xDF3C,0x0010,0x1800,0xF773,0xC3DE,0x1E3C,0x07E7,0x8FBF,0xDF3C,0x000C,
    0x1800,0xF773,0xC7DF,0x1E3C,0x0FC7,0x8FBF,0xDF3F,0xE000,0x1000,0xF773,0xC79F,0x1FFC,0x1F87,0x8FBD,0xFF3F,0xE004,0x1000,0xF777,0xC79F,0x1FF8,0x3F07,0x8FBD,0xFF3F,0xE002,0x3000,0xF777,0x878F,0x1FFC,0x7E07,0x8FBD,0xFF3F,0xE002,
    0x3000,0xF73F,0x8FFF,0x9E3C,0xFC07,0x8FBC,0xFF3C,0x0002,0x6000,0x7F3F,0x8FFF,0x9E3C,0xF807,0x8FBC,0xFF3C,0x0002,0x4000,0x7F3F,0x8FFF,0x9E3C,0xF007,0x8FBC,0xFF3C,0x0002,0x4000,0x7E3F,0x8F87,0x9E3C,0xFFE7,0xFF3C,0x7F3C,0x0003,
    0x0000,0x3E1F,0x1F87,0xDE3C,0xFFE7,0xFF3C,0x7F3F,0xF801,0x0000,0x3E1F,0x1F07,0xDE3C,0xFFE3,0xFF3C,0x7F1F,0xF801,0x0000,0x3E1F,0x1F07,0xDE3C,0xFFE1,0xFE3C,0x3F0F,0xF800
 
 } // picture 
/*     
======================================================
     DrawLogo(x, y, invert)                            
====================================================== 
*/                                                    
int logoX,logoX2,logoY, logoY2;                       
int logoBit,logoOffset,logoData;                      
                                                      
function DrawLogo(x, y, invert) {                     
    logoOffset = 2;                                    
    logoBit = 16;                                           
    for (logoY = 0; logoY < BOOT_LOGO[1]; logoY++) {         // Loop the Y axis 
        for (logoX = 0; logoX < BOOT_LOGO[0]; logoX++) {     // Loop the X axis 
            logoData = BOOT_LOGO[logoOffset]          
            logoX2 = x + logoX;                       
            logoY2 = y + logoY;                       
            if (logoX2 < 0 || logoX2 >= 128) {        
                logoX2 -= 128;                        
            }                                         
            if (logoY2 < 0 || logoY2 >= 64) {         
                logoY2 -= 64;                         
            }                                         
            if (test_bit(logoData, logoBit - 1)) {     
                pixel_oled(logoX2, logoY2, !invert);   
            }else{                                     
                pixel_oled(logoX2, logoY2, invert);    
            }                                            
            logoBit--;             // Decrement the bit flag, we are moving to the next bit 
            if (!logoBit) {     // Check if we have just handled the last bit  
                logoBit = 16;     // Reset the bit flag     
                logoOffset++;     // Move to the next value 
            }  
        }   
    }    
}     
// Constant bytes - Convert numbers array - ASCII_NUM[column number] 
    const int8 ASCII_NUM[] =                          
//      0  1  2  3  4  5  6  7  8  9  (column numbers)
      {48,49,50,51,52,53,54,55,56,57};                
const uint8 MenuButtons [] = {  
  PS4_LEFT ,  //0. Up
  PS4_RIGHT , //1. Down
  PS4_UP ,    //2. go back
  PS4_DOWN ,  //3. go forward
  PS4_CROSS , //4. enter in Edit Menu
  PS4_CIRCLE ,//5. exit  Menu
  PS4_OPTIONS ,//6. enter in  Menu
  PS4_L2       //7. hold ADS
};//--- End Menu Buttons  

int menu_btn_indx;
int MenuTimeOut;
define menu_time_active = 900000;
function CheckIfBtnIsPressed (){  
    for(menu_btn_indx = 0; menu_btn_indx < 8; menu_btn_indx++){
         if(event_press(MenuButtons[menu_btn_indx]) ){
             MenuTimeOut = menu_time_active;
         }
         if(get_ival(MenuButtons[menu_btn_indx])){
         	MenuTimeOut = menu_time_active;
         }
         
         if(MenuTimeOut){              
            MenuTimeOut -= get_rtime();
            if(MenuTimeOut <= 0 ){    
                combo_run(EXIT);
            }
        }
    }
}
const string AR_PRIM_SEC_    = "AR Prim/Sec";
const string AR_GROUNDLOOT_  = "AR GroundLo";
const string DROP_SHOT_      = "Drop Shot";
const string SCRIPT_ONOFF  = "SCRIPT WAS";   
function display_MOD_status(f_val,f_size,f_label){  
    if(!ModMenu && !ModEdit){                                           
        // Clear OLED Screen                          
        cls_oled(0); // will clear oled   
        print(f_size, 3, OLED_FONT_MEDIUM ,OLED_WHITE, f_label);   
        if( f_val ){
            print(center_x(sizeof(ON)  - 1, OLED_FONT_LARGE_WIDTH),37,OLED_FONT_LARGE,OLED_WHITE, ON[0]);//MOD is ON
        }
        else{
            print(center_x(sizeof(OFF) - 1, OLED_FONT_LARGE_WIDTH),37,OLED_FONT_LARGE,OLED_WHITE, OFF[0]);// MOD is OFF
        }    
        time_to_clear_screen = 1500; 
    } 
}
//===============================================================
//    BUTTON LAYOUT                                              
//===============================================================

define UP             = PS4_UP;
define RIGHT          = PS4_RIGHT;
define DOWN           = PS4_DOWN;
define LEFT           = PS4_LEFT;

int RY;
int BTN_FIRE,BTN_AIM,BTN_LETHAL,BTN_TACTICAL,BTN_JUMP,BTN_SWAP,BTN_RELOAD,BTN_CROUCH,BTN_MELEE,BTN_SPRINT,BTN_PING,walk,strafe,aim_x,aim_y;

function Run_Button_Configs(){
	
	BTN_FIRE     = ButtonLayout[BUTTON_LAYOUT][0];
	BTN_AIM      = ButtonLayout[BUTTON_LAYOUT][1];
	
	BTN_LETHAL   = ButtonLayout[BUTTON_LAYOUT][2];
	BTN_TACTICAL = ButtonLayout[BUTTON_LAYOUT][3];
	
	BTN_JUMP     = ButtonLayout[BUTTON_LAYOUT][4];
	BTN_CROUCH   = ButtonLayout[BUTTON_LAYOUT][5];
	BTN_MELEE    = ButtonLayout[BUTTON_LAYOUT][6];
	BTN_SPRINT   = ButtonLayout[BUTTON_LAYOUT][7];
	BTN_RELOAD   = ButtonLayout[BUTTON_LAYOUT][8];
	BTN_SWAP     = ButtonLayout[BUTTON_LAYOUT][9];
	BTN_PING     = ButtonLayout[BUTTON_LAYOUT][10];


	
	walk         = StickLayout[STICK_LAYOUT][0];
	strafe       = StickLayout[STICK_LAYOUT][1];
	aim_y        = StickLayout[STICK_LAYOUT][2];
	aim_x        = StickLayout[STICK_LAYOUT][3];}
	
const int16 StickLayout[][] = {            
	//Walk,       Strafe,  AimY,    AimX    
	{ XB1_LY,     XB1_LX, XB1_RY, XB1_RX },    // DEFAULT
	{ XB1_RY,     XB1_RX, XB1_LY, XB1_LX },    // SOUTHPAW
	{ XB1_LY,     XB1_RX, XB1_RY, XB1_LX },    // LEGACY
	{ XB1_RY,     XB1_LX, XB1_LY, XB1_RX },    // LEGACY SOUTHPAW
    { XB1_RY,     XB1_RX, XB1_LY, XB1_LX },    // SOUTHPAW NO CLICK SWAP
    { XB1_RY,     XB1_LX, XB1_LY, XB1_RX }};   // LEGACY SOUTHPAW NO CLICK SWAP

const uint8 ButtonLayout[][] = {            
//    Fire     Ads    Lethal Tactical Jump    Crouch  Melee   Sprint  Reload WSwap,  Ping     
    { XB1_RT, XB1_LT, XB1_RB, XB1_LB, XB1_A,  XB1_B,  XB1_RS, XB1_LS ,XB1_X, XB1_Y, XB1_UP }, // DEFAULT = 0
    { XB1_RT, XB1_LT, XB1_RB, XB1_LB, XB1_A,  XB1_RS, XB1_B,  XB1_LS ,XB1_X, XB1_Y, XB1_UP }, // TACTICAL = 1
    { XB1_LT, XB1_RT, XB1_LB, XB1_RB, XB1_A,  XB1_B,  XB1_LS, XB1_RS ,XB1_X, XB1_Y, XB1_UP }, // LEFTY = 2
    { XB1_RT, XB1_RB, XB1_LT, XB1_LB, XB1_A,  XB1_B,  XB1_RS, XB1_LS ,XB1_X, XB1_Y, XB1_UP }, // N0M4D/CHARLIE = 3
    { XB1_RT, XB1_RB, XB1_LT, XB1_LB, XB1_A,  XB1_RS, XB1_B,  XB1_LS ,XB1_X, XB1_Y, XB1_UP }, // N0M4D/CHARLIE TACTICAL = 4
    { XB1_LT, XB1_LB, XB1_RT, XB1_RB, XB1_A,  XB1_B,  XB1_LS, XB1_RS ,XB1_X, XB1_Y, XB1_UP }, // N0M4D/CHARLIE LEFTY = 5
    { XB1_RT, XB1_LT, XB1_RB, XB1_A,  XB1_LB, XB1_B,  XB1_RS, XB1_LS ,XB1_X, XB1_Y, XB1_UP }, // BUMPER JUMPER = 6 
    { XB1_RT, XB1_LT, XB1_RB, XB1_A,  XB1_LB, XB1_RS, XB1_B,  XB1_LS ,XB1_X, XB1_Y, XB1_UP }, // BUMPER JUMPER TACTICAL = 7
    { XB1_LB, XB1_LT, XB1_RT, XB1_RB, XB1_A,  XB1_B,  XB1_RS, XB1_LS ,XB1_X, XB1_Y, XB1_UP }, // ONE-HAND GUNSLINGER = 8
    { XB1_RT, XB1_LT, XB1_RB, XB1_LB, XB1_RS, XB1_B,  XB1_A,  XB1_LS ,XB1_X, XB1_Y, XB1_UP }, // STICK AND MOVE = 9
    { XB1_RT, XB1_LT, XB1_RB, XB1_LB, XB1_A,  XB1_B,  XB1_RS, XB1_LS ,XB1_X, XB1_Y, XB1_UP }, // BRAWLER = 10
    { XB1_RT, XB1_LT, XB1_RS, XB1_A,  XB1_LB, XB1_B,  XB1_RB, XB1_LS ,XB1_X, XB1_Y, XB1_UP }, // BEASTY = 11
    { XB1_RT, XB1_LT, XB1_RB, XB1_RB, XB1_A,  XB1_B,  XB1_RS, XB1_LS ,XB1_X, XB1_Y, XB1_LB }, // BUMPER PING = 12
    { XB1_RT, XB1_LT, XB1_RB, XB1_RB, XB1_A,  XB1_RS, XB1_B,  XB1_LS ,XB1_X, XB1_Y, XB1_LB }, // BUMPER PING TACTICAL = 13
    { XB1_RB, XB1_LB, XB1_RT, XB1_LT, XB1_A,  XB1_B,  XB1_RS, XB1_LS ,XB1_X, XB1_Y, XB1_UP }, // DEFAULT FLIPPED = 14
    { XB1_RB, XB1_LB, XB1_RT, XB1_LT, XB1_A,  XB1_RS, XB1_B,  XB1_LS ,XB1_X, XB1_Y, XB1_UP }, // TACTICAL FLIPPED = 15
    { XB1_LB, XB1_RB, XB1_LT, XB1_RT, XB1_A,  XB1_B,  XB1_LS, XB1_RS ,XB1_X, XB1_Y, XB1_UP }, // LEFTY FLIPPED = 16
    { XB1_RB, XB1_RT, XB1_LB, XB1_LT, XB1_A,  XB1_B,  XB1_RS, XB1_LS ,XB1_X, XB1_Y, XB1_UP }, // N0M4D/CHARLIE FLIPPED = 17
    { XB1_RB, XB1_RT, XB1_LB, XB1_LT, XB1_A,  XB1_RS, XB1_B,  XB1_LS ,XB1_X, XB1_Y, XB1_UP }, // N0M4D/CHARLIE TACTICAL FLIPPED = 18
    { XB1_LB, XB1_LT, XB1_RB, XB1_RT, XB1_A,  XB1_B,  XB1_LS, XB1_RS ,XB1_X, XB1_Y, XB1_UP }, // N0M4D/CHARLIE LEFTY FLIPPED = 19  
    { XB1_RB, XB1_LB, XB1_RT, XB1_A,  XB1_LT, XB1_B,  XB1_RS, XB1_LS ,XB1_X, XB1_Y, XB1_UP }, // BUMPER JUMPER FLIPPED = 20   
    { XB1_RB, XB1_LB, XB1_RT, XB1_A,  XB1_LT, XB1_RS, XB1_B,  XB1_LS ,XB1_X, XB1_Y, XB1_UP }, // BUMPER JUMPER TACTICAL FLIPPED = 21 
    { XB1_LT, XB1_LB, XB1_RB, XB1_RT, XB1_A,  XB1_B,  XB1_RS, XB1_LS ,XB1_X, XB1_Y, XB1_UP }, // ONE-HAND GUNSLINGER FLIPPED = 22    
    { XB1_RB, XB1_LB, XB1_RT, XB1_LT, XB1_RS, XB1_B,  XB1_A,  XB1_LS ,XB1_X, XB1_Y, XB1_UP }, // STICK AND MOVE FLIPPED = 23 
    { XB1_RB, XB1_LB, XB1_RS, XB1_LT, XB1_A,  XB1_B,  XB1_RT, XB1_LS ,XB1_X, XB1_Y, XB1_UP }, // BRAWLER FLIPPED = 24  
    { XB1_RB, XB1_LB, XB1_RS, XB1_A,  XB1_LT, XB1_B,  XB1_RT, XB1_LS ,XB1_X, XB1_Y, XB1_UP }, // BEASTY FLIPPED = 25
    { XB1_RB, XB1_LB, XB1_RT, XB1_RT, XB1_A,  XB1_B,  XB1_RS, XB1_LS ,XB1_X, XB1_Y, XB1_LT }, // BUMPER PING FLIPPED = 26 
    { XB1_RB, XB1_LB, XB1_RT, XB1_RT, XB1_A,  XB1_RS, XB1_B,  XB1_LS ,XB1_X, XB1_Y, XB1_LT }};// BUMPER PING TACTICAL FLIPPED = 27 
	
/////===================================
// PROGRESSIVE AR
// Vertical
int i_val;
int i_pnt;
int i_num;
int i_cnt;
int v_par_,ar_y;
   
// Horizontal
int i_val_h;
int i_pnt_h;
int i_num_h;
int i_cnt_h;
int v_x,ar_x;

int invert;
function set_up_Progressive_AR (){
	// Vertical
    //--adding or subtracting
    if(antirecoil_start[second_weapon] < antirecoil_end[second_weapon])
        i_val = 1;
    else
        i_val = -1;
    //--iteration point for progression 
    i_pnt = (antirecoil_time[second_weapon] / 10) / (abs(antirecoil_start[second_weapon] - antirecoil_end[second_weapon]));
   
	// Horizontal
    //--adding or subtracting
    if(antirecoil_H_start[second_weapon] < antirecoil_H_end[second_weapon])
        i_val_h = 1;
    else
        i_val_h = -1;
    //--iteration point for progression 
    i_pnt_h = (antirecoil_H_time[second_weapon] / 10) / (abs(antirecoil_H_start[second_weapon] - antirecoil_H_end[second_weapon]));
}

// Vertical
function p_complete() { 
    i_cnt++;
    if (i_cnt > antirecoil_time[second_weapon] / 10) {
        //--avoid stack overflow
        i_cnt = antirecoil_time[second_weapon] / 10;
        //--progression complete
        return 1;
    }
    //--progression not complete
    return 0;
}        
function p_val() {
    i_num++;
    if(i_num == i_pnt) {
        //--reset counter
        i_num = 0;
        //--adjust ar_y 
        ar_y += i_val;
    }
    return ar_y;
} 
function y_val() {
    v_par_ = get_val(10);
    if(abs(v_par_) < 10)
        v_par_ = 0;
    if(abs(v_par_) > ar_y + 5)
        return v_par_;
    return v_par_ + (ar_y * invert);           
}

// Horizontal
function p_complete_x() { 
    i_cnt_h++;
    if (i_cnt_h > antirecoil_H_time[second_weapon] / 10) {
        //--avoid stack overflow
        i_cnt_h = antirecoil_H_time[second_weapon] / 10;
        //--progression complete
        return 1;
    }
    //--progression not complete
    return 0;
}        
function p_val_x() {
    i_num_h++;
    if(i_num_h == i_pnt_h) {
        //--reset counter
        i_num_h = 0;
        //--adjust ar_x 
        ar_x += i_val_h;
    }
    return ar_x;
} 
function x_val() {
    v_x = get_val(aim_x);
    if(abs(v_x) < 10)
        v_x = 0;
    if(abs(v_x) > abs(ar_x + 5))
        return v_x;
    return v_x + ar_x;           
} 