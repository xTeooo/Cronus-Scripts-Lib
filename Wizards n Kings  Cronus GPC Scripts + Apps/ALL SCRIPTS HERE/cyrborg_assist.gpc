								 	
const int16 Lookup_Table[] 		= {
									0, 	 17,  34,  52,  69,  87,  104, 121, 139, 156, 
									173, 190, 207, 224, 241, 258, 275, 292, 309, 325,
									342, 358, 374, 390, 406, 422, 438, 453, 469, 484,
									500, 515, 529, 544, 559, 573, 587, 601, 615, 629,
									642, 656, 669, 682, 694, 707, 719, 731, 743, 754,
									766, 777, 788, 798, 809, 819, 829, 838, 848, 857,
									866, 874, 882, 891, 898, 906, 913, 920, 927, 933, 
									939, 945, 951, 956, 961, 965, 970, 974, 978, 981,
									984, 987, 990, 992, 994, 996, 997, 998, 999, 999,
									1000
									};	
define TIME_BASE					= 4;	// don't change	
define MAX_DRIFT					= 12;	// don't change	if calculated drift is greater than 12, the controller is dead

define ADS_BUTTON					= PS4_L2;
define FIRE_BUTTON					= PS4_R2;
define CROUCH_BUTTON 				= PS4_CIRCLE;  
define JUMP_BUTTON  				= PS4_CROSS;
define SWAP_BUTTON					= PS4_TRIANGLE;
define MELEE_BUTTON					= PS4_R3;
define SPRINT_BUTTON				= PS4_L3;
define PING_BUTTON					= PS4_UP; 

int SEINVERTED						= 0; 	// 1 if you play inveted 

define BASIC       					= 0x00; 
define DYNAMIC						= 0x01;
define STEP_MODE 					= 0x02; 
define FAST_TRIG     				= 0x03;  
define SLOW_TRIG	 				= 0x04; 
define RANDOM	 					= 0x05; 

int USE_EVIL_BOT					= TRUE;

define CIRCULAR						= 1;
define OVAL							= 2;

define DISABLE_SPIRAL				= 0;
define LOW_SPIRAL					= 2;
define MID_SPIRAL					= 3;
define HIGH_SPIRAL					= 4;

define DISABLE_SCAN					= 0;
define LOW_SCAN						= 1;
define MID_SCAN						= 2;
define HIGH_SCAN					= 3;

define DISABLE_SREADY_AIM			= 0;
define LOW_SREADY_AIM				= 4;
define MID_SREADY_AIM				= 6;
define HIGH_SREADY_AIM				= 8;

int USE_SWEET_EVIL_AI					= TRUE; //ONLY ADVANCED USER!

int SWEET_EVIL_AI_THRESHOLD				= 30;

//Sensitivity settings
int ADS_SENS							= 100;
int ADS_FIRE_SENS						= 100;
int HIP_FIRE_SENS						= 100;
int CAMERA_SENS							= 100;

//ADS ONLY
int FRONTAL_ADS_EVIL_SLOPE				= 6;
int FRONTAL_ADS_EVIL_ASSIST				= 10;
int FRONTAL_ADS_EVIL_BOT_TYPE			= OVAL;
int FRONTAL_ADS_EVIL_SPIRAL				= DISABLE_SPIRAL;
int FRONTAL_ADS_EVIL_SCAN				= DISABLE_SCAN;
int FRONTAL_ADS_EVIL_STEADY_AIM			= DISABLE_SREADY_AIM;
   // range 25 to 300 less than 100 reduce sensitivity like negative boost

int DRIFT_ADS_EVIL_SLOPE				= 6;
int DRIFT_ADS_EVIL_ASSIST				= 10;
int DRIFT_ADS_EVIL_BOT_TYPE				= OVAL;
int DRIFT_ADS_EVIL_SPIRAL				= DISABLE_SPIRAL;
int DRIFT_ADS_EVIL_SCAN					= DISABLE_SCAN;
int DRIFT_ADS_EVIL_STEADY_AIM			= DISABLE_SREADY_AIM;

//ADS + FIRE
int FRONTAL_ADS_FIRE_EVIL_SLOPE			= 6;
int FRONTAL_ADS_FIRE_EVIL_ASSIST		= 20;
int FRONTAL_ADS_FIRE_EVIL_BOT_TYPE		= OVAL;
int FRONTAL_ADS_FIRE_EVIL_SPIRAL		= DISABLE_SPIRAL;
int FRONTAL_ADS_FIRE_EVIL_SCAN			= DISABLE_SCAN;
int FRONTAL_ADS_FIRE_EVIL_STEADY_AIM	= DISABLE_SREADY_AIM;

int DRIFT_ADS_FIRE_EVIL_SLOPE			= 6;
int DRIFT_ADS_FIRE_EVIL_ASSIST			= 20;
int DRIFT_ADS_FIRE_EVIL_BOT_TYPE		= OVAL;
int DRIFT_ADS_FIRE_EVIL_SPIRAL			= DISABLE_SPIRAL;
int DRIFT_ADS_FIRE_EVIL_SCAN			= DISABLE_SCAN;
int DRIFT_ADS_FIRE_EVIL_STEADY_AIM		= DISABLE_SREADY_AIM;


//HIP FIRE
int FRONTAL_HIP_FIRE_EVIL_SLOPE			= 6;
int FRONTAL_HIP_FIRE_EVIL_ASSIST		= 20;
int FRONTAL_HIP_FIRE_EVIL_BOT_TYPE		= OVAL;
int FRONTAL_HIP_FIRE_EVIL_SPIRAL		= DISABLE_SPIRAL;
int FRONTAL_HIP_FIRE_EVIL_SCAN			= DISABLE_SCAN;
int FRONTAL_HIP_FIRE_EVIL_STEADY_AIM	= DISABLE_SREADY_AIM;


int DRIFT_HIP_FIRE_EVIL_SLOPE			= 6;
int DRIFT_HIP_FIRE_EVIL_ASSIST			= 20;
int DRIFT_HIP_FIRE_EVIL_BOT_TYPE		= OVAL;
int DRIFT_HIP_FIRE_EVIL_SPIRAL			= DISABLE_SPIRAL;
int DRIFT_HIP_FIRE_EVIL_SCAN			= DISABLE_SCAN;
int DRIFT_HIP_FIRE_EVIL_STEADY_AIM		= DISABLE_SREADY_AIM;

int	EVIL_SLOPE;
int	EVIL_ASSIST;
int EVIL_BOT_TYPE;
int EVIL_SPIRAL;
int EVIL_SCAN;
int EVIL_STEADY_AIM;
int EVIL_SENS;

define MAGNITUDE					= 80;			   // don't change tweak this when you have ar drift issue
int REFRESH_RATE					= TIME_BASE * 10;  // don't change			

int update_timer;
int C_RX;
int C_RY;
int C_LX;
int C_LY;
int L_RX;
int L_RY;
//int T_RX;
int T_RY;
int Inc_Dec_State_1;
int Inc_Dec_State_2;
int Aim_Assit_1;
int Aim_Assit_2;
int SEangle;
int _ret;
//int _temp;
int mvt_direction;
//int magnitude_ok;
int min_aim_assit;
int cw_angle;
int SEinverted;
int rx_drift;
int ry_drift;
int lx_drift;
int ly_drift;
int drift_calib;

int _scan_1;
int _scan_2;
int _EVIL_ASSIST_1;
int _EVIL_ASSIST_2;
int _EVIL_ASSIST_3;

define WALK   						 = 0;
define SPRINT 						 = 1;
define  timelimit 					= 304;

//#################################################################################################

init
{
	mvt_direction = 1;
	
	Inc_Dec_State_1 = TRUE;
	Inc_Dec_State_2 = FALSE;
	
    update_timer = REFRESH_RATE;
	
	if(SEINVERTED == 1)
		SEinverted = -1;
	else
		SEinverted = 1;
		
	SEangle = 90 * SEinverted;
	cw_angle = 90 * SEinverted;
			
	drift_calib = 100;
}


main {

	vm_tctrl(-6);

	if(drift_calib)
	{
		rx_drift = max(rx_drift, abs(get_ival(PS4_RX))+ 2);
		ry_drift = max(ry_drift, abs(get_ival(PS4_RY))+ 2);

		lx_drift = max(lx_drift, abs(get_ival(PS4_LX))+ 2);
		ly_drift = max(ly_drift, abs(get_ival(PS4_LY))+ 2);

		rx_drift = min(rx_drift, MAX_DRIFT);
		ry_drift = min(ry_drift, MAX_DRIFT);

		lx_drift = min(lx_drift, MAX_DRIFT);
		ly_drift = min(ly_drift, MAX_DRIFT);

		drift_calib--;

		rx_drift = max(rx_drift, ry_drift);
		lx_drift = max(lx_drift, ly_drift);
	}
	else
	{

		C_RX = get_ival(PS4_RX);
		C_RY = get_ival(PS4_RY);

		C_LX = get_ival(PS4_LX);
		C_LY = get_ival(PS4_LY);

		if(isqrt(pow(C_RX, 2) + pow(C_RY, 2)) <= rx_drift)
		{
			C_RX = 0;
			C_RY = 0;
		}

		if(isqrt(pow(C_LX, 2) + pow(C_LY, 2)) <= lx_drift)
		{
			C_LX = 0;
			C_LY = 0;
		}

		set_val(PS4_LX, C_LX);
		set_val(PS4_LY, C_LY);

		if((get_val(ADS_BUTTON) > 50 || get_val(FIRE_BUTTON) > 50))
		{

			if(USE_SWEET_EVIL_AI == TRUE)
			{
				_ret = isqrt(pow(C_RX, 2) + pow(C_RY, 2));

				if(get_ival(ADS_BUTTON) && !get_ival(FIRE_BUTTON) && _ret <= SWEET_EVIL_AI_THRESHOLD)
				{
					EVIL_SLOPE = FRONTAL_ADS_EVIL_SLOPE;
					EVIL_ASSIST = FRONTAL_ADS_EVIL_ASSIST;
					EVIL_BOT_TYPE = FRONTAL_ADS_EVIL_BOT_TYPE;
					EVIL_SPIRAL = FRONTAL_ADS_EVIL_SPIRAL;
					EVIL_SCAN = FRONTAL_ADS_EVIL_SCAN;
					EVIL_STEADY_AIM = FRONTAL_ADS_EVIL_STEADY_AIM;
					EVIL_SENS = ADS_SENS;
				}
				else if(get_ival(ADS_BUTTON) && !get_ival(FIRE_BUTTON) && _ret > SWEET_EVIL_AI_THRESHOLD)
				{
					EVIL_SLOPE = DRIFT_ADS_EVIL_SLOPE;
					EVIL_ASSIST = DRIFT_ADS_EVIL_ASSIST;
					EVIL_BOT_TYPE = DRIFT_ADS_EVIL_BOT_TYPE;
					EVIL_SPIRAL = DRIFT_ADS_EVIL_SPIRAL;
					EVIL_SCAN = DRIFT_ADS_EVIL_SCAN;
					EVIL_STEADY_AIM = DRIFT_ADS_EVIL_STEADY_AIM;
					EVIL_SENS = ADS_SENS;
				}
				else if(get_ival(ADS_BUTTON) && get_ival(FIRE_BUTTON) && _ret <= SWEET_EVIL_AI_THRESHOLD)
				{
					EVIL_SLOPE = FRONTAL_ADS_FIRE_EVIL_SLOPE;
					EVIL_ASSIST = FRONTAL_ADS_FIRE_EVIL_ASSIST;
					EVIL_BOT_TYPE = FRONTAL_ADS_FIRE_EVIL_BOT_TYPE;
					EVIL_SPIRAL = FRONTAL_ADS_FIRE_EVIL_SPIRAL;
					EVIL_SCAN = FRONTAL_ADS_FIRE_EVIL_SCAN;
					EVIL_STEADY_AIM = FRONTAL_ADS_FIRE_EVIL_STEADY_AIM;
					EVIL_SENS = ADS_FIRE_SENS;
				}
				else if(get_ival(ADS_BUTTON) && get_ival(FIRE_BUTTON) && _ret > SWEET_EVIL_AI_THRESHOLD)
				{
					EVIL_SLOPE = DRIFT_ADS_FIRE_EVIL_SLOPE;
					EVIL_ASSIST = DRIFT_ADS_FIRE_EVIL_ASSIST;
					EVIL_BOT_TYPE = DRIFT_ADS_FIRE_EVIL_BOT_TYPE;
					EVIL_SPIRAL = DRIFT_ADS_FIRE_EVIL_SPIRAL;
					EVIL_SCAN = DRIFT_ADS_FIRE_EVIL_SCAN;
					EVIL_STEADY_AIM = DRIFT_ADS_FIRE_EVIL_STEADY_AIM;
					EVIL_SENS = ADS_FIRE_SENS;
				}
				else if(!get_ival(ADS_BUTTON) && get_ival(FIRE_BUTTON) && _ret <= SWEET_EVIL_AI_THRESHOLD)
				{
					EVIL_SLOPE = FRONTAL_HIP_FIRE_EVIL_SLOPE;
					EVIL_ASSIST = FRONTAL_HIP_FIRE_EVIL_ASSIST;
					EVIL_BOT_TYPE = FRONTAL_HIP_FIRE_EVIL_BOT_TYPE;
					EVIL_SPIRAL = FRONTAL_HIP_FIRE_EVIL_SPIRAL;
					EVIL_SCAN = FRONTAL_HIP_FIRE_EVIL_SCAN;
					EVIL_STEADY_AIM = FRONTAL_HIP_FIRE_EVIL_STEADY_AIM;
					EVIL_SENS = HIP_FIRE_SENS;
				}
				else if(!get_ival(ADS_BUTTON) && get_ival(FIRE_BUTTON) && _ret > SWEET_EVIL_AI_THRESHOLD)
				{
					EVIL_SLOPE = DRIFT_HIP_FIRE_EVIL_SLOPE;
					EVIL_ASSIST = DRIFT_HIP_FIRE_EVIL_ASSIST;
					EVIL_BOT_TYPE = DRIFT_HIP_FIRE_EVIL_BOT_TYPE;
					EVIL_SPIRAL = DRIFT_HIP_FIRE_EVIL_SPIRAL;
					EVIL_SCAN = DRIFT_HIP_FIRE_EVIL_SCAN;
					EVIL_STEADY_AIM = DRIFT_HIP_FIRE_EVIL_STEADY_AIM;
					EVIL_SENS = HIP_FIRE_SENS;
				}

				sensitivity(PS4_RX, NOT_USE, EVIL_SENS);
				sensitivity(PS4_RY, NOT_USE, EVIL_SENS);

				if(EVIL_SPIRAL)
				{
					min_aim_assit = EVIL_ASSIST/EVIL_SPIRAL;

					if(min_aim_assit == 0 && Aim_Assit_2 == 0)
					{
						Aim_Assit_1 = min_aim_assit;
						Aim_Assit_2 = EVIL_ASSIST;
					}
				}
			}

			if(update_timer >= REFRESH_RATE)
			{
				block(PS4_RX, REFRESH_RATE);
				block(PS4_RY, REFRESH_RATE);

				_ret = get_mvt_direction(C_RX, L_RX);

				if(_ret != 0)
				mvt_direction = _ret;

				//set_val(TRACE_1, mvt_direction);

				if(USE_EVIL_BOT == TRUE)
				{
					if(Inc_Dec_State_1 == FALSE)
					{
						Aim_Assit_1 -= 1;

						if(Aim_Assit_1 < min_aim_assit)
						Inc_Dec_State_1 = TRUE;
					}
					else
					{
						Aim_Assit_1 += 1;

						if(Aim_Assit_1 > EVIL_ASSIST)
						Inc_Dec_State_1 = FALSE;
					}

					if(Inc_Dec_State_2 == FALSE)
					{
						Aim_Assit_2 -= 1;

						if(Aim_Assit_2 < min_aim_assit)
						Inc_Dec_State_2 = TRUE;
					}
					else
					{
						Aim_Assit_2 += 1;

						if(Aim_Assit_2 > EVIL_ASSIST)
						Inc_Dec_State_2 = FALSE;
					}
				}

				update_timer = 0;

				L_RX = C_RX;
				L_RY = C_RY;
			}

			if(USE_EVIL_BOT == TRUE)
			{

				if(EVIL_BOT_TYPE == CIRCULAR)
				{

					if(EVIL_SPIRAL)
					{
						_EVIL_ASSIST_1 = Aim_Assit_1;
						_EVIL_ASSIST_2 = Aim_Assit_2;
					}
					else
					{
						_EVIL_ASSIST_1 = EVIL_ASSIST;
						_EVIL_ASSIST_2 = EVIL_ASSIST;
					}

					if(EVIL_SCAN == TRUE)
					{
						_scan_1 = get_polar_coordinate(_EVIL_ASSIST_1/2, SEsin(cw_angle));
						_scan_2 = get_polar_coordinate(_EVIL_ASSIST_1/2, SEcos(cw_angle));
					}
					else
					{
						_scan_1 = 0;
						_scan_2 = 0;
					}

					if(mvt_direction == 1)
					{

						C_RX += get_polar_coordinate(_EVIL_ASSIST_1, SEsin(SEangle)) + _scan_1;
						C_RY += get_polar_coordinate(_EVIL_ASSIST_1, SEcos(SEangle)) + _scan_2;
					}
					else
					{
						C_RX += get_polar_coordinate(_EVIL_ASSIST_1, SEcos(SEangle)) + _scan_2;
						C_RY += get_polar_coordinate(_EVIL_ASSIST_1, SEsin(SEangle)) + _scan_1;
					}

				}
				else if(EVIL_BOT_TYPE == OVAL)
				{
					if(EVIL_SPIRAL)
					{
						_EVIL_ASSIST_1 = Aim_Assit_1;
						_EVIL_ASSIST_2 = Aim_Assit_2;
						_EVIL_ASSIST_3 = Aim_Assit_2;
					}
					else
					{
						_EVIL_ASSIST_1 = EVIL_ASSIST;
						_EVIL_ASSIST_2 = EVIL_ASSIST;
						_EVIL_ASSIST_3 = EVIL_ASSIST/2;
					}

					if(mvt_direction == 1)
					{

						if(EVIL_SCAN == TRUE)
						{
							_scan_1 = get_polar_coordinate(_EVIL_ASSIST_2/2, SEsin(cw_angle));
							_scan_2 = get_polar_coordinate(_EVIL_ASSIST_1/2, SEcos(cw_angle));
						}
						else
						{
							_scan_1 = 0;
							_scan_2 = 0;
						}

						C_RX += get_polar_coordinate(_EVIL_ASSIST_1, SEsin(SEangle)) + _scan_1;
						C_RY += get_polar_coordinate(_EVIL_ASSIST_3, SEcos(SEangle)) + _scan_2;
					}
					else
					{
						if(EVIL_SCAN == TRUE)
						{
							_scan_1 = get_polar_coordinate(_EVIL_ASSIST_2/2, SEcos(cw_angle));
							_scan_2 = get_polar_coordinate(_EVIL_ASSIST_1/2, SEsin(cw_angle));
						}
						else
						{
							_scan_1 = 0;
							_scan_2 = 0;
						}

						C_RX += get_polar_coordinate(_EVIL_ASSIST_1, SEcos(SEangle)) + _scan_1;
						C_RY += get_polar_coordinate(_EVIL_ASSIST_3, SEsin(SEangle)) + _scan_2;
					}
				}
			}

			SEangle += EVIL_SLOPE;
			SEangle = SEangle % 360;

			cw_angle = (cw_angle + EVIL_SCAN) % 360;

			set_val(PS4_RX, clamp(C_RX, -100, 100));
			set_val(PS4_RY, clamp(C_RY, -100, 100));

			update_timer += get_rtime();
		}
		else
		{
			update_timer = 0;
			update_timer = REFRESH_RATE;

			SEangle = 90 * SEinverted;
			cw_angle = 90 * SEinverted;

			Aim_Assit_1 = min_aim_assit;
			Aim_Assit_2 = EVIL_ASSIST;

			sensitivity(PS4_RX, NOT_USE, CAMERA_SENS);
			sensitivity(PS4_RY, NOT_USE, CAMERA_SENS);

			set_val(PS4_RX, C_RX);
			set_val(PS4_RY, C_RY);
		}
}}

//################################################################################################# 

function get_mvt_direction( _val, _lval)
{
	if (abs(_val - _lval) <= 2)
		return 0;

	if (_val < _lval) //move left
		return -1;

	if (_val > _lval)
		return 1;

	return 0;
}

//################################################################################################# 

function SEsin(fangle)
{   
    if(fangle <= 90)
    {             
        _ret = (Lookup_Table[fangle]);
    }
    else if (fangle <= 180)
    {      
        _ret = (Lookup_Table[180 - fangle]);
    }
    else if (fangle <= 270)
    {
        _ret = inv(Lookup_Table[fangle - 180]);     
    }
    else 
    {
       	_ret = inv(Lookup_Table[360 - fangle]);      
    }
    
    return _ret;
}

//################################################################################################# 

function SEcos(fangle)
{   
    if(fangle <= 90)
    {             
        _ret = (Lookup_Table[90 - fangle]);
    }
    else if (fangle <= 180)
    {      
        _ret = inv(Lookup_Table[fangle - 90]);
    }
    else if (fangle <= 270)
    {
        _ret = inv(Lookup_Table[270 - fangle]);       
    }
    else 
    {
        _ret = (Lookup_Table[fangle - 270]);       
    }
    
    return _ret;
}

//################################################################################################# 

function get_polar_coordinate(radius, coef)
{
	if(radius > 32)
	{
		radius = 32;
	}
		
	return((radius * coef) / 1000);		
}