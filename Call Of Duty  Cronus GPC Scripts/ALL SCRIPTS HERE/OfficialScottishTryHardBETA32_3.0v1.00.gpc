/*				  _________                  __     __   .__         .__     ___________                  ___ ___                      .___
				 /   _____/  ____    ____  _/  |_ _/  |_ |__|  ______|  |__  \__    ___/_______  ___.__. /   |   \ _____   _______   __| _/
				 \_____  \ _/ ___\  /  _ \ \   __\\   __\|  | /  ___/|  |  \   |    |   \_  __ \<   |  |/    ~    \\__  \  \_  __ \ / __ | 
				 /        \\  \___ (  <_> ) |  |   |  |  |  | \___ \ |   Y  \  |    |    |  | \/ \___  |\    Y    / / __ \_ |  | \// /_/ | 
				/_______  / \___  > \____/  |__|   |__|  |__|/____  >|___|  /  |____|    |__|    / ____| \___|_  / (____  / |__|   \____ | 
				        \/      \/                                \/      \/                     \/            \/       \/              \/ 
										__________ ______________________   _____    ________  ________  
										\______   \\_   _____/\__    ___/  /  _  \   \_____  \ \_____  \ 
										 |    |  _/ |    __)_   |    |    /  /_\  \    _(__  <  /  ____/ 
										 |    |   \ |        \  |    |   /    |    \  /       \/       \ 
										 |______  //_______  /  |____|   \____|__  / /______  /\_______ \
										        \/         \/                    \/         \/         \/
															________      _______   
															\_____  \     \   _  \  
															  _(__  <     /  /_\  \ 
															 /       \    \  \_/   \
															/______  / /\  \_____  /
															       \/  \/        \/ 
/*
============================================================================================================================================
  Credits                                                                                           
============================================================================================================================================

	ScottishTryHard Version 3.0,BETA32  
	Author  = Taylordrift21 
	Credits = DoGzTheFiGhTeR - DoNotAtMe - Batts - Excalibur - Swizzy - Noozbar - Fadexz - Cronus Community 
/*
============================================================================================================================================
  Instructions - Please Read                                                                                            
============================================================================================================================================
								/*------------------------------- INSTRUCTIONS PLEASE READ ------------------------------------------
								=====================================================================================================
								Enter Mod Menu   							= HOLD ADS & OPTIONS  
								-----------------------------------------------------------------------------------------------------
								Exit Menu                                   = CIRCLE/B 
								-----------------------------------------------------------------------------------------------------
								Enter Edit Menu To Change Values            = CROSS/A 
								-----------------------------------------------------------------------------------------------------
								Exit Edit Menu To Mod Menu                  = CIRCLE/B
								-----------------------------------------------------------------------------------------------------
								Enable/Disable Drive Mode                   = HOLD FIRE & Double Tap Right / Press Square TO Disable
								-----------------------------------------------------------------------------------------------------
								Change Profiles In The Menu                 = TRIANGLE/Y
								-----------------------------------------------------------------------------------------------------
								Change Values In Edit Menu                  = HOLD ADS & LEFT OR RIGHT OR UP OR DOWN
								-----------------------------------------------------------------------------------------------------
								Turn Mods On/Off                            = PRESS UP / DOWN TO CYCLE TOGGLE OPTIONS IF APPLICABLE
								-----------------------------------------------------------------------------------------------------
								Navigate The Main Menu                      = PRESS UP / DOWN 
								-----------------------------------------------------------------------------------------------------
								Navigate Mod Menu & Edit Menu               = PRESS LEFT / RIGHT 
								-----------------------------------------------------------------------------------------------------
								Choosing Buttons For Profiles/QuickToggles  = HOLD ADS & PRESS LEFT OR RIGHT 
								-----------------------------------------------------------------------------------------------------
								====================================================================================================*/

/*
============================================================================================================================================
  Init Section - Call Needed Fucntions For Script                                                                                           
============================================================================================================================================
*/
init { 
	InitializeShapeChange();
	
	TaylorARVert[0] = get_pvar(SPVAR_1,-99,99,0);
	TaylorARVert[1] = get_pvar(SPVAR_2,-99,99,0);
	TaylorARVert[2] = get_pvar(SPVAR_3,-99,99,0);
	VerticalStart[0] = get_pvar(SPVAR_4,-99,99,0);
	VerticalStart[1] = get_pvar(SPVAR_5,-99,99,0);
	VerticalStart[2] = get_pvar(SPVAR_6,-99,99,0);
	VerticalEnd  [0] = get_pvar(SPVAR_7,-99,99,0);
	VerticalEnd  [1] = get_pvar(SPVAR_8,-99,99,0);
	VerticalEnd  [2] = get_pvar(SPVAR_9,-99,99,0);
	VerticalTime [0] = get_pvar(SPVAR_10,0,99,0);
	VerticalTime [1] = get_pvar(SPVAR_11,0,99,0);
	VerticalTime [2] = get_pvar(SPVAR_12,0,99,0);
	ToggleAATypev1[0]= get_pvar(SPVAR_13,0,2,0);
	ToggleAATypev1[1]= get_pvar(SPVAR_14,0,2,0);
	ToggleAATypev1[2]= get_pvar(SPVAR_15,0,2,0);
    TaylorShapesv1[0]= get_pvar(SPVAR_16,0,8,0);
    TaylorShapesv1[1]= get_pvar(SPVAR_17,0,8,0);
    TaylorShapesv1[2]= get_pvar(SPVAR_18,0,8,0);
 	SpeedAA12[0]     = get_pvar(SPVAR_19,1,99,15);
 	SpeedAA12[1]     = get_pvar(SPVAR_20,1,99,15);
 	SpeedAA12[2]     = get_pvar(SPVAR_21,1,99,15);
 	RadiusAA12[0]    = get_pvar(SPVAR_22,1,99,15);
 	RadiusAA12[1]    = get_pvar(SPVAR_23,1,99,15);
 	RadiusAA12[2]    = get_pvar(SPVAR_24,1,99,15);
    ToggleAAType[0]  = get_pvar(SPVAR_25,0,2,0);
    ToggleAAType[1]  = get_pvar(SPVAR_26,0,2,0);
    ToggleAAType[2]  = get_pvar(SPVAR_27,0,2,0);
	TaylorShapes[0]  = get_pvar(SPVAR_28,0,12,0);
	TaylorShapes[1]  = get_pvar(SPVAR_29,0,12,0);
	TaylorShapes[2]  = get_pvar(SPVAR_30,0,12,0);
    AdsSpeed[0]      = get_pvar(SPVAR_31,1,99,10);
    AdsSpeed[1]      = get_pvar(SPVAR_32,1,99,10);
    AdsSpeed[2]      = get_pvar(SPVAR_33,1,99,10);
 	TaylorAngle[0]   = get_pvar(SPVAR_34,1,99,15);
 	TaylorAngle[1]   = get_pvar(SPVAR_35,1,99,15);
 	TaylorAngle[2]   = get_pvar(SPVAR_36,1,99,15);
 	TaylorRadius[0]  = get_pvar(SPVAR_37,1,99,15);
 	TaylorRadius[1]  = get_pvar(SPVAR_38,1,99,15);
 	TaylorRadius[2]  = get_pvar(SPVAR_39,1,99,15);
	TrackingSize = 2;
    TrackingSpeed = 2;
    AimAssistSize = 10;
    AimAssistTime = 10;
    BaseSpeed = 10;
    ZoneSpeed = 10;
    FireSpeed = 10;
    BasePower = 10;
    ZonePower = 10;
    FirePower = 10;
    DeadZone  = 8;
	
	
	
} 
/*
============================================================================================================================================
  Main Section - Start Of Menu                                                                                                              
============================================================================================================================================
*/
main { 
/*
============================================================================================================================================
  Button Activation Functions ()                                                                                                          
============================================================================================================================================
*/
	
	ActivateAllButtons();
	RemapButtonsConfig();
	UnmapButtonsConfig();
	Buttons(Buttons);
	ControllerRSLS(Sticks)

/*
============================================================================================================================================
  PS4 CrossOver Support                                                                                                                     
============================================================================================================================================
*/
	Ps4CrossOver();
/*
============================================================================================================================================
 Enter Menu - Access Edit Menu Without Going Into Main Menu                                                                                                                     
============================================================================================================================================
*/
	MenuActivation();
   
    if(!DisplayTitle)                           
    { 
    	if(ModOrEditMenu[0]) 
        {
        	MainMenu();  
        } 
   		if(ModOrEditMenu[1])       
     	{ 
        	ModMenu();	
    	} 
    	if(ModOrEditMenu[2] || ModOrEditMenu[3])  
	    { 
        	EditMenu();
        }
    }
    if(DisplayMenu)  
    { 
    	DisplayStrings();
	} 
/*
============================================================================================================================================
  End Of Menu - Start Of Mods                                                                                                                   
============================================================================================================================================
*/
    if(!ModOrEditMenu[0] && !ModOrEditMenu[1] && !ModOrEditMenu[2] && !ModOrEditMenu[3]) 
	{
    	RemapButtons(ActiveButtonRemap[0],RemapButtonActive[0]);
    	
    	RemapButtons(ActiveButtonRemap[1],RemapButtonActive[1]);
    	
    	RemapButtons(ActiveButtonRemap[2],RemapButtonActive[2]);
    	
    	RemapButtons(ActiveButtonRemap[3],RemapButtonActive[3]);
    	
    	UnmapButtonID(UnmapButton[0])
    	
    	UnmapButtonID(UnmapButton[1])
    	
    	DisplayTitleScreen();  
    	
    	ProfileActivation();
  
    	led(ProfileIdx);
    	
    	if(ToggleBurstFire[ProfileIdx] == 1  || BfFireType[ProfileIdx] == 1) 
    		deadzone(Ads,Fire,NOT_USE,NOT_USE); 
    	else
    		deadzone(Ads,Fire,99,99); 
    	
    	if(ToggleBlockRumble) 
		{
			block_rumble();
		}
    	if(get_ival(Fire))
    	{
			if(event_press(PS4_RIGHT) && get_brtime(PS4_RIGHT) <= 200 && !ModOrEditMenu[0] && !ModOrEditMenu[1] && !ModOrEditMenu[2] && !ModOrEditMenu[3])
    	    {
		        DriveMode = TRUE; 
		        combo_run(DriveMode);
    	    }
    	    set_val(PS4_RIGHT,0);
    	} 
		if(DriveMode) 
    	{
			combo_run(Blink);
			LedOn  = 150;
			LedOff = 300;
			
			if(event_press(PS4_SQUARE))
			{
				DriveMode = FALSE;
				combo_run(RumbleOff); 
    		} 
    	} 
   		if(!DriveMode)           
		{
			if(ToggleVmSpeed)
			{
				if(ToggleVmSpeed == 0) vm_tctrl( 0);	
			    if(ToggleVmSpeed == 1) vm_tctrl(-2);
			    if(ToggleVmSpeed == 2) vm_tctrl(-4);
			   	if(ToggleVmSpeed == 3) vm_tctrl(-6);
			} 

			ToggleRapidFire [ProfileIdx]  = QuickToggleMods(ActivateHoldButton[2] , ActivatePressButton[2]  ,ToggleRapidFire [ProfileIdx], 6); 
			ToggleSniperMode[ProfileIdx]  = QuickToggleMods(ActivateHoldButton[3] , ActivatePressButton[3]  ,ToggleSniperMode[ProfileIdx],20); 
			ToggleJumpShot  [ProfileIdx]  = QuickToggleMods(ActivateHoldButton[4] , ActivatePressButton[4]  ,ToggleJumpShot  [ProfileIdx],16); 
			
			if(ToggleSniperMode[ProfileIdx] == 1) 
	        {
	        	LedBlink(1300,500);
	        	HandGunVStrength = HandGunVertical;
	        	HandGunAASpd     = HandGunAASpeed;
	        	HandGunAAStr     = HandGunAASize;
	        	HGunAASpd        = HandGunAASpeed;
	        	HGunAAStr        = HandGunAASize;
	  
	        	InitializeShapeChange()
    		}
    		if(!ToggleSniperMode[ProfileIdx] == 1)
    		{
    			HandGunVStrength = TaylorARVert[ProfileIdx];
    			HandGunAASpd     = TaylorAngle[ProfileIdx];
    			HandGunAAStr     = TaylorRadius[ProfileIdx];	
    			HGunAASpd        = SpeedAA12[ProfileIdx];
	        	HGunAAStr        = RadiusAA12[ProfileIdx];
       		}
       		if(get_ival(Ads))
       		{
       			if(event_press(ActivatePressButton1[5])) 
       			{
       				TaylorARVert[ProfileIdx] += 2; 
       				if(TaylorARVert[ProfileIdx] > 99) TaylorARVert[ProfileIdx] = -99; 
       				DisplayAR = TRUE;
       			}
       			if(event_press(ActivatePressButton[5])) 
       			{
       				TaylorARVert[ProfileIdx] -= 2; 
       				if(TaylorARVert[ProfileIdx] < -99) TaylorARVert[ProfileIdx] = 99; 
       				DisplayAR = TRUE;
       			}
       			set_val(ActivatePressButton1[5],0); set_val(ActivatePressButton[5],0);
       		}
       		if(event_release(ActivatePressButton1[5]) ||  event_release(ActivatePressButton[5]))
			{
				ScreenSaver = TRUE;
			}
			if(DisplayAR) {
				DisplayAR();
				DisplayAR = FALSE;
			}
			if(ToggleTaylorAR[ProfileIdx] == 1) { 
				if(get_ival(Fire)){ 
					offset(AimRY,HandGunVStrength);
					offset(AimRX,TaylorARHoriz[ProfileIdx]);
				} 
			} 
			if(ToggleTaylorAR[ProfileIdx] == 2){ 
				if(get_ival(Fire)){ 
					SmartRumble = get_rumble(RumbleToUse());
					if(SmartRumble > 10 && SmartRumble < 90){ 
						AntirecoilStrength = HandGunVStrength + SmartRumble / 2; 
					} 
					if(SmartRumble < 10){ 
						offset(AimRY,HandGunVStrength);
						offset(AimRX,TaylorARHoriz[ProfileIdx]);
					}else{ 
						offset(AimRY,AntirecoilStrength);
						offset(AimRX,TaylorARHoriz[ProfileIdx]);
					}
				}
			} 
			if(ToggleProgressive[ProfileIdx] == 1 || ToggleProgressive[ProfileIdx] == 2) { 
		    
			    CompleteTime = (VerticalTime[ProfileIdx]   * 100) / 2;
			    HorizTime    = (HorizontalTime[ProfileIdx] * 100) / 2;
			    
			    if(get_ival(Ads) && get_ival(Fire)){    
			        SmartRumble = get_rumble(RumbleToUse());
			        Time += get_rtime();
			        
			        if(ToggleProgressive[ProfileIdx] == 2) { 
				        if(SmartRumble > 10 && SmartRumble < 90){ 
					        AntirecoilStart = VerticalStart[ProfileIdx] + SmartRumble / 2;
					        AntirecoilEnd   = VerticalEnd  [ProfileIdx] + SmartRumble / 2;
				        }
				    } 
			        if(Time < CompleteTime){ 
			        	if(ToggleProgressive[ProfileIdx] == 2 && SmartRumble < 10 || ToggleProgressive[ProfileIdx] == 1){ 
			            	 offset(AimRY,VerticalStart[ProfileIdx]);
			            }else{
			            	 offset(AimRY,AntirecoilStart);
			            } 
			        } 
			        else if(Time < CompleteTime * 2){ 
			    		if(ToggleProgressive[ProfileIdx] == 2 && SmartRumble < 10 || ToggleProgressive[ProfileIdx] == 1){ 
			    			offset(AimRY,VerticalEnd[ProfileIdx]);
			    		}else{ 
			            	offset(AimRY,AntirecoilEnd);
			            }     
			        }
			        if(Time >= VerticalTime[ProfileIdx] * 100){ 
			        	if(ToggleProgressive[ProfileIdx] == 2 && SmartRumble < 10 || ToggleProgressive[ProfileIdx] == 1){ 
			    			offset(AimRY,VerticalEnd[ProfileIdx]);
			    		}else{ 
			            	offset(AimRY,AntirecoilEnd);
			            }     
			        }
			        if(Time < HorizTime){ 
			            offset(AimRX,HorizontalStart[ProfileIdx]);      
			        }  
			        else if(Time < HorizTime * 2 ) { 
			            offset(AimRX,HorizontalEnd[ProfileIdx]);      
			        }  
			        if(Time >= HorizontalTime[ProfileIdx] * 100){
			        	offset(AimRX,HorizontalEnd[ProfileIdx]);
			        }       
			    } 
			    if(event_release(Fire)){ 
			    	Time            = 0;
			    	SmartRumble     = 0;
			    	AntirecoilStart = 0;
			    	AntirecoilEnd   = 0;
	    		} 
			} 
			if(ToggleTaylorAA[ProfileIdx] == 1){  											// V1 AA 
				ActualMagnitude = isqrt(pow(RX, 2) + pow(RY, 2));   
				MaxMagnitude    = (ActualMagnitude < 100);  
				RX              = get_val(AimRX);
				RY              = get_val(AimRY); 
				Anglev1         = Anglev1 % 360; 
				Anglev1         += HGunAASpd + BoostAnglev1;
				CycleRefresh    += get_rtime();
				if(ToggleAATypev1[ProfileIdx] == 0){
					CosAnglev1 = PolarArray[(Anglev1 + 270) % 360];  
					SinAnglev1 = PolarArray[Anglev1 % 360];
			    }
			    if(ToggleAATypev1[ProfileIdx] == 1){
			    	CosAnglev1 = LinearArray[(Anglev1 + 270) % 360];  
					SinAnglev1 = LinearArray[Anglev1 % 360];
				}
				if(ToggleAATypev1[ProfileIdx] == 2){
					CosAnglev1 = PolarArray[(Anglev1 + 270) % 360]; 
					SinAnglev1 = LinearArray[Anglev1 % 360];
				}
				if(BoostFirev1) {
					if(get_ival(Fire)){
						SmartRumblev1 = get_rumble(RumbleToUse());
						BoostAnglev1 = BoostSpeedv1;
				        if(SmartRumblev1> 10 && SmartRumblev1 < 90){
						    BoostedAimAssistv1  = (BoostStrengthv1 + SmartRumblev1 / 6);
					    }
					    if(!get_rumble(RUMBLE_A) && !get_rumble(RUMBLE_B)){
					    	GetShapesV1(BoostStrengthv1/2); 
					    }else{
							GetShapesV1(BoostedAimAssistv1/2); 	
				    	} 
				    }
				    if(event_release(Fire)){
						BoostAnglev1 = 0;
					} 
				}
				if(get_val(Ads) || get_val(Fire)){ 
					if(ActualMagnitude < HGunAAStr){
			   			SinAnglev1 -= RX;                                                              
						CosAnglev1 -= RY;
					}else{
						SinAnglev1 = (SinAnglev1 * (200 - ((abs(RY) + ActualMagnitude) / 10) * 10) / 200) * MaxMagnitude;  
						CosAnglev1 = (CosAnglev1 * (200 - ((abs(RX) + ActualMagnitude) / 10) * 10) / 200) * MaxMagnitude; 
					}
					if(!ToggleBoostFire || !get_rumble(RumbleToUse())){
						GetShapesV1(HGunAAStr);	
					}
			    	BoostedAimAssistv1  = 0; 
			        SmartRumblev1     = 0; 
		   		} 
			}
			if(ToggleTaylorAA[ProfileIdx] == 2){  // V2 
				Anglev2 = (Anglev2 + HGunAASpd + BoostAnglev2) % 360; 
				CycleRefresh += get_rtime();
				if(BoostFirev1) {
					if(get_ival(Fire)){
						SmartRumblev2 = get_rumble(RumbleToUse());
						BoostAnglev2 = BoostSpeedv1;
	    		        if(SmartRumblev2 > 10 && SmartRumblev2 < 90){
	    				    BoostedAimAssistv2  = (BoostStrengthv1 + SmartRumblev2 / 6);
	    			    }
	    			    if(!get_rumble(RUMBLE_A) && !get_rumble(RUMBLE_B)){
	    			    	DoNotAtMePolarv2(POLAR_RS,Anglev2,BoostStrengthv1/2)
	    			    }else{
							DoNotAtMePolarv2(POLAR_RS,Anglev2,BoostedAimAssistv2)	
				    	} 
				    }
				    if(event_release(Fire)){
	    				BoostAnglev2 = 0;
	    			} 
				}
				if(get_ival(Ads) || get_ival(Fire)){ 
					if(!ToggleBoostFire || !get_rumble(RumbleToUse())){
						DoNotAtMePolarv2(POLAR_RS,Anglev2,HGunAAStr) 
					}
				}
				SmartRumblev2      = 0;
				BoostedAimAssistv2 = 0;
			}
			if(ToggleTaylorAA[ProfileIdx] == 3){ 
				RX = get_val(PS4_RX);                                
				RY = get_val(PS4_RY);
	
			    Anglev2 = (Anglev2 + HGunAASpd) % 360; 
			 
				if(get_ival(Ads) && !get_ival(Fire)){ 
					DoNotAtMePolarv2(POLAR_RS,Anglev2,HGunAAStr) 
				}
				if(get_ival(Fire)){ 
					PolarAimAssist = get_ptime(Fire);	
					if(PolarAimAssist <= PolarStart){
				         DoNotAtMePolarv2(POLAR_RS,Anglev2,HGunAAStr) 
				     }
				     if((PolarAimAssist > PolarStart) && (PolarAimAssist <= PolarMid)){
				         GetShapesV6(HandGunAAStr,Anglev2);  
				     }
				     if(PolarAimAssist > PolarMid) {
				         GetShapesV6(HandGunAAStr,Anglev2); 
				     }
				} 
		    }	    	
			if(TaylorAssist[ProfileIdx] == 1){    // V4 
				Tracking = (Tracking +  TrackingSpeed) % 360;
				CycleRefresh += get_rtime();
				if(TaylorTracking){
			       Tracker1 = (TrackingSize * sin(Tracking)/100);
			       Tracker2 = (TrackingSize * cos(Tracking)/100);
		        }
		        if(ShapeDirection){ 
			    	AngleDirection = (get_val(PS4_RX) > 0);
			    }
			    if((abs(get_val(PS4_RX)) < 10) * (abs(get_val(PS4_RY)) < 10)) 
			    	Angle = (Angle + AdsSpeed[ProfileIdx] + AngleBoost) % 360;
			    else
			    	Angle = (Angle + HandGunAASpd + AngleBoost) % 360;
			    	
			    if(ToggleBoostFire) {
					if(get_ival(Fire)){
						SmartRumblev4 = get_rumble(RumbleToUse());
						AngleBoost = TaylorABoostSpd;
	    		        if(SmartRumblev2 > 10 && SmartRumblev2 < 90){
	    				    BoostedAimAssistv4  = (TaylorPBoostStr + SmartRumblev4 / 6);
	    			    }
	    			    if(!get_rumble(RUMBLE_A) && !get_rumble(RUMBLE_B)){
	    			    	DoNotAtMePolar(POLAR_RS,Angle,TaylorPBoostStr/2)
	    			    }else{
							DoNotAtMePolar(POLAR_RS,Angle,BoostedAimAssistv4)	
				    	} 
				    }
				    if(event_release(Fire)){
	    				AngleBoost = 0;
	    			} 
				}
				if(get_ival(Ads) || get_ival(Fire)){ 
					if(!ToggleBoostFire || !get_rumble(RumbleToUse())){
						DoNotAtMePolar(POLAR_RS,Angle,HandGunAAStr) 
					}
				}
				SmartRumblev4      = 0;
			 	BoostedAimAssistv4 = 0; 
		    }
		    if(TaylorAssist[ProfileIdx] == 2 || TaylorAssist[ProfileIdx] == 3){ 
		    
				RX = get_val(PS4_RX);                                
				RY = get_val(PS4_RY);
				ActualMagnitude = isqrt(pow(RX, 2) + pow(RY, 2));
				MaxMagnitude = (ActualMagnitude < 100);
				CycleRefresh += get_rtime();
				Tracking = (Tracking + TrackingSpeed) % 360;
				if(ShapeDirection){ 
			    	AngleDirection = (get_val(PS4_RX) > 0);
			    }
				if((abs(get_val(PS4_RX)) < 10) * (abs(get_val(PS4_RY)) < 10)) 
			    	angle += AdsSpeed[ProfileIdx] + GetAngle;
			    else
			    	angle +=  HandGunAASpd + GetAngle;
			    	
				if(TaylorTracking){
			       Tracker1 = (TrackingSize * sin(Tracking)/100);
			       Tracker2 = (TrackingSize * cos(Tracking)/100);
		        }
		        if(ToggleBoostFire) {
					if(get_ival(Fire)){
						SmartRumblev4 = get_rumble(RumbleToUse());
						GetAngle = TaylorABoostSpd;
	    		        if(SmartRumblev2 > 10 && SmartRumblev2 < 90){
	    				    BoostedAimAssistv4  = (TaylorPBoostStr + SmartRumblev4 / 6);
	    			    }
	    			    if(!get_rumble(RUMBLE_A) && !get_rumble(RUMBLE_B)){
	    			    	GetShapesV5(TaylorPBoostStr,angle); 
	    			    }else{
							GetShapesV5(BoostedAimAssistv4,angle); 	
				    	}    
				    }
				    if(event_release(Fire)){
	    				GetAngle = 0;
	    			} 
				}
				if(get_ival(Ads) || get_ival(Fire) && MaxMagnitude <= 30){  	
					if(TaylorAssist[ProfileIdx] == 3){ 
						angle += get_rtime();
						SpeedAngle = (SpeedAngle  + (angle / 100)) % 360;
						
						GetShapesV5(HandGunAAStr,SpeedAngle);	
				
					}else{ 
						GetShapesV5(HandGunAAStr,angle); 
					}
				} 
				if(event_release(Ads)){
		        	angle = 0;
		        }  
			}
			if(ToggleBattsStickyAim[ProfileIdx] == 1){ 
				if(get_ival(Fire)){ 
					combo_run(StickyAim);
				}else{ 
					combo_stop(StickyAim);
				} 
			} 
			if(ToggleDoGzAA) {
	
				if ((get_ival(Ads) || get_ival(Fire)) && abs(get_ival(RX)) <= DeadZone && abs(get_ival(RY)) <= DeadZone) {
					
					Anglev2 += HGunAASpd;
					
				if (Anglev2 >= 360) Anglev2 = 0;
		
					if (get_ival(Fire)) {
		                
		                HGunAAStr = FirePower;
		            	HGunAASpd  = FireSpeed;
		            }else {
		                    
		                HGunAAStr = BasePower;
		                HGunAASpd = BaseSpeed;
		            }
					DoNotAtMePolarv2(POLAR_RS,Anglev2,HGunAAStr) 	
				}
			    
				if ((get_ival(Ads) || get_ival(Fire)) && (abs(get_ival(RX)) > DeadZone || abs(get_ival(RY)) > DeadZone)) {
		            
			        ActualMagnitude = isqrt(pow(RX, 2) + pow(RY, 2));   
					MaxMagnitude    = (ActualMagnitude < 100);  
					RX              = get_val(AimRX);
					RY              = get_val(AimRY); 
			
			    	if (get_ival(Fire)) {
			                
			         	HGunAAStr = FirePower;
			            HGunAASpd = FireSpeed;
			        }else {
			                    
			            HGunAAStr = ZonePower;
			            HGunAASpd = ZoneSpeed;
			        }  
			        Anglev1         = Anglev1 % 360; 
					Anglev1         += HGunAASpd + BoostAnglev1;
					CycleRefresh    += get_rtime();
					if(ToggleAATypev1[ProfileIdx] == 0){
						CosAnglev1 = PolarArray[(Anglev1 + 270) % 360];  
						SinAnglev1 = PolarArray[Anglev1 % 360];
				    }
				    if(ToggleAATypev1[ProfileIdx] == 1){
				    	CosAnglev1 = LinearArray[(Anglev1 + 270) % 360];  
						SinAnglev1 = LinearArray[Anglev1 % 360];
					}
			      	if(ToggleAATypev1[ProfileIdx] == 2){
						CosAnglev1 = PolarArray[(Anglev1 + 270) % 360]; 
						SinAnglev1 = LinearArray[Anglev1 % 360];
					}
					if(ActualMagnitude < 30){
				   		SinAnglev1 -= RX;                                                              
					    CosAnglev1 -= RY;
					}else{
						SinAnglev1 = (SinAnglev1 * (200 - ((abs(RY) + ActualMagnitude) / 10) * 10) / 200) * MaxMagnitude;  
						CosAnglev1 = (CosAnglev1 * (200 - ((abs(RX) + ActualMagnitude) / 10) * 10) / 200) * MaxMagnitude; 
					}
					GetShapesV1(HGunAAStr);		 
				}
		    }
		    if(ToggleRapidFire[ProfileIdx] == 1 || ToggleSniperMode[ProfileIdx] == 1 && ToggleAutoRF)
			{
			 	HoldTime = 500 / RateOfFire[ProfileIdx]; 
			    RestTime = HoldTime -get_rtime();
			 	if(RestTime < 0) RestTime = 0;
			    
			 	
			 	if(RfFireType[ProfileIdx] == 0) { 
				 	if(get_ival(Fire))
				 		combo_run(RAPIDFIRE);
				 	else
				    	combo_stop(RAPIDFIRE);
				} 
				if(RfFireType[ProfileIdx] == 1) { 
					if(get_ival(Ads)){
			    		if(get_ival(Lethal)){
			    			FireRF = TRUE;
			    		}
			    	    set_val(Lethal,0);
			        } 
			        if(FireRF){ 
			    		set_val(Fire,100);
			    		combo_run(RAPIDFIRE);
			    	}
			    	if(event_release(Ads) || event_release(Lethal))
			    	{
			    		FireRF = FALSE;
			    	}
			    }
			    LedBlink(150,300);   
			}
			if(ToggleAkimboRf[ProfileIdx]  == 1) 
		    { 	
		        if(get_val(Fire))
		            combo_run(AkimboRapidFire);
		        else 
		            combo_stop(AkimboRapidFire);
		        
		        LedBlink(150,300);  
		    }
			if(ToggleBurstFire[ProfileIdx] == 1 || ToggleBurstFire[ProfileIdx] == 2 ){ 
    
				if(BfFireType[ProfileIdx] == 0) { 
					if(ToggleBurstFire[ProfileIdx] == 1) {
						if(get_ival(Fire) > 0 && get_ival(Fire) <= BurstFireRelease) {
				        	combo_run(BurstFireAuto);
				        } else {
				        	combo_stop(BurstFireAuto);
				    	}
				    } 
				    else if(ToggleBurstFire[ProfileIdx] == 2) {
						if(get_ival(Fire)) { 
							set_val(Fire,0);
					        combo_run(BurstFireSemi);   
					    }
					}
				}
				if(BfFireType[ProfileIdx] == 1) { 
					if(get_ival(Ads)){
			    		if(get_ival(Lethal)){
			    			FireRF = TRUE;
			    		}
			    	    set_val(Lethal,0);
			        } 
			        if(FireRF){ 
			        	set_val(Fire,100);
			        	if(ToggleBurstFire[ProfileIdx] == 1)
			        		combo_run(BurstFireAuto);
			        	else
			        		combo_run(BurstFireSemi);   
			        }
			    } 	
				if(event_release(Ads) || event_release(Lethal))
			    {
			    	FireRF = FALSE;
			    }
			}
			if(ToggleStrafeShot[ProfileIdx] == 1) 
		    {
		   		if(get_val(Fire))
		        	combo_run(StrafeShot);
				else
		   			combo_stop(StrafeShot);
			}
			if(ToggleCancelReload)
			{
				if(event_press(Fire))
					FirstShotBeforeReload = TRUE; 
					
				if(event_press(Reload) && FirstShotBeforeReload)
				{
					ReloadInProgress = TRUE;
					FirstShotBeforeReload = FALSE;
				}
				if(get_val(Reload) && get_ptime(Reload) >= 250)
				{
					ReloadInProgress = FALSE;
					combo_stop(CancelReload);
				}
				if(ReloadInProgress)
					ReloadTime += get_rtime();
				else 
				    ReloadTime = 0;

				if(ReloadTime > MaxReloadTime)
					ReloadInProgress = FALSE;

				if(ReloadTime > 0 && ReloadTime <= MaxReloadTime && event_press(Fire))
					combo_run(CancelReload);
			}
			if(ToggleTaylorSens){ 
				 if(get_ival(Ads)){ 
       				if(!get_ival(Fire)){ 
            			GenStr = AdsSens;
        			}else{ 
            			GenStr = AdsFireSens;
        			} 
   				}
    			else if(get_ival(Fire)){ 
        			GenStr = FireSens; 
    			}else{ 
        			GenStr = GeneralSens;
    			} 
    			set_polar(POLAR_RS, get_polar(POLAR_RS, POLAR_ANGLE), get_polar(POLAR_RS, POLAR_RADIUS) * GenStr / 100);
    		}
    		if(ToggleCancelSlide == 1 || ToggleCancelSlide == 2)
			{
				if((get_val(MoveLY) < -80) || (get_val(MoveLY) > 80) || (get_val(MoveLX) < -80) || (get_val(MoveLX) > 80))
				{
					if(ToggleCancelSlide == 1 && event_release(Crouch))
						combo_run(CancelSlideMW)
					else if(ToggleCancelSlide == 2 && event_release(Crouch))
						combo_run(CancelSlideCW) 
						
					if(ToggleCancelSlide == 1 && combo_running(CancelSlideMW) && (get_val(Ads) && event_release(Crouch)))
	                    combo_stop(CancelSlideMW)
	                    
	                if(ToggleCancelSlide == 2 && combo_running(CancelSlideCW) && (get_val(Ads) && event_release(Crouch)))
	                    combo_stop(CancelSlideCW)
				}
			}
			if(ToggleHoldBreath[ProfileIdx] == 1 || ToggleSniperMode[ProfileIdx] == 1  && ToggleAutoHB)
			{
	       		if(get_val(Ads))
		    		set_val(Sprint, 100);
	                      
	   			if(get_val(PS4_LY) <-90 && get_val(Ads) && get_ptime(Ads) > 200)
	       			combo_stop(HoldBreath);       
	                    
	   			if(event_press(Ads)) 
	       			combo_run(HoldBreath);
	  
	   			if(get_val(Ads) && get_lval(Sprint)) 
	       			set_val(Sprint, 0);  
			}
			if(ToggleBunnyHop)
			{
	            if(get_ival(Jump) && get_ptime(Jump) > 200) 
	                combo_run(Bunnyhop); 
	        }
	        if(ToggleJumpShot[ProfileIdx] == 1) 
			{
				if(get_val(Fire))
					combo_run(JumpShot);
			}
			if(ToggleFastMelee[ProfileIdx] == 1) 
			{
				if(get_val(Melee))
					combo_run(FastMelee);

				if(get_val(Ads) && event_press(Melee) < 500)
					combo_stop(FastMelee);
			}
			if(ToggleEnemyPing) 
        	{
        		if(get_ival(Fire) && get_ptime(Fire) >= 300)
	         		combo_run(EnemyPing); 
	     		else
	         		combo_stop(EnemyPing);		
        	}
        	if(ToggleCrouchShot[ProfileIdx] == 1) { 
		    	if(get_ival(Fire)){
		    		combo_run(CrouchShotCmb);
		    	}
		    }
		} 	   		
	}	    	 
/*
============================================================================================================================================
  End Of Main Section                                                                                                                    
============================================================================================================================================
*/
 }
/*
============================================================================================================================================
 Main Menu                                                                                                                      
============================================================================================================================================
*/
int ModORVal[3],ModOrEditMenu[4],DisplayMenu;
const string MainMenuId[] = {
"AntiRecoil",
"Aim Assist",
"Fire Mods",
"Misc Mods",
"Settings",
""};
const uint8  ModRange   [][]   = { 
{   0 ,  1 , 1}, // N/A     \\
{   2 ,  5 , 1}, // Main  1 \\
{   6 , 10 , 1}, // Main  2 \\
{  11 , 20 , 1}, // Main  3 \\
{  21 , 36 , 1}  // Main  3 \\
};
function MainMenu(){ 
	ModORVal[0]  = MenuNavigation(ModORVal[0],0,4); 
    led(ProfileIdx);
    vm_tctrl(0);
        	
	if(event_press(PS4_CIRCLE))
    {
		MenuStatus(0,0,0,0,0,1);
		InitializeShapeChange();
		Save();
		combo_run(Saved);
	}	
}
/*
============================================================================================================================================
 Mod Menu                                                                                                                      
============================================================================================================================================
*/
int ModIdx;
int ToggleTaylorAR[3];
int ToggleProgressive[3];
int ToggleTaylorAA[3];
int TaylorAssist[3]; 
int ToggleBattsStickyAim;
int ToggleDoGzAA; 
int ToggleRapidFire[3];
int ToggleAkimboRf[3];
int ToggleBurstFire[3];
int ToggleStrafeShot[3]; 
int ToggleCancelReload;
int ToggleTaylorSens;
int ToggleCancelSlide;
int ToggleHoldBreath[3];
int ToggleBunnyHop;
int ToggleJumpShot[3];
int ToggleCrouchShot[3];
int ToggleFastMelee[3];
int ToggleVmSpeed;
int ToggleEnemyPing;
int ToggleSniperMode[3];
int Buttons;
int Sticks;
int ToggleBlockRumble;
int DisplayAR;
int HorizTime;
const string ModNames[] = {
	"Choose AR","Progressive AR",// Anti Recoil 
//        0             1        \\
	"TD Assist v1/v2/v6","TD Assist v4/v5","Batts Sticky Aim","DoGz Polar V6",// Aim Assist
//        2                     3                4                  5        \\
	"Rapid Fire","Akimbo Rf","Burst Fire","StrafeShot","Cancel Reload",// Fire Mods 
//        6           7            8            9             10       \\
	"HoldBreath","Custom Sens","Cancel Slide","BunnyHop","Crouch Shot","Jump Shot","Fast Melee","Enemy Ping","Vm Speed","Sniper/HGun Mode", // Misc Mods 
//       11            12             13          14           15           16          17           18          19            20           \\
	"Button Layout","Stick Layout","Block Rumble","Profile Btn","Resync Btns","Custom Profile","Button Remap 1","Button Remap 2","Button Remap 3","Button Remap 4",
//       21               22             23            24             25              26             27               28                29               30     \\
	"Unmap Button 1","Unmap Button 2","Rapid Fire","Sniper/HGun Mode","Jump Shot","Rumble AR QT",// Settings
//       31                 32             33            34               35            36
""}
const uint8 ModsNToggles[][] = {
// ModIdx - MinToggle - MaxToggle - ValRangeMin - ValRangeMax - Editable - Profile 
//    0         1           2            3             4            5         6    \\
{     0   ,     0     ,     2     ,      0      ,      1      ,     1    ,    1  },// Leg/Rum AR  \\
{     1   ,     0     ,     2     ,      2      ,      7      ,     1    ,    1  },// Progressive \\
{     2   ,     0     ,     3     ,      8      ,     14      ,     1    ,    1  },// TaylorAA    \\
{     3   ,     0     ,     3     ,     15      ,     26      ,     1    ,    1  },// TaylorAA    \\
{     4   ,     0     ,     1     ,     27      ,     28      ,     1    ,    1  },// BattsAA     \\
{     5   ,     0     ,     1     ,     29      ,     37      ,     1    ,    1  },// DoGzAA      \\
{     6   ,     0     ,     1     ,     38      ,     38      ,     1    ,    1  },// RapidFire   \\
{     7   ,     0     ,     1     ,     39      ,     39      ,     1    ,    1  },// AkimboRf    \\
{     8   ,     0     ,     2     ,     40      ,     42      ,     1    ,    1  },// BurstFire   \\
{     9   ,     0     ,     1     ,     43      ,     43      ,     1    ,    1  },// StrafeShot  \\
{    10   ,     0     ,     1     ,     44      ,     44      ,     1    ,    0  },// CancelReload\\
{    11   ,     0     ,     1     ,      0      ,      0      ,     0    ,    1  },// HoldBreath  \\
{    12   ,     0     ,     1     ,     45      ,     48      ,     1    ,    0  },// CustomSens  \\
{    13   ,     0     ,     2     ,     49      ,     49      ,     1    ,    0  },// CancelSlide \\
{    14   ,     0     ,     1     ,      0      ,      0      ,     0    ,    0  },// BunnyHop    \\
{    15   ,     0     ,     1     ,     50      ,     50      ,     1    ,    1  },// CrouchMods  \\
{    16   ,     0     ,     1     ,      0      ,      0      ,     0    ,    1  },// JumpShot    \\
{    17   ,     0     ,     1     ,      0      ,      0      ,     0    ,    1  },// FastMelee   \\
{    18   ,     0     ,     1     ,     51      ,     51      ,     1    ,    0  },// EnemyPing   \\ 
{    19   ,     0     ,     3     ,      0      ,      0      ,     0    ,    0  },// VmSpeed     \\
{    20   ,     0     ,     1     ,     52      ,     56      ,     1    ,    1  },// SniperMode  \\
{    21   ,     0     ,    21     ,      0      ,      0      ,     0    ,    2  },// CtrlrLayout \\
{    22   ,     0     ,     3     ,      0      ,      0      ,     0    ,    2  },// CtrlrLayout \\
{    23   ,     0     ,     1     ,      0      ,      0      ,     0    ,    2  },// BlockRumble \\
{    24   ,     0     ,     8     ,      0      ,      0      ,     0    ,    3  },// ProfileBtn  \\
{    25   ,     0     ,     0     ,      0      ,      0      ,     0    ,    3  },// ResyncBtn   \\
{    26   ,     0     ,     0     ,      0      ,      0      ,     0    ,    4  },// WarzonePro  \\
{    27   ,     0     ,     0     ,      0      ,      0      ,     0    ,    6  },// Remap 1     \\
{    28   ,     0     ,     0     ,      0      ,      0      ,     0    ,    6  },// Remap 2     \\
{    29   ,     0     ,     0     ,      0      ,      0      ,     0    ,    6  },// Remap 3     \\
{    30   ,     0     ,     0     ,      0      ,      0      ,     0    ,    6  },// Remap 4     \\
{    31   ,     0     ,    25     ,      0      ,      0      ,     0    ,    6  },// Unmap 1     \\
{    32   ,     0     ,    25     ,      0      ,      0      ,     0    ,    6  },// Unmap 2     \\
{    33   ,     0     ,     0     ,      0      ,      0      ,     0    ,    5  },// RapidQT     \\
{    34   ,     0     ,     0     ,      0      ,      0      ,     0    ,    5  },// SniperQT    \\
{    35   ,     0     ,     0     ,      0      ,      0      ,     0    ,    5  },// JumpShotQT  \\
{    36   ,     0     ,     0     ,      0      ,      0      ,     0    ,    5  } // RecoilQT    \\
};
function ModMenu(){ 
	ModORVal[1]   = MenuNavigation(ModORVal[1],ModRange[ModORVal[0]][0],ModRange[ModORVal[0]][1]); // Menu Navigation Function \\       	
   	ModIdx = -1; 
	ToggleTaylorAR   [ProfileIdx]   = ToggleSwitch(ToggleTaylorAR    [ProfileIdx]);
	ToggleProgressive[ProfileIdx]   = ToggleSwitch(ToggleProgressive [ProfileIdx]);
	ToggleTaylorAA[ProfileIdx]      = ToggleSwitch(ToggleTaylorAA[ProfileIdx]);
	TaylorAssist[ProfileIdx]        = ToggleSwitch(TaylorAssist[ProfileIdx]);
	ToggleBattsStickyAim 			= ToggleSwitch(ToggleBattsStickyAim);
	ToggleDoGzAA          			= ToggleSwitch(ToggleDoGzAA);
	ToggleRapidFire  [ProfileIdx]   = ToggleSwitch(ToggleRapidFire   [ProfileIdx]);
	ToggleAkimboRf   [ProfileIdx]   = ToggleSwitch(ToggleAkimboRf    [ProfileIdx]);
	ToggleBurstFire  [ProfileIdx]   = ToggleSwitch(ToggleBurstFire   [ProfileIdx]);
	ToggleStrafeShot [ProfileIdx]   = ToggleSwitch(ToggleStrafeShot  [ProfileIdx]);
	ToggleCancelReload   			= ToggleSwitch(ToggleCancelReload);
	ToggleHoldBreath [ProfileIdx]   = ToggleSwitch(ToggleHoldBreath  [ProfileIdx]); 
	ToggleTaylorSens     			= ToggleSwitch(ToggleTaylorSens);
	ToggleCancelSlide    			= ToggleSwitch(ToggleCancelSlide);
	ToggleBunnyHop       			= ToggleSwitch(ToggleBunnyHop); 
	ToggleCrouchShot [ProfileIdx]   = ToggleSwitch(ToggleCrouchShot  [ProfileIdx]);
	ToggleJumpShot   [ProfileIdx]   = ToggleSwitch(ToggleJumpShot    [ProfileIdx]);
	ToggleFastMelee  [ProfileIdx]   = ToggleSwitch(ToggleFastMelee   [ProfileIdx]);
	ToggleEnemyPing        			= ToggleSwitch(ToggleEnemyPing); 
	ToggleVmSpeed        			= ToggleSwitch(ToggleVmSpeed); 
	ToggleSniperMode [ProfileIdx]   = ToggleSwitch(ToggleSniperMode  [ProfileIdx]);
	Buttons            			    = ToggleSwitch(Buttons);  
	Sticks            			    = ToggleSwitch(Sticks);  
    ToggleBlockRumble        	    = ToggleSwitch(ToggleBlockRumble);
	ActivateIndividualBtnIdx        = ToggleSwitch(ActivateIndividualBtnIdx);
	ButtonActivation(0)
	ButtonActivation(1)
	ButtonConfig(0)
	ButtonConfig(1)
	ButtonConfig(2)
	ButtonConfig(3)
	UnmapBtnIdx[0]                 = ToggleSwitch(UnmapBtnIdx[0]);
	UnmapBtnIdx[1]                 = ToggleSwitch(UnmapBtnIdx[1]);
	ButtonActivation(2)
	ButtonActivation(3)
	ButtonActivation(4)
	ButtonActivationAR(5)
	MenuScroll();
	vm_tctrl(0);
}
/*
============================================================================================================================================
  Mod Menu Toggle ()                                                                                                                      
============================================================================================================================================
*/
function ToggleSwitch(f_val) { 
	  
	if(ModORVal[1] == ModsNToggles[ModIdx++][0]){
	
		f_val = MultiFunction(PS4_UP,PS4_DOWN,f_val,1,ModsNToggles[ModORVal[1]][1],ModsNToggles[ModORVal[1]][2]); 
		
		if(ModsNToggles[ModIdx][0] == 0) { 
			if(f_val == 1){ 
				ToggleProgressive[ProfileIdx] = 0;
			} 
		} 
		if(ModsNToggles[ModIdx][0] == 1) { 
			if(f_val == 1){ 
				ToggleTaylorAR[ProfileIdx] = 0;
			} 
		} 
		if(ModsNToggles[ModIdx][0] == 2) { 
			if(f_val == 1){ 
				TaylorAssist[ProfileIdx] = 0;
			} 
		} 
		if(ModsNToggles[ModIdx][0] == 3) { 
			if(f_val == 1){ 
				ToggleTaylorAA[ProfileIdx] = 0;
			} 
		}
		if(ModsNToggles[ModIdx][0] == 6) { 
			if(f_val == 1){ 
				ToggleBurstFire[ProfileIdx] = 0;
			} 
		} 
		if(ModsNToggles[ModIdx][0] == 8) { 
			if(f_val == 1){ 
				ToggleRapidFire[ProfileIdx] = 0;
			} 
		} 
		
		if(ModsNToggles[ModIdx][0] == 6){
			RfFireType[ProfileIdx] = MultiFunction(PS4_R1,PS4_L1,RfFireType[ProfileIdx],1,0,1); 
		}
		if(ModsNToggles[ModIdx][0] == 8){
			BfFireType[ProfileIdx] = MultiFunction(PS4_R1,PS4_L1,BfFireType[ProfileIdx],1,0,1); 
		}
	    if(ModsNToggles[ModIdx][0] == 0) { 
	    	String(ARToggle[ToggleTaylorAR[ProfileIdx]],Small,6,0);
	    }
	    else if(ModsNToggles[ModIdx][0] == 1) { 
	    	String(ProgAR[ToggleProgressive[ProfileIdx]],Small,6,0);
	    }
	    else if(ModsNToggles[ModIdx][0] == 2){
	    	String(AAToggle[ToggleTaylorAA],Small,6,0);
	    } 
	    else if(ModsNToggles[ModIdx][0] == 3){
	    	String(AAToggle2[TaylorAssist[ProfileIdx]],Small,6,0);
	    } 
	    else if(ModsNToggles[ModIdx][0] == 6){
	    	String(RFToggle[RfFireType[ProfileIdx]],Small,1,0);
	    	
	    	if(f_val == 1)
				String(Misc[0],Small,12,0);   
			else 
		    	String(Misc[1],Small,12,0);  
	    }
	    else if(ModsNToggles[ModIdx][0] == 8){
	    	String(RFToggle[BfFireType[ProfileIdx]],Small,1,0);
	    	String(BurstFireMode[ToggleBurstFire[ProfileIdx]],Small,12,0);
	    	
	    }
	    else if(ModsNToggles[ModIdx][0] == 13){
	    	String(SlideType[ToggleCancelSlide],Small,6,0);
	    } 
	    else if(ModsNToggles[ModIdx][0] == 19){
	    	String(VMSpeed[ToggleVmSpeed],Medium,6,0);
	    } 
	    else if(ModsNToggles[ModIdx][0] == 21){
	    	String(ControllerLayouts[Buttons],Small,6,0);
	    } 
	    else if(ModsNToggles[ModIdx][0] == 22){
	    	String(ControllerSticks[Sticks],Small,6,0);
	    } 
	    else if(ModsNToggles[ModIdx][0] == 24){
	    	String(PressButtons[ActivateIndividualBtnIdx],Small,6,0);
	    } 
	   
	    else if(ModsNToggles[ModIdx][0] == 31){
	    	String(UnmapButtons[UnmapBtnIdx[0]],Small,6,0);
	    } 
	    else if(ModsNToggles[ModIdx][0] == 32){
	    	String(UnmapButtons[UnmapBtnIdx[1]],Small,6,0);
	    }  
	    else
	    {
		    if(f_val == 1)
				String(Misc[0],Small,6,0);   
			else 
		    	String(Misc[1],Small,6,0);  
		} 		
	}  	
    return f_val;
}

/*
============================================================================================================================================
  Edit Menu                                                                                                                     
============================================================================================================================================
*/
int ValIdx;
// Adjustable Values \\ 
int TaylorARVert[3];
int TaylorARHoriz[3]; 
int VerticalStart[3];
int VerticalEnd[3];
int VerticalTime[3];
int HorizontalStart[3];
int HorizontalEnd[3];
int HorizontalTime[3];
int ToggleAATypev1[3];
int TaylorShapesv1[3];
int SpeedAA12[3];
int RadiusAA12[3];
int BoostFirev1;
int BoostSpeedv1;
int BoostStrengthv1;
int ToggleAAType[3]; 
int TaylorShapes[3];
int ShapeDirection;
int AdsSpeed[3];
int TaylorAngle[3];
int TaylorRadius[3];
int ToggleBoostFire;
int TaylorPBoostStr;
int TaylorABoostSpd;
int TaylorTracking;
int TrackingSize;
int TrackingSpeed;
int AimAssistSize;
int AimAssistTime;
int BaseSpeed;
int ZoneSpeed;
int FireSpeed;
int BasePower;
int ZonePower;
int FirePower;
int DeadZone;
int RateOfFire[3];
int RateOfFireRf[3];
int BurstFireHold;
int BurstFireWait;
int BurstFireRelease;
int StrafeShotTime;
int ReloadTime;
int GeneralSens,AdsSens,FireSens,AdsFireSens;
int SlideDelay;
int CrouchSpeed; 
int PingDelay; 
int HandGunVertical;
int HandGunAASpeed;
int HandGunAASize;
int HGunAASpd,HGunAAStr;
int ToggleAutoRF,ToggleAutoHB;
const string ValNames[]  = { 
	"V Strength","H Strength",// Rumble AR 
//       0            1      \\ 
	"V Start","V End","V Time","Horiz Start","Horiz End","Horiz Time",// Progressive AR 
//       2      3       4           5             6           7       \\  
    "AA Type","Choose Shape","Speed","Radius","Boost On Fire","Boost Str","Boost Spd",// Taylor Assist v1/v2/v6
//       8          9          10     11           12            13          14      \\
	"AA Type","Choose Shape","Shape Direction","Ads Speed","Speed","Radius","Boost On Fire","Boost Str","Boost Spd","Taylor Tracking","Tracking Size","Tracking Speed",// Taylor Assist  v4 - v5  
//       15          16             17             18        19       20           21            22          23            24                25              26                
	"Sticky Size","Sticky Time",// Batts Aim Assist 
//       27            28       \\
    "AA Type","Choose Shape","Base Speed","Zone Speed","Fire Speed","Base Power","Zone Power","Fire Power","DeadZone",// DoGz Polar V6 With Taylordrift21 Shapes
//       29          30           31           32           33           34           35           36          37     \\
	"Rounds/Sec",// Rapid Fire
//       38      \\
	"Rounds/Sec",// AkimboRf
//       39      \\
	"Hold Time","Wait Time","Trigger Pressure",// Ceorin Burst Fire With Auto/RF 
//       40          41             42     \\	
	"StrafeTime",// Batts StrafeShot 
//       43      \\           
	"Reload Time",// Fadexz Cancel Reload 
//       44       \\
	"Generel","Ads","Fire","AdsFire",// Custom Sensitivity 
//       45    46     47      48     \\  
	"Slide Delay",// Cancel Slide 
//       49       \\
	"CrouchSpeed",// CrouchShot 
//       50       \\	
	"Ping Delay", // Enemy Ping 
//       51      \\     	
	"AR VertStrength","Speed","Radius","Auto Rapid Fire","Auto Hold Breath",// Sniper / HandGun Mode
//       52              53      54          55               56	        \\
	""}
const string ProgAR[]          = {"Off","Standard","Rumble",""};
const string BurstFireMode[]   = {"Off","Auto Mode","Semi Mode",""};
const string ARToggle[]        = {"Choose AR","Legacy AR","Rumble AR",""} ;
const string RFToggle[]        = {"Fire Only","Ads + Bumper",""}; 
const string SlideType[]       = {"Off","Mw/Vanguard","ColdWar",""};
const string VMSpeed[]         = {"0","-2","-4","-6",""};
const int16 ValRangeMinMax [][] = {
// ValIdx - MinValue - MaxValue - IncrementMin - IncrementMax - Profile \\
//    0        1          2             3              4           5         \\    
{     0   ,  -99     ,   99     ,       1      ,      10      ,    1      , 0}, // Vert       \\
{     1   ,  -99     ,   99     ,       1      ,      10      ,    1      , 0}, // Horiz      \\
{     2   ,  -99     ,   99     ,       1      ,      10      ,    1      , 0}, // VertStart  \\
{     3   ,  -99     ,   99     ,       1      ,      10      ,    1      , 0}, // VertEnd    \\
{     4   ,    0     ,   99     ,       1      ,      10      ,    1      , 0}, // VertTime   \\
{     5   ,  -99     ,   99     ,       1      ,      10      ,    1      , 0}, // HorizStart \\
{     6   ,  -99     ,   99     ,       1      ,      10      ,    1      , 0}, // HorizEnd   \\
{     7   ,  -99     ,   99     ,       1      ,      10      ,    1      , 0}, // HorizTime  \\
{     8   ,    0     ,    2     ,       1      ,       1      ,    1      , 0}, // AAType     \\
{     9   ,    0     ,    7     ,       1      ,       1      ,    1      , 0}, // AAShape    \\
{    10   ,    0     ,   99     ,       1      ,      10      ,    1      , 0}, // SpeedAA    \\
{    11   ,    0     ,   99     ,       1      ,      10      ,    1      , 0}, // RadiusAA   \\
{    12   ,    0     ,    1     ,       1      ,       1      ,    1      , 0}, // BoostFire  \\
{    13   ,    0     ,   40     ,       1      ,      10      ,    1      , 0}, // Boost Str  \\
{    14   ,    0     ,   40     ,       1      ,      10      ,    1      , 0}, // Boost Spd  \\
{    15   ,    0     ,    2     ,       1      ,       1      ,    1      , 0}, // AAType     \\
{    16   ,    0     ,   12     ,       1      ,       1      ,    1      , 0}, // AAShape    \\
{    17   ,    0     ,    1     ,       1      ,       1      ,    0      , 0}, // ShapeDir   \\
{    18   ,    0     ,   99     ,       1      ,      10      ,    1      , 1}, // AdsSpeed   \\
{    19   ,    0     ,   99     ,       1      ,      10      ,    1      , 1}, // SpeedAA    \\
{    20   ,    0     ,   99     ,       1      ,      10      ,    1      , 1}, // RadiusAA   \\
{    21   ,    0     ,    1     ,       1      ,       1      ,    1      , 0}, // BoostFire  \\
{    22   ,    0     ,   40     ,       1      ,      10      ,    1      , 1}, // Boost Str  \\
{    23   ,    0     ,   40     ,       1      ,      10      ,    1      , 1}, // Boost Spd  \\
{    24   ,    0     ,    1     ,       1      ,       1      ,    1      , 0}, // TrackTog   \\
{    25   ,    0     ,    8     ,       1      ,       1      ,    1      , 1}, // TrackSize  \\
{    26   ,    0     ,    8     ,       1      ,       1      ,    1      , 1}, // TrackSpeed \\
{    27   ,    0     ,   99     ,       1      ,      10      ,    1      , 0}, // StickySize \\
{    28   ,    0     ,   99     ,       1      ,      10      ,    1      , 0}, // StickyTime \\
{    29   ,    0     ,    1     ,       1      ,       1      ,    1      , 0}, // AAType     \\
{    30   ,    0     ,   12     ,       1      ,       1      ,    1      , 0}, // AAShape    \\
{    31   ,    0     ,   99     ,       1      ,      10      ,    1      , 0}, // BaseSpd    \\
{    32   ,    0     ,   99     ,       1      ,      10      ,    1      , 0}, // ZoneSpd    \\
{    33   ,    0     ,   99     ,       1      ,      10      ,    1      , 0}, // FireSpd    \\
{    34   ,    0     ,   99     ,       1      ,      10      ,    1      , 0}, // BasePwr    \\
{    35   ,    0     ,   99     ,       1      ,      10      ,    1      , 0}, // ZonePwr    \\
{    36   ,    0     ,   99     ,       1      ,      10      ,    1      , 0}, // FirePwr    \\
{    37   ,    0     ,   99     ,       1      ,      10      ,    1      , 0}, // DeadZone   \\
{    38   ,    0     ,   25     ,       1      ,      10      ,    1      , 0}, // RateOfFire \\
{    39   ,    0     ,   25     ,       1      ,      10      ,    1      , 0}, // RateOfFire \\
{    40   ,    0     ,  990     ,      10      ,     100      ,    0      , 0}, // HoldTime   \\
{    41   ,    0     ,  990     ,      10      ,     100      ,    0      , 0}, // WaitTime   \\
{    42   ,    0     ,   99     ,       1      ,      10      ,    0      , 0}, // Release    \\
{    43   ,    0     ,  990     ,      10      ,     100      ,    0      , 0}, // StrafeTime \\
{    44   ,    0     , 5000     ,      10      ,     100      ,    0      , 0}, // ReleoadTime\\
{    45   ,    0     ,  327     ,       1      ,      10      ,    0      , 0}, // GeneralSens\\
{    46   ,    0     ,  327     ,       1      ,      10      ,    0      , 0}, // AdsSens    \\
{    47   ,    0     ,  327     ,       1      ,      10      ,    0      , 0}, // FireSens   \\
{    48   ,    0     ,  327     ,       1      ,      10      ,    0      , 0}, // AdsFireSens\\
{    49   ,    0     ,  200     ,       1      ,      10      ,    0      , 0}, // SlideDelay \\
{    50   ,    0     ,  200     ,       1      ,      10      ,    0      , 0}, // CrouchSpeed\\
{    51   ,    0     , 5000     ,      10      ,     100      ,    0      , 0}, // PingDelay  \\
{    52   ,  -99     ,   99     ,       1      ,      10      ,    2      , 0}, //VertHandGun \\
{    53   ,    0     ,   99     ,       1      ,      10      ,    2      , 0}, //VertHandGun \\
{    54   ,    0     ,   99     ,       1      ,      10      ,    2      , 0}, //VertHandGun \\
{    55   ,    0     ,    1     ,       1      ,       1      ,    2      , 0}, // AutoRF     \\
{    56   ,    0     ,    1     ,       1      ,       1      ,    2      , 0}  // AutoHB     \\
}
function EditMenu(){ 
	if(ModOrEditMenu[3])
    	ModORVal[2]   = MenuNavigation(ModORVal[2],0,56);
    else
    	ModORVal[2]   = MenuNavigation(ModORVal[2],ModsNToggles[ModORVal[1]][3],ModsNToggles[ModORVal[1]][4]); // Menu Navigation Function \\
    
    ValIdx = -1;
	TaylorARVert   [ProfileIdx]  = EditableValues(TaylorARVert[ProfileIdx]);
	TaylorARHoriz  [ProfileIdx]  = EditableValues(TaylorARHoriz[ProfileIdx]);
	VerticalStart  [ProfileIdx]  = EditableValues(VerticalStart[ProfileIdx]);
	VerticalEnd    [ProfileIdx]  = EditableValues(VerticalEnd[ProfileIdx]);
	VerticalTime   [ProfileIdx]  = EditableValues(VerticalTime[ProfileIdx]);
	HorizontalStart[ProfileIdx]  = EditableValues(HorizontalStart[ProfileIdx]);
	HorizontalEnd  [ProfileIdx]  = EditableValues(HorizontalEnd[ProfileIdx]);
	HorizontalTime [ProfileIdx]  = EditableValues(HorizontalTime[ProfileIdx]);
	ToggleAATypev1 [ProfileIdx]  = EditableSwitch(ToggleAATypev1[ProfileIdx]);
	TaylorShapesv1 [ProfileIdx]  = EditableSwitch(TaylorShapesv1[ProfileIdx]);
	SpeedAA12      [ProfileIdx]  = EditableValues(SpeedAA12[ProfileIdx]);
	RadiusAA12     [ProfileIdx]  = EditableValues(RadiusAA12[ProfileIdx]);
	BoostFirev1    			     = EditableSwitch(BoostFirev1);
	BoostStrengthv1    			 = EditableValues(BoostStrengthv1);
	BoostSpeedv1     			 = EditableValues(BoostSpeedv1);         
	ToggleAAType   [ProfileIdx]  = EditableSwitch(ToggleAAType[ProfileIdx]);
	TaylorShapes   [ProfileIdx]  = EditableSwitch(TaylorShapes[ProfileIdx]);
	ShapeDirection    			 = EditableSwitch(ShapeDirection);
	AdsSpeed[ProfileIdx]         = EditableValues(AdsSpeed[ProfileIdx]);
	TaylorAngle[ProfileIdx]      = EditableValues(TaylorAngle[ProfileIdx]);
	TaylorRadius[ProfileIdx]     = EditableValues(TaylorRadius[ProfileIdx]);
	ToggleBoostFire    			 = EditableSwitch(ToggleBoostFire);
	TaylorPBoostStr    			 = EditableValues(TaylorPBoostStr);
	TaylorABoostSpd   			 = EditableValues(TaylorABoostSpd);
	TaylorTracking     			 = EditableSwitch(TaylorTracking);
	TrackingSize       			 = EditableValues(TrackingSize);
	TrackingSpeed      			 = EditableValues(TrackingSpeed);
	AimAssistSize     			 = EditableValues(AimAssistSize);
	AimAssistTime      			 = EditableValues(AimAssistTime);
	ToggleAATypev1 [ProfileIdx]  = EditableSwitch(ToggleAATypev1[ProfileIdx]);
	TaylorShapesv1 [ProfileIdx]  = EditableSwitch(TaylorShapesv1[ProfileIdx]);
	BaseSpeed       			 = EditableValues(BaseSpeed);
	ZoneSpeed      			     = EditableValues(ZoneSpeed);
    FireSpeed     			     = EditableValues(FireSpeed);
	BasePower      			     = EditableValues(BasePower);
	ZonePower      			     = EditableValues(ZonePower);
    FirePower     			     = EditableValues(FirePower);
    DeadZone      			     = EditableValues(DeadZone);
	RateOfFire    [ProfileIdx]   = EditableValues(RateOfFire[ProfileIdx]);
	RateOfFireRf  [ProfileIdx]   = EditableValues(RateOfFireRf[ProfileIdx]);     
	BurstFireHold			     = EditableValues(BurstFireHold);
	BurstFireWait			     = EditableValues(BurstFireWait);
	BurstFireRelease			 = EditableValues(BurstFireRelease);
	StrafeShotTime     			 = EditableValues(StrafeShotTime);
	MaxReloadTime         	     = EditableValues(MaxReloadTime);
	GeneralSens        			 = EditableValues(GeneralSens);
	AdsSens            		     = EditableValues(AdsSens);
	FireSens           			 = EditableValues(FireSens);
	AdsFireSens        			 = EditableValues(AdsFireSens);
	SlideDelay        		     = EditableValues(SlideDelay);
	CrouchSpeed     			 = EditableValues(CrouchSpeed);
	PingDelay       			 = EditableValues(PingDelay);
	HandGunVertical              = EditableValues(HandGunVertical);
	HandGunAASpeed               = EditableValues(HandGunAASpeed);
	HandGunAASize                = EditableValues(HandGunAASize);
	ToggleAutoRF     			 = EditableSwitch(ToggleAutoRF);
	ToggleAutoHB     			 = EditableSwitch(ToggleAutoHB);
	MenuScroll();
	vm_tctrl(0);
} 
/*
============================================================================================================================================
  Edit Values ()                                                                                                                      
============================================================================================================================================
*/
function EditableValues(ValueIndex) {

    if(ModORVal[2] == ValRangeMinMax[ValIdx++][0]) 
    { 
        if(get_ival(Ads))  
        {    
        	ValueIndex = MultiFunction(PS4_RIGHT,PS4_LEFT,ValueIndex,ValRangeMinMax[ModORVal[2]][3],ValRangeMinMax[ModORVal[2]][1],ValRangeMinMax[ModORVal[2]][2]);  
          	ValueIndex = MultiFunction(PS4_UP,PS4_DOWN,ValueIndex,ValRangeMinMax[ModORVal[2]][4],ValRangeMinMax[ModORVal[2]][1],ValRangeMinMax[ModORVal[2]][2]);  
        }
       	
        if(ValRangeMinMax[ValIdx][0] == 4 || ValRangeMinMax[ValIdx][0] == 7) 
        	NumberToString(ValueIndex * 100, FindDigits(ValueIndex * 100));
        else
        	NumberToString(ValueIndex, FindDigits(ValueIndex));  
    }
    return ValueIndex;                
 }
 /*
============================================================================================================================================
  Edit Menu Toggle ()                                                                                                                      
============================================================================================================================================
*/
function EditableSwitch(f_val) { 
	  
	if(ModORVal[2] == ValRangeMinMax[ValIdx++][0]){
	
		f_val = MultiFunction(PS4_UP,PS4_DOWN,f_val,ValRangeMinMax[ModORVal[2]][3],ValRangeMinMax[ModORVal[2]][1],ValRangeMinMax[ModORVal[2]][2]);  
		 
	    if(ValRangeMinMax[ValIdx][0] == 8){
	    	String(CurveType[ToggleAATypev1[ProfileIdx]],Small,6,0);
	    } 
	    else if(ValRangeMinMax[ValIdx][0] == 15){
	    	String(CurveType[ToggleAAType[ProfileIdx]],Small,6,0);
	    } 
	    else if(ValRangeMinMax[ValIdx][0] == 29){
	    	String(CurveType[ToggleAATypev1[ProfileIdx]],Small,6,0);
	    } 
	    else if(ValRangeMinMax[ValIdx][0] == 9){
	    	if(ToggleAATypev1[ProfileIdx] == 0)
	    		String(CircularCurvev1[TaylorShapesv1[ProfileIdx]],Small,6,0);
	    	else if(ToggleAATypev1[ProfileIdx] == 1)
	    		String(SquareCurvev1[TaylorShapesv1[ProfileIdx]],Small,6,0);
	    	else
	    		String(MixedCurvev1[TaylorShapesv1[ProfileIdx]],Small,6,0);		
	    }
	    else if(ValRangeMinMax[ValIdx][0] == 16){
	    	if(ToggleAAType[ProfileIdx] == 0)
	    		String(CircularCurve[TaylorShapes[ProfileIdx]],Small,6,0);
	    	else if(ToggleAAType[ProfileIdx] == 1)
	    		String(SquareCurve[TaylorShapes[ProfileIdx]],Small,6,0);
	    	else
	    		String(MixedCurve[TaylorShapes[ProfileIdx]],Small,6,0);
	    }
	    else if(ValRangeMinMax[ValIdx][0] == 30){
	    	if(ToggleAATypev1[ProfileIdx] == 0)
	    		String(CircularCurvev1[TaylorShapesv1[ProfileIdx]],Small,6,0);
	    	else if(ToggleAATypev1[ProfileIdx] == 1)
	    		String(SquareCurvev1[TaylorShapesv1[ProfileIdx]],Small,6,0);
	    	else
	    		String(MixedCurvev1[TaylorShapesv1[ProfileIdx]],Small,6,0);
	    }
	    else
	    {
			if(f_val == 1)
				String(Misc[0],Small,6,0);   
			else 
			    String(Misc[1],Small,6,0);  
	    } 
	}      	
    return f_val;
}
/*
============================================================================================================================================
  Misc Variables For Mods                                                                                                                      
============================================================================================================================================
*/
// Variables Used Throughout The Script \\ 
int RfFireType[3],BfFireType[3];
int HoldTime,RestTime;
int DriveMode;
int SmartRumble,AntirecoilStrength;
int FireRF;
int FirstShotBeforeReload,ReloadInProgress,MaxReloadTime;
int GenStr;
int Tracking,Tracker1,Tracker2;
int HandGunVStrength,HandGunAASpd,HandGunAAStr;
int CompleteTime;
int Time;
int AntirecoilStart,AntirecoilEnd;
/*
============================================================================================================================================
  Display Menu & Strings                                                                                                                    
============================================================================================================================================
*/
const string Misc[]     = {"On","Off","Primary","Secondary","Custom Profile","All Profiles","Controller","Prim/Sec","< Quick Toggles >","ScottishTryHard","3.0","Sniper/HGun Mode","Activated",
 //                          0    1       2          3              4              5              6           7              8                 9           10           11               12            
"Drive Mode","Deactivated","Disables Prim/Sec","Rapid Fire Only","Saved","FinalTest","Controller","Remap","Select Buttons","Button Remaps","Button Remaps","Beta",""};
 //  13            14               15                16            17            18           19         20          21   
function DisplayStrings(){ 
	rect_oled(2,3,127,50,1,0);
	rect_oled(0, 0, OLED_WIDTH, OLED_HEIGHT, OLED_BLACK, OLED_WHITE); 
	line_oled(0, 50,127 , 50, 1, 1); 
	
	led(ProfileIdx);

	if(ModOrEditMenu[1] || ModOrEditMenu[2]) {
		line_oled(0, 25,127 , 25, 1, 1); 
		led(ProfileIdx);
	}
	if(ModOrEditMenu[2] || ModOrEditMenu[3]) 
	{ 	
		String(ValNames[ModORVal[2]],Small,-24,0); 
		
		if(ValRangeMinMax [ModORVal[2]][5] == 0){ 
			String(Misc[5],Small,-12,0); 
		} 
		if(ValRangeMinMax [ModORVal[2]][5] == 1){ 
			String(Profiles[ProfileIdx],Small,-12,0); 
		}
		if(ValRangeMinMax [ModORVal[2]][5] == 2){ 
			String(Misc[11],Small,-12,0); 
		} 
	}
	else if(ModOrEditMenu[1])
	{
	    String(ModNames[ModORVal[1]],Small,-24,0);
	    
	    if(ModsNToggles[ModORVal[1]][6] == 0){
	    	String(Misc[5],Small,-12,0); 
	    }
	    if(ModsNToggles[ModORVal[1]][6] == 1){
	    	String(Profiles[ProfileIdx],Small,-12,0); 
	    } 
	    if(ModsNToggles[ModORVal[1]][6] == 2){
	    	String(Misc[19],Small,-12,0); 
	    } 
	    if(ModsNToggles[ModORVal[1]][6] == 3){
	    	String(Misc[7],Small,-12,0); 
	    } 
	    if(ModsNToggles[ModORVal[1]][6] == 4){
	    	String(Misc[15],Small,-12,0); 
	    }
	    if(ModsNToggles[ModORVal[1]][6] == 5){
	    	String(Misc[8],Small,-12,0); 
	    } 
	    if(ModsNToggles[ModORVal[1]][6] == 6){
	    	String(Misc[22],Small,-12,0); 
	    } 
	     if(ModsNToggles[ModORVal[1]][6] == 7){
	    	String(Misc[23],Small,-12,0); 
	    } 
	}
	else 
	{
		cls_oled(OLED_BLACK);
    	rect_oled(0, 0, OLED_WIDTH, OLED_HEIGHT, OLED_BLACK, OLED_WHITE);
    	led(ProfileIdx);
    	
		for(i = 0;i < GetEntriesStrings(0); i++) 
		{
			if(i == ModORVal[0]) 
			{
				color = OLED_BLACK;
			}else{
	    		color = OLED_WHITE;
			}
		 	print(64 - ((GetCharsStrings(i) * OLED_FONT_SMALL_WIDTH) / 2),vert,OLED_FONT_SMALL,color,MainMenuId[i])
			vert += 12
		}
		vert = 4;	
	}
	DisplayMenu = FALSE;
} 
/*
============================================================================================================================================
  Display Title                                                                                                                    
============================================================================================================================================
*/
int DisplayTitle = TRUE;
int ScreenSaver,BlankScreen
function DisplayTitleScreen(){ 

	if(DisplayTitle)                                            
    { 	
   		cls_oled(OLED_BLACK);
   	    rect_oled(0, 0, OLED_WIDTH, OLED_HEIGHT, OLED_BLACK, OLED_WHITE);
    	String(Misc[9],Small,-22,0);
    	String(Misc[10],Medium,-8,0);
    	String(Misc[24],Small,10,0);
    	String(Profiles[ProfileIdx],Small,25,0);
    	DisplayTitle = FALSE;
    	
        ScreenSaver  = TRUE; 
	}
	// Display a Blank Screen after 10 seconds ( Prevents Screen Burn on The OLED Screen ) 
	if(ScreenSaver) 
	{
    	BlankScreen += get_rtime();
    	
		if(BlankScreen >= 10000)
		{
			cls_oled(OLED_BLACK);
			BlankScreen = 0;
			ScreenSaver = FALSE;
    	} 
    }  
}
/*
============================================================================================================================================
  Profile Activation OutSide The Menu                                                                                                                    
============================================================================================================================================
*/
int ProfileIdx,SelectedProfileIdx,CustomProfile;
const string Profiles[]  = {"Primary","Secondary","Custom Profile",""}; 
function ProfileActivation(){ 
	if(!CustomProfile) 
	{
    	if(ActivateIndividualButton) 
    	{ 
    		if(event_release(ActivateIndividualButton) && get_ptime(ActivateIndividualButton) < 150 || ActivateHoldButton[0] &&  get_ival(ActivateHoldButton[0]) && event_release(ActivatePressButton[0])) 
    		{
				SelectedProfileIdx =! SelectedProfileIdx;
				CustomProfile = FALSE;

				if(ModOrEditMenu[1])
					DisplayMenu = TRUE;
				else
					DisplayTitle = TRUE;
        	}	
        	if(!CustomProfile) 
        	{
        		if(SelectedProfileIdx) 
        	   		ProfileIdx = 1;
        		else
        	   		ProfileIdx = 0; 
			}
    		if(ActivateHoldButton[0] &&  get_ival(ActivateHoldButton[0]))
    			set_val(ActivatePressButton[0], 0);
  		}
  	} 
    if(ActivateHoldButton[1]) 
    {
    	if(get_ival(ActivateHoldButton[1]))
        {
        	if(event_press(ActivatePressButton[1]))
        	{
             	ProfileIdx = 2; 
	       	    CustomProfile =! CustomProfile;
	       	    
	       	    if(ModOrEditMenu[1]) 
    				DisplayMenu = TRUE; 
        		else
            		DisplayTitle = TRUE;
            		
            	if(!CustomProfile) 
            	{
            		if(SelectedProfileIdx) 
            	   		ProfileIdx = 1;
            		else
            	   		ProfileIdx = 0; 
    			}
    		} 
       	}           
       	if(ActivateHoldButton[1] &&  get_ival(ActivateHoldButton[1]))
    		set_val(ActivatePressButton[1], 0);   
   	} 
} 
/*
============================================================================================================================================
  Menu Naviation ()                                                                                                                      
============================================================================================================================================
*/
function MenuNavigation(f_index,f_min,f_max) {
	if(!get_val(Ads))
	{
		if(ModOrEditMenu[0]) 
	    {
	    	f_index = MultiFunction(PS4_DOWN,PS4_UP,f_index,1,f_min,f_max); 
		}
		
		if(!ModOrEditMenu[0])
		{
			f_index = MultiFunction(PS4_RIGHT,PS4_LEFT,f_index,1,f_min,f_max); 
	    }
	}
    if(event_release(PS4_CROSS))
	{
		if(ModOrEditMenu[0]) 
		{
    		if(ModRange[ModORVal[0]][2] != 0)  
			{
				MenuStatus(1,0,1,0,0,0);
				ModORVal[1] = ModRange[ ModORVal[0] ][ 0 ]; 
			} 
	    }
	}
	if(event_press(PS4_CROSS))
	{
		if(ModOrEditMenu[1]) 
		{
			if(ModsNToggles[ModORVal[1]][5] == 1) 
			{
				MenuStatus(1,0,0,1,0,0);
				ModORVal[2] = ModsNToggles[ ModORVal[1] ][ 3 ];
				InitializeShapeChange();
				cls_oled(0);	
			}
		}
    }
    if(event_release(PS4_CIRCLE) && !ModOrEditMenu[0])
    {
    	if(ModOrEditMenu[1]) 
    	{
    		MenuStatus(1,1,0,0,0,0);
    		InitializeShapeChange();
    		
    	
		}
		else if(ModOrEditMenu[2]) 
		{
			MenuStatus(1,0,1,0,0,0);
			InitializeShapeChange();
		
		
		}
	}
	ProfileIdx = MultiFunction(PS4_TRIANGLE,NOT_USE,ProfileIdx,1,0,2); 
	BlockButtons();
	return f_index; 
}
/*
============================================================================================================================================
  Quick Toggle ()                                                                                                                      
============================================================================================================================================
*/
int DisplayQToggles;
function QuickToggleMods(f_hold, f_press,f_val,f_idx) {  
	if (f_hold == 0 || f_press == 0) return f_val;

	if(get_ival(f_hold))
	{
		if(event_press(f_press)) 
		{
		    ModORVal[1] = f_idx;
		    f_val = Refresh(f_val ++,ModsNToggles[ModORVal[1]][1],ModsNToggles[ModORVal[1]][2]);
		    DisplayQToggles = TRUE;
		   
	        if(!f_val)
	            combo_run(RumbleOff);
	        else
	            combo_run(RumbleOn);	
		    
	    }
	    set_val(f_press, 0) 
	} 
	if(DisplayQToggles) 
	{
		combo_run(QuickToggles);
		ScreenSaver = FALSE;
		cls_oled(OLED_BLACK);
		rect_oled(0, 0, OLED_WIDTH, OLED_HEIGHT, OLED_BLACK, OLED_WHITE);
		String(ModNames[ModORVal[1]],Small,-22,0);
		String(Profiles[ProfileIdx],Small,-5,0);
		
		
		if(f_val == 1) 
			String(Misc[0],Small,20,0);
	    else 
	        String(Misc[1],Small,20,0); 
	    
	 
	    DisplayQToggles = FALSE; 
	} 
    return f_val;
} 
/*
============================================================================================================================================
  Menu Button Activation Choices ()                                                                                                                      
============================================================================================================================================
*/
const string PressButtons[]
= { "Select","Triangle/Y","Cross/A","Circle/B","Square/X","Dpad Down","Dpad UP","Dpad Left","Dpad Right","Share/View","Options/Menu","Touch/Sync","Accx/Share","Accy","PS Btn","Xbox Btn","Xbx PR1","Xbx PR2","Xbx PL1","Xbx PL2",""};
const string HoldButtons[]     = { "Select","L2/LT","R2/RT","L1/LB","R1/RB","L3/LS","R3/RS","Dpad Down","Dpad Up","Dpad Left","Dpad Right","Triangle/Y","Cross/A","Circle/B","Square/X",""};
const int8   HoldBtns []       = { -1,  PS4_L2  ,PS4_R2  , PS4_L1, PS4_R1  , PS4_L3 , PS4_R3 ,PS4_DOWN,PS4_UP,PS4_LEFT,PS4_RIGHT,PS4_TRIANGLE,PS4_CROSS, PS4_CIRCLE,PS4_SQUARE}; 
const int8   PressBtns[]       = { -1,  PS4_TRIANGLE,PS4_CROSS, PS4_CIRCLE,PS4_SQUARE,PS4_DOWN, PS4_UP,PS4_LEFT,PS4_RIGHT,PS4_SHARE,PS4_OPTIONS,PS4_TOUCH,PS4_ACCX,PS4_ACCY,PS4_PS,XB1_XBOX,XB1_PR1,XB1_PR2,XB1_PL1,XB1_PL2};
int ActivateIndividualButton = 0;
define ActivateButtonCount = 8;
int ActivateHoldButton[ActivateButtonCount];
int ActivatePressButton[ActivateButtonCount];
int ActivateHoldBtnIdx[ActivateButtonCount];
int ActivatePressBtnIdx[ActivateButtonCount];
int ActivateIndividualBtnIdx;
int ActivatePressButton1[ActivateButtonCount];
int ActivatePressBtnIdx1[ActivateButtonCount];
int HighLight;
function ButtonActivation(i){

	if(ModORVal[1] == ModsNToggles[ModIdx++][0])
 	{ 
 		HighLight = MultiFunction(PS4_DOWN,PS4_UP,HighLight,1,0,1);
 		
	    if(get_ival(Ads))
	    {
	    	if(HighLight == 0) 
	    		ActivateHoldBtnIdx[i] = MultiFunction(PS4_RIGHT,PS4_LEFT,ActivateHoldBtnIdx[i],1,0,14);
	    	else
	    		ActivatePressBtnIdx[i] = MultiFunction(PS4_RIGHT,PS4_LEFT,ActivatePressBtnIdx[i],1,0,19);
        }
        if(HighLight == 0)
        {
       		rect_oled(115,28, 6, 8, OLED_WHITE, OLED_WHITE); // HighLight 1
			rect_oled(6,28, 6, 8, OLED_WHITE, OLED_WHITE);   // HighLight 1
		}
		if(HighLight == 1)
		{
		    rect_oled(115,40, 6, 8, OLED_WHITE, OLED_WHITE); // HighLight 2
   			rect_oled(6,40, 6, 8, OLED_WHITE, OLED_WHITE);   // HighLight 2
		} 
        String(HoldButtons[ActivateHoldBtnIdx[i]],Small,1,0);
       	String(PressButtons[ActivatePressBtnIdx[i]],Small,12,0);
     }  
 }
function ButtonActivationAR(i){

	if(ModORVal[1] == ModsNToggles[ModIdx++][0]) 
 	{ 
 		HighLight = MultiFunction(PS4_DOWN,PS4_UP,HighLight,1,0,1);
 		
	    if(get_ival(Ads))
	    {
	    	if(HighLight == 0) 
	    		ActivatePressBtnIdx1[i] = MultiFunction(PS4_RIGHT,PS4_LEFT,ActivatePressBtnIdx1[i],1,0,8);
	    	else
	    		ActivatePressBtnIdx[i] = MultiFunction(PS4_RIGHT,PS4_LEFT,ActivatePressBtnIdx[i],1,0,8);
        }
        if(HighLight == 0)
        {
       		rect_oled(115,28, 6, 8, OLED_WHITE, OLED_WHITE); // HighLight 1
			rect_oled(6,28, 6, 8, OLED_WHITE, OLED_WHITE);   // HighLight 1
		}
		if(HighLight == 1)
		{
		    rect_oled(115,40, 6, 8, OLED_WHITE, OLED_WHITE); // HighLight 2
   			rect_oled(6,40, 6, 8, OLED_WHITE, OLED_WHITE);   // HighLight 2
		} 
        String(PressButtons[ActivatePressBtnIdx1[i]],Small,1,0);
       	String(PressButtons[ActivatePressBtnIdx[i]],Small,12,0);
     }  
 }
function ActivateAllButtons(){
    
    for (i = 0; i < ActivateButtonCount; i++) 
    {
        ActivateHoldButton[i]          = HoldBtns[clamp(ActivateHoldBtnIdx[i], 0, sizeof(HoldBtns))];
        ActivatePressButton[i]         = PressBtns[clamp(ActivatePressBtnIdx[i],0, sizeof(PressBtns))];
        ActivatePressButton1[i]        = PressBtns[clamp(ActivatePressBtnIdx1[i],0, sizeof(PressBtns))];
        ActivateIndividualButton       = PressBtns[clamp(ActivateIndividualBtnIdx, 0, sizeof(PressBtns))];   
    }
    return;   
} 
 /*
============================================================================================================================================
  Remap Buttons Configuaration                                                                                                                      
============================================================================================================================================
*/
const int8 RemapBtns  [] = 
{ -1,PS4_L2,PS4_R2,PS4_L1,PS4_R1,PS4_L3,PS4_R3,PS4_TRIANGLE,PS4_CROSS,PS4_CIRCLE,PS4_SQUARE,PS4_DOWN,PS4_UP,PS4_LEFT,PS4_RIGHT,PS4_SHARE,PS4_OPTIONS,PS4_TOUCH,PS4_ACCX,PS4_ACCY,PS4_PS,XB1_XBOX,XB1_PR1,XB1_PR2,XB1_PL1,XB1_PL2}; 
const string AllButtons[] = 
{"Remap Btn","L2/LT","R2/RT","L1/LB","R1/RB","L3/LS","R3/RS","TRIANGLE/Y","CROSS/A","CIRCLE/B","SQUARE/X","DOWN","UP","LEFT","RIGHT","SHARE/VIEW","OPTIONS/MENU","TOUCH/SYNC","ACCX/SHARE","ACCY",
"PS","XBOX","XB1 PR1","XB1 PR2","XB1 PL1","XB1 PL2",""};

function ButtonConfig(i){ 
	if(ModORVal[1] == ModsNToggles[ModIdx++][0]){
		HighLight = MultiFunction(PS4_DOWN,PS4_UP,HighLight,1,0,1);
		if(get_ival(Ads)){ 
			if(HighLight == 0) 
	    		AllButtonsIdx[i] = MultiFunction(PS4_RIGHT,PS4_LEFT,AllButtonsIdx[i],1,0,25);
	    	else
	    		AllButtonsOneIdx[i] = MultiFunction(PS4_RIGHT,PS4_LEFT,AllButtonsOneIdx[i],1,0,25);		
	    } 
		if(HighLight == 0){
   			rect_oled(115,28, 6, 8, OLED_WHITE, OLED_WHITE); // HighLight 1
			rect_oled(6,28, 6, 8, OLED_WHITE, OLED_WHITE);   // HighLight 1
		}
		if(HighLight == 1){
	    	rect_oled(115,40, 6, 8, OLED_WHITE, OLED_WHITE); // HighLight 2
			rect_oled(6,40, 6, 8, OLED_WHITE, OLED_WHITE);   // HighLight 2
		} 
		String(AllButtons[AllButtonsIdx[i]],Small,1,0);
   		String(AllButtons[AllButtonsOneIdx[i]],Small,12,0);
	}  
} 
function RemapButtons(ActiveBtn,RemapBtn){ 
	if(get_ival(ActiveBtn) || event_press(ActiveBtn)){ 
		set_val(RemapBtn,100);
		set_val(ActiveBtn,0);
	}
}
define InitiateButtons = 4;
int ActiveButtonRemap[InitiateButtons]
int RemapButtonActive[InitiateButtons]
int AllButtonsIdx[InitiateButtons]
int AllButtonsOneIdx[InitiateButtons]

function RemapButtonsConfig(){
    
    for (i = 0; i < InitiateButtons; i++) 
    {
    	ActiveButtonRemap[i] = RemapBtns[clamp(AllButtonsIdx[i], 0, sizeof(RemapBtns))];
    	RemapButtonActive[i] = RemapBtns[clamp(AllButtonsOneIdx[i], 0, sizeof(RemapBtns))];	
    }
    return;   
}
/*
============================================================================================================================================
  Unmap Buttons Config ()                                                                                                                     
============================================================================================================================================
*/
const string UnmapButtons[] = 
{"Unmap Btn","L2/LT","R2/RT","L1/LB","R1/RB","L3/LS","R3/RS","TRIANGLE/Y","CROSS/A","CIRCLE/B","SQUARE/X","DOWN","UP","LEFT","RIGHT","SHARE/VIEW","OPTIONS/MENU","TOUCH/SYNC","ACCX/SHARE","ACCY",
"PS","XBOX","XB1 PR1","XB1 PR2","XB1 PL1","XB1 PL2",""};

define UnmapButtonId = 2;
int UnmapButton[UnmapButtonId]
int UnmapBtnIdx[UnmapButtonId]

function UnmapButtonsConfig(){
    
    for (i = 0; i < UnmapButtonId; i++) 
    {	
   	 	UnmapButton[i] = RemapBtns[clamp(UnmapBtnIdx[i], 0, sizeof(RemapBtns))]; 	
    }
    return;   
}
function UnmapButtonID(UnmappedButtonID){ 
	set_val(UnmappedButtonID,0);
} 

 /*
============================================================================================================================================
  Display Recoil On The Fly ()                                                                                                                      
============================================================================================================================================
*/
function DisplayAR() { 
	ScreenSaver = FALSE;
	cls_oled(OLED_BLACK); 
	rect_oled(0, 0, OLED_WIDTH, OLED_HEIGHT, OLED_BLACK, OLED_WHITE);
    line_oled(0, 27, OLED_WIDTH - 1, 27, 1, OLED_WHITE);
	String(ValNames[0],Small,-22,0);
	NumberToString(TaylorARVert[ProfileIdx], FindDigits(TaylorARVert[ProfileIdx]))
}
/*
============================================================================================================================================
  One Function For All Menu Button Navigation (Including Toggles/Edit Vals)  ()                                                                                                                      
============================================================================================================================================
*/
function MultiFunction(Inc,Dec,Value,Adjust,Min,Max){  
    
    if(event_press(Inc) || get_ival(Inc) && get_ptime(Inc) > 250){
    	Value += Adjust
    	DisplayMenu = TRUE;
    	if(Value > Max) 
    		return Min;
  
    	if(!Value)
	        combo_run(RumbleOff);
	    else
	        combo_run(RumbleOn);  
    }
    if(event_press(Dec) || get_ival(Dec) && get_ptime(Dec) > 250){
    	Value -= Adjust
    	DisplayMenu = TRUE;
    
    	if(Value < Min)
    		return Max;
    		
    	if(!Value)
	        combo_run(RumbleOff);
	    else
	        combo_run(RumbleOn);  
    }
    set_val(Inc,0); set_val(Dec,0);
    return Value; 
}
function MenuStatus(f_display,f_mainmenu,f_modmenu,f_editmenu,f_adjustables,f_displaytitle) { 

    DisplayMenu      = f_display;
	ModOrEditMenu[0] = f_mainmenu;
	ModOrEditMenu[1] = f_modmenu;
	ModOrEditMenu[2] = f_editmenu;
	ModOrEditMenu[3] = f_adjustables;
	DisplayTitle     = f_displaytitle;
	
} 
function Refresh(Value,Min,Max){  
 	
    if(Value > Max) return Min;
    if(Value < Min) return Max;  
   		   
    return Value; 
}
/*
============================================================================================================================================
  Taylor Assist Shapes Functions ()  > > > SKIP PAST BELOW SECTION < < <  NEEDS OPTIMISING - NOT HAPPY!!!   PRETEND YOU DIDN'T SEE IT!                                                                                                                   
============================================================================================================================================
*/
const int8 PolarArray[] = { -100,-100,-100,-100,-100,-100,-100,-100,-100,-99,-99,-99,-98,-98,-98,-97,-97,-96,-96,-95,-94,-94,-93,-93,-92,-91,-90,-90,-89,-88,-87,-86,-85,-84,-83,-82,-81,-80,-79,-78,-77,-76,-75,-74,-72,-71,-70,-69,-67,-66,-65,-63,-62,-61,-59,-58,-56,-55,-53,-52,-50,-49,-47,-46,-44,-43,-41,-40,-38,-36,-35,-33,-31,-30,-28,-26,-25,-23,-21,-20,-18,-16,-14,-13,-11,-9,-7,-6,-4,-2,0,2,4,6,7,9,11,13,14,16,18,20,21,23,25,26,28,30,31,33,35,36,38,40,41,43,44,46,47,49,51,52,54,55,56,58,59,61,62,63,65,66,67,69,70,70,72,73,74,75,77,78,79,80,81,82,83,84,85,86,87,88,89,89,90,91,92,92,93,94,94,95,95,96,97,97,97,98,98,99,99,99,99,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,99,99,99,99,98,98,97,97,97,96,95,95,94,94,93,92,92,91,90,89,89,88,87,86,85,84,83,82,81,80,79,78,77,75,74,73,72,71,70,69,67,66,65,63,62,61,59,58,56,55,53,52,50,49,47,46,44,43,41,40,38,36,35,33,31,30,28,26,25,23,21,20,18,16,14,13,11,9,7,6,4,2,0,-1,-3,-5,-7,-8,-10,-12,-13,-15,-17,-19,-20,-22,-24,-25,-27,-29,-30,-32,-34,-35,-37,-39,-40,-42,-43,-45,-46,-48,-50,-51,-53,-54,-55,-57,-58,-60,-61,-62,-64,-65,-66,-68,-69,-70,-71,-73,-74,-75,-76,-77,-78,-79,-80,-81,-82,-83,-84,-85,-86,-87,-88,-89,-89,-90,-91,-92,-92,-93,-93,-94,-95,-95,-96,-96,-97,-97,-97,-98,-98,-99,-99,-99,-99,-100,-100,-100,-100,-100};
const int8 LinearArray[] = { 100,-100,-99,-98,-97,-96,-95,-94,-93,-91,-90,-89,-88,-87,-86,-85,-84,-82,-81,-80,-79,-78,-77,-76,-75,-73,-72,-71,-70,-69,-68,-67,-66,-64,-63,-62,-61,-60,-59,-58,-57,-55,-54,-53,-52,-51,-50,-49,-48,-46,-45,-44,-43,-42,-41,-40,-39,-37,-36,-35,-34,-33,-32,-31,-30,-28,-27,-26,-25,-24,-23,-22,-21,-19,-18,-17,-16,-15,-14,-13,-12,-10,-9,-8,-7,-6,-5,-4,-3,-11,2,3,4,5,6,7,8,10,11,12,13,14,15,16,17,19,20,21,22,23,24,25,26,28,29,30,31,32,33,34,35,37,38,39,40,41,42,43,44,46,47,48,49,50,51,52,53,55,56,57,58,59,60,61,62,64,65,66,67,68,69,70,71,73,74,75,76,77,78,79,80,82,83,84,85,86,87,88,89,91,92,93,94,95,96,97,98,100,100,100,99,98,97,96,95,94,93,91,90,89,88,87,86,85,84,82,81,80,79,78,77,76,75,73,72,71,70,69,68,67,66,64,63,62,61,60,59,58,57,55,54,53,52,51,50,49,48,46,45,44,43,42,41,40,39,37,36,35,34,33,32,31,30,28,27,26,25,24,23,22,21,19,18,17,16,15,14,13,12,10,9,8,7,6,5,4,3,1,-1,-1,-2,-3,-4,-5,-6,-7,-8,-10,-11,-12,-13,-14,-15,-16,-17,-19,-20,-21,-22,-23,-24,-25,-26,-28,-29,-30,-31,-32,-33,-34,-35,-37,-38,-39,-40,-41,-42,-43,-44,-46,-47,-48,-49,-50,-51,-52,-53,-55,-56,-57,-58,-59,-60,-61,-62,-64,-65,-66,-67,-68,-69,-70,-71,-73,-74,-75,-76,-77,-78,-79,-80,-82,-83,-84,-85,-86,-87,-88,-89,-91,-92,-93,-94,-95,-96,-97,-98,-100};   
const string AAToggle[]        = {"Choose AA Version","Version 1","Version 2","Beta v6",""}; 
const string AAToggle2[]       = {"Choosa AA Version","Version 4","Version 5","V5 + SpeedBoost",""}; 
const string CurveType[]       = {"Polar","Linear","Mixed",""};
const string CircularCurve[]   = {"Circular","Tall Oval","Wide Oval","Vortex Oval","Spiral","Helix","KITT","Vertical Flare","Tartan Army","Jupiter","Bishop","Blade","Oscilirate",""};
const string SquareCurve[]     = {"Diamond","Tall Diamond","Wide Diamond","Spiral Prism","Spiral Diamond","Helix Diamond","KITT","Vertical Flare","Tartan Army","Jupiter","Bishop","Blade","Oscilirate",""}; 
const string CircularCurvev1[] = {"Circular","Tall Oval","Wide Oval","Vortex Oval","Spiral","Helix","KITT","Vertical Flare",""};
const string SquareCurvev1[]   = {"Diamond","Tall Diamond","Wide Diamond","Spiral Prism","Spiral Diamond","Helix Diamond","KITT","Vertical Flare",""};
const string MixedCurve[]      = {"Hexagon","Tall Hex","Wide Hex","Spiral HexV1","SpiralHexV2","Helix Hex","KittHex","Vertical Hex","Tartan Hex","Jupiter Hex","Bishop Hex","Blade Hex","OscilirateHex",""}; 
const string MixedCurvev1[]    = {"Hexagon","Tall Hex","Wide Hex","Spiral HexV1","SpiralHexV2","Helix Hex","KittHex","Vertical Hex",""};

int Anglev1,SmartRumblev1,BoostedAimAssistv1,BoostAnglev1,CosAnglev1,SinAnglev1;
int Anglev2,SmartRumblev2,BoostedAimAssistv2,BoostAnglev2;
int SmartRumblev4,BoostedAimAssistv4,angle,GetAngle;
int RX,RY,ActualMagnitude,MaxMagnitude;
int Angle,AngleBoost,SpiralPosition1,InnerSpiral,OuterSpiral,SpiralPosition2,Position,SpeedAngle,AngleDirection;
int x,y,inc;
int CycleRefresh;
int TimeInterval = 4;
int PolarStart	 = 1000;
int PolarMid   	 = 1200;
int PolarAimAssist
define False     = FALSE;
define True      = TRUE; 
function InitializeShapeChange() { 
	if(TaylorShapesv1[ProfileIdx] == 3 || TaylorShapes[ProfileIdx] == 3) {
		InnerSpiral = TaylorRadius[ProfileIdx]/2;	
		OuterSpiral = TaylorRadius[ProfileIdx];
	} 
}
function GetShapesV1(f_var){ 

	if(TaylorShapesv1[ProfileIdx] == 0){	
    	if(AngleDirection){ 
    		RY = (get_val(AimRY))  + ( (SinAnglev1 * f_var) )/100;
       		RX = (get_val(AimRX))  + ( (CosAnglev1 * f_var) )/100;
		}else{
			RY = (get_val(AimRY))  + ( (CosAnglev1 * f_var) )/100;
			RX = (get_val(AimRX))  + ( (SinAnglev1 * f_var) )/100;
		}
    }
    if(TaylorShapesv1[ProfileIdx] == 1){ // Tall Oval
    	if(AngleDirection){
	        RY = (get_val(AimRY))  + ( (SinAnglev1 * f_var) )/100;
       		RX = (get_val(AimRX))  + ( (CosAnglev1 * f_var/2))/100;
		}else{
			RY = (get_val(AimRY))  + ( (CosAnglev1 * f_var) )/100;
			RX = (get_val(AimRX))  + ( (SinAnglev1 * f_var/2))/100;
	    } 
    }
    if(TaylorShapesv1[ProfileIdx] == 2){ // Wide Oval
        if(AngleDirection){
	        RY = (get_val(AimRY))  + ( (SinAnglev1 * f_var/2))/100;
       		RX = (get_val(AimRX))  + ( (CosAnglev1 * f_var))/100;
		}else{
			RY = (get_val(AimRY))  + ( (CosAnglev1 * f_var/2))/100;
			RX = (get_val(AimRX))  + ( (SinAnglev1 * f_var))/100;
	    } 
    }
    if(TaylorShapesv1[ProfileIdx] == 3){ // SpiralOval
		Spiral(f_var);
		if(AngleDirection){
	        RY = (get_val(AimRY))  + ( (SinAnglev1 * OuterSpiral))/100;
       		RX = (get_val(AimRX))  + ( (CosAnglev1 * InnerSpiral))/100;
		}else{
			RY = (get_val(AimRY))  + ( (CosAnglev1 * OuterSpiral))/100;
			RX = (get_val(AimRX))  + ( (SinAnglev1 * InnerSpiral))/100;
	    } 
    } 
    if(TaylorShapesv1[ProfileIdx] == 4){ // Spiral
		Spiral(f_var);
		if(AngleDirection){
	        RY = (get_val(AimRY))  + ( (SinAnglev1 * OuterSpiral))/100;
       		RX = (get_val(AimRX))  + ( (CosAnglev1 * InnerSpiral))/100;
		}else{
			RY = (get_val(AimRY))  + ( (CosAnglev1 * OuterSpiral))/100;
			RX = (get_val(AimRX))  + ( (SinAnglev1 * InnerSpiral))/100;
	    } 
    }
    if(TaylorShapesv1[ProfileIdx] == 5){ // Helix
   		Helix();
	    RX = (get_val(AimRX)) + ((f_var * x)/100);
	    RY = (get_val(AimRY)) + ((f_var * y)/100);   
    }
    if(TaylorShapesv1[ProfileIdx] == 6){
     	RX = (get_val(AimRX)) + ((SinAnglev1 * f_var)/100);
    }
    if(TaylorShapesv1[ProfileIdx] == 7){
    	RY = (get_val(AimRY)) + ((CosAnglev1 * f_var)/100);
    } 
    set_val(AimRX, clamp(RX, -100, 100));
	set_val(AimRY, clamp(RY, -100, 100));
}
function GetShapesV6(f_var,f_angle){ 

	if(TaylorShapesv1[ProfileIdx] == 0){ 
		RX += (f_var * sin(f_angle))/100;
	    RY += (f_var * cos(f_angle))/100; 
    }
    if(TaylorShapesv1[ProfileIdx] == 1){ 
	    RX += ((f_var/2 * cos(f_angle))/100);
	    RY += ((f_var   * sin(f_angle))/100);
    }
    if(TaylorShapesv1[ProfileIdx] == 2){
    	RX += ((f_var   * cos(f_angle))/100);
        RY += ((f_var/2 * sin(f_angle))/100);
    }
    if(TaylorShapesv1[ProfileIdx] == 3){ 
		Spiral(f_var);
        RX += ((InnerSpiral * cos(f_angle))/100);
        RY += ((OuterSpiral * sin(f_angle))/100);  
    } 
    if(TaylorShapesv1[ProfileIdx] == 4){ 
		Spiral(f_var);
        RX += ((InnerSpiral * cos(f_angle))/100);
        RY += ((OuterSpiral * sin(f_angle))/100);   
    }
    if(TaylorShapesv1[ProfileIdx] == 5){
   		Helix();
	    RX += ((f_var * x)/100);
	    RY += ((f_var * y)/100);     
    }
    if(TaylorShapesv1[ProfileIdx] == 6){ 
    	RX += (f_var * sin(f_angle))/100;
    }
    if(TaylorShapesv1[ProfileIdx] == 7){
    	RY += (f_var * cos(f_angle))/100; 
    } 
    set_val(PS4_RX, clamp(RX, -100, 100));
	set_val(PS4_RY, clamp(RY, -100, 100));
}
function DoNotAtMePolarv2(stick, angle, rad){  
	if(TaylorShapesv1[ProfileIdx] == 0){  
	 	offset(stick + 8, (rad * cosv2(angle))/ 100);
	 	offset(stick + 7, (rad * sinv2(angle))/ 100);
 	}
 	if(TaylorShapesv1[ProfileIdx] == 1){ 
  		offset(stick + 8, (rad   * cosv2(angle)) / 100);
  		offset(stick + 7, (rad/2 * sinv2(angle)) / 100);
  	}
  	if(TaylorShapesv1[ProfileIdx] == 2){ 
  	    offset(stick + 8, (rad/2 * cosv2(angle)) / 100);
  		offset(stick + 7, (rad   * sinv2(angle)) / 100);
  	}
  	if(TaylorShapesv1[ProfileIdx] == 3){ 
		Spiral(rad);
  		offset(stick + 8, (InnerSpiral * cosv2(angle)) / 100);
  		offset(stick + 7, (OuterSpiral * sinv2(angle)) / 100);
  		 
  	}
  	if(TaylorShapesv1[ProfileIdx] == 4){ 
		Spiral(rad);
  		offset(stick + 8, (InnerSpiral * cosv2(angle)) / 100);
  		offset(stick + 7, (OuterSpiral * sinv2(angle)) / 100);
  		 	
  	}
  	if(TaylorShapesv1[ProfileIdx] == 5){ 
  		Helix();
	    offset(stick + 8, (rad * x)/100);
	 	offset(stick + 7, (rad * y)/100);
	}
	if(TaylorShapesv1[ProfileIdx] == 6){  
		offset(stick + 7, (rad * cosv2(angle))/ 100);
	} 
	if(TaylorShapesv1[ProfileIdx] == 7){  
		offset(stick + 8, (rad * cosv2(angle))/ 100);
	}
} 
function GetShapesV5(f_var,f_angle){ 

	if(TaylorShapes[ProfileIdx] == 0) 
    {	
    	if(AngleDirection){ 
			RY += (f_var * sin(f_angle))/100 + Tracker1;
		    RX += (f_var * cos(f_angle))/100 + Tracker2;   
		}else{
			RX += (f_var * sin(f_angle))/100 + Tracker1;
		    RY += (f_var * cos(f_angle))/100 + Tracker2; 
		}
    }
    if(TaylorShapes[ProfileIdx] == 1) // Tall Oval
    {
    	if(AngleDirection){
			RX += ((f_var/2 * sin(f_angle))/100 + Tracker1);
	       	RY += ((f_var   * cos(f_angle))/100 + Tracker2);
	    }else{
	        RX += ((f_var/2 * cos(f_angle))/100 + Tracker1);
	        RY += ((f_var   * sin(f_angle))/100 + Tracker2);
	    } 
    }
    if(TaylorShapes[ProfileIdx] == 2) // Wide Oval
    {
    	if(AngleDirection){
			RX += ((f_var   * sin(f_angle))/100 + Tracker1);
       		RY += ((f_var/2 * cos(f_angle))/100 + Tracker2);
        }else{
        	RX += ((f_var   * cos(f_angle))/100 + Tracker1);
        	RY += ((f_var/2 * sin(f_angle))/100 + Tracker2);
        }
    }
    if(TaylorShapes[ProfileIdx] == 3) // SpiralOval
	{
		Spiral(f_var);
		if(AngleDirection){
			RX += ((OuterSpiral * sin(f_angle))/100 + Tracker1);
       		RY += ((InnerSpiral * cos(f_angle))/100 + Tracker2);
        }else{
        	RX += ((InnerSpiral * cos(f_angle))/100 + Tracker1);
        	RY += ((OuterSpiral * sin(f_angle))/100 + Tracker2);
		}   
    } 
    if(TaylorShapes[ProfileIdx] == 4) // Spiral
	{
		Spiral(f_var);
		
		if(AngleDirection){
			RX += ((OuterSpiral * sin(f_angle))/100 + Tracker1);
       		RY += ((InnerSpiral * cos(f_angle))/100 + Tracker2);
        }else{
        	RX += ((InnerSpiral * cos(f_angle))/100 + Tracker1);
        	RY += ((OuterSpiral * sin(f_angle))/100 + Tracker2);
		}   
    }
    if(TaylorShapes[ProfileIdx] == 5) // Helix
	{
   		Helix();
	    RX += ((f_var * x)/100 + Tracker1);
	    RY += ((f_var * y)/100 + Tracker2);
         
    }
    if(TaylorShapes[ProfileIdx] == 6) 
    {
    	RX += (f_var * sin(f_angle))/100;
    }
    if(TaylorShapes[ProfileIdx] == 7)
    {
    	RY += (f_var * cos(f_angle))/100; 
    } 
    if(TaylorShapes[ProfileIdx] == 8){ 
    	if(Position == 0){ 
			RX += (f_var * sin(135 + f_angle))/100 + Tracker1;
			RY += (f_var * cos(45  + f_angle))/100 + Tracker2; 	
		}
		if(Position == 1){ 	
			RX += (f_var * sin(45   + f_angle))/100 + Tracker1;
			RY += (f_var * cos(135  + f_angle))/100 + Tracker2; 	
		}
		Position ++ 
		if(Position == 2){ 
		  	Position = 0;
		}
	}
	if(TaylorShapes[ProfileIdx] == 9){ 
		 RX +=  (f_var * sin(180 + angle)) / 100 + Tracker1;
  		 RY +=  (f_var * cos(315 + angle)) / 100 + Tracker2;	
    }
    if(TaylorShapes[ProfileIdx] == 10) { 
  		 RX +=  (f_var * cos(135 + angle)) / 100 + Tracker1;
  		 RY +=  (f_var * sin(45 + angle)) / 100 + Tracker2;
    } 
    if(TaylorShapes[ProfileIdx] == 11){ 
    	 RX +=  (f_var * cos(45 + angle)) / 100 + Tracker1;
  		 RY +=  (f_var * sin(135 + angle)) / 100 + Tracker2;
  	} 
  	if(TaylorShapes[ProfileIdx] == 12){ 
    	 RX +=  (f_var * cos(180 + angle)) / 100 + Tracker1;
  		 RY +=  (f_var * sin(315 + angle)) / 100 + Tracker2;
  	} 
  	
    set_val(PS4_RX, clamp(RX, -100, 100));
	set_val(PS4_RY, clamp(RY, -100, 100));
}
function Spiral(rad){ 
	if(!(CycleRefresh++ % TimeInterval))
	{
		if(!SpiralPosition1)                                
		{
			InnerSpiral -= 1;
			if(InnerSpiral < rad/2)
				SpiralPosition1 = True;   
		}
		else
		{
		    InnerSpiral += 1;
			if(InnerSpiral > rad)
				SpiralPosition1 = False;
		}
		if(!SpiralPosition2)
		{
			OuterSpiral -= 1;
			if(OuterSpiral < rad/2)
				SpiralPosition2 = True;
		}
		else
		{
			OuterSpiral += 1;
			if(OuterSpiral >  rad)
				SpiralPosition2 = False;
		}
		CycleRefresh = 0;
	}
}
function DoNotAtMePolar(stick, angle, rad) {
	if(TaylorShapes[ProfileIdx] == 0){ 
	 	if(AngleDirection){
	  		offset(stick + 8, (rad * sin(angle))/ 100 + Tracker1);
	 		offset(stick + 7, (rad * cos(angle))/ 100 + Tracker2);
	 	}else{
	 		offset(stick + 8, (rad * cos(angle))/ 100 + Tracker1);
	 		offset(stick + 7, (rad * sin(angle))/ 100 + Tracker2);
	 	}
 	}
 	if(TaylorShapes[ProfileIdx] == 1){ 
 		
  		if(AngleDirection){ 	
  		    offset(stick + 8, (rad   * sin(angle))/ 100 + Tracker1);
  			offset(stick + 7, (rad/2 * cos(angle))/ 100 + Tracker2);
  		}else{
  			offset(stick + 8, (rad   * cos(angle)) / 100 + Tracker1);
  			offset(stick + 7, (rad/2 * sin(angle)) / 100 + Tracker2);
  		}
  	}
  	if(TaylorShapes[ProfileIdx] == 2){ 
  	    if(AngleDirection){ 
  		    offset(stick + 8, (rad/2 * sin(angle)) / 100 + Tracker1);
  			offset(stick + 7, (rad   * cos(angle)) / 100 + Tracker2);
  	    }else{ 
  	    	offset(stick + 8, (rad/2 * cos(angle)) / 100 + Tracker1);
  			offset(stick + 7, (rad   * sin(angle)) / 100 + Tracker2);
  		} 
  	}
  	if(TaylorShapes[ProfileIdx] == 3){ 
  	
		Spiral(rad);
		
  		if(AngleDirection){ 
			offset(stick + 8, (InnerSpiral * sin(angle)) / 100 + Tracker1);
  			offset(stick + 7, (OuterSpiral * cos(angle)) / 100 + Tracker2);
  		}else{
  			offset(stick + 8, (InnerSpiral * cos(angle)) / 100 + Tracker1);
  			offset(stick + 7, (OuterSpiral * sin(angle)) / 100 + Tracker2);
  		} 
  	}
  	if(TaylorShapes[ProfileIdx] == 4){ 
  	
		Spiral(rad);
		
		if(AngleDirection){ 
			offset(stick + 8, (InnerSpiral * sin(angle)) / 100 + Tracker1);
  			offset(stick + 7, (OuterSpiral * cos(angle)) / 100 + Tracker2);
  		}else{
  			offset(stick + 8, (InnerSpiral * cos(angle)) / 100 + Tracker1);
  			offset(stick + 7, (OuterSpiral * sin(angle)) / 100 + Tracker2);
  		} 	
  	}
  	if(TaylorShapes[ProfileIdx] == 5){ 
  	
  		Helix();
	    offset(stick + 8, (rad * x)/100 + Tracker1);
	 	offset(stick + 7, (rad * y)/100 + Tracker2);
	}
	if(TaylorShapes[ProfileIdx] == 6){ 
	
		offset(stick + 7, (rad * cos(angle))/ 100);
	} 
	if(TaylorShapes[ProfileIdx] == 7){ 
	 
		offset(stick + 8, (rad * cos(angle))/ 100);
	}
	if(TaylorShapes[ProfileIdx] == 8){ 
		if(Position == 0){ 
			offset(stick + 7, (rad * cos(135 + angle)) / 100 + Tracker1);
		    offset(stick + 8, (rad * sin(45 + angle)) / 100 + Tracker2);
		} 
		if(Position == 1){ 
			offset(stick + 7, (rad * cos(45 + angle)) / 100  + Tracker1);
		    offset(stick + 8, (rad * sin(135 + angle)) / 100 + Tracker2);
	    }  
		Position ++ 
		if(Position == 2){ 
		  	Position = 0;
		}
    }
    if(TaylorShapes[ProfileIdx] == 9) { 
    	offset(stick + 7, (rad * cos(315 + angle)) / 100 + Tracker1);
  		offset(stick + 8, (rad * sin(180 + angle)) / 100 + Tracker2);	
  	}
  	if(TaylorShapes[ProfileIdx] == 10) { 
  		offset(stick + 7, (rad * cos(135 + angle)) / 100 + Tracker1);
  		offset(stick + 8, (rad * sin(45 + angle)) / 100 + Tracker2);
    } 
    if(TaylorShapes[ProfileIdx] == 11){ 
    	offset(stick + 7, (rad * cos(45 + angle)) / 100 + Tracker1);
  		offset(stick + 8, (rad * sin(135 + angle)) / 100 + Tracker2);
  	} 
  	if(TaylorShapes[ProfileIdx] == 12){ 
    	offset(stick + 7, (rad * cos(180 + angle)) / 100 + Tracker1);
  		offset(stick + 8, (rad * sin(315 + angle)) / 100 + Tracker2);
  	} 
 }
function Helix(){ 
	inc = (i % 100);
    if(Position == 0){ 
   		x = inc; y = 100 - inc;
   	} 
    else if (Position == 1){ 
    	x = 100 - inc; y = - inc; 
    }
    else if (Position == 2){
    	x = -inc; y = -100 + inc; 
    }
    else if(Position == 3) {  
    	x = -100 + inc; y = inc; 
    }
    Position ++;
   
    if(Position == 4){ 
    	Position = 0;
    }	
 } 
function correctAngle(angle){
  if(angle < 0) angle = 360 + (angle % 360);
  angle = (angle + 90) % 360;
  return angle;
}
function offset(Stick,Value) {
  set_val(Stick, clamp(Value * (100 - abs(get_val(Stick))) / 100 + get_val(Stick), -100, 100));
  return;
}
function sin(angle){
	
  	if(ToggleAAType[ProfileIdx] == 0)
		return PolarArray[correctAngle(angle)];

	else if(ToggleAAType[ProfileIdx] == 1)
    	return LinearArray[correctAngle(angle)];
  
    return PolarArray[correctAngle(angle)];  
}

function cos(angle){
	if(ToggleAAType[ProfileIdx] == 0) 
		return PolarArray[(correctAngle(angle) + 90) % 360];
	
	else if(ToggleAAType[ProfileIdx] == 1)
    	return LinearArray[(correctAngle(angle) + 90) % 360];
    
    return LinearArray[(correctAngle(angle) + 90) % 360];  
}
function sinv2(angle){
	
  	if(ToggleAATypev1[ProfileIdx] == 0)
		return PolarArray[correctAngle(angle)];

	else if(ToggleAATypev1[ProfileIdx] == 1)
    	return LinearArray[correctAngle(angle)];
  
    return PolarArray[correctAngle(angle)];   
}

function cosv2(angle){
	if(ToggleAATypev1[ProfileIdx] == 0) 
		return PolarArray[(correctAngle(angle) + 90) % 360];
	
	else if(ToggleAATypev1[ProfileIdx] == 1)
    	return LinearArray[(correctAngle(angle) + 90) % 360];
    
    return LinearArray[(correctAngle(angle) + 90) % 360];    
}
/*
function sin(angle){
	if(ToggleAAType[ProfileIdx] == 0)   return PolarArray[correctAngle(angle)];
	return LinearArray[correctAngle(angle)];  
}
function sinv2(angle){ 	
	if(ToggleAATypev1[ProfileIdx] == 0) return PolarArray[correctAngle(angle)];
	return LinearArray[(correctAngle(angle) + 90) % 360];
} 
function cosv2(angle){ 
	if(ToggleAATypev1[ProfileIdx] == 0) return PolarArray[(correctAngle(angle) + 90) % 360];
	return LinearArray[(correctAngle(angle) + 90) % 360];
} 	
function cos(angle){
	if(ToggleAAType[ProfileIdx] == 0)   return PolarArray[(correctAngle(angle) + 90) % 360];
	return LinearArray[(correctAngle(angle) + 90) % 360];
}
*/
function RumbleToUse() {
    if(get_rumble(RUMBLE_A) == get_rumble(RUMBLE_B)) 
    {
        return RUMBLE_A;
    }
    if(get_rumble(RUMBLE_A) == 100) 
    {
    	return RUMBLE_B;
	}
	if(get_rumble(RUMBLE_B) == 100) 
	{
    	return RUMBLE_A;
	}
    if(get_rumble(RUMBLE_A) > get_rumble(RUMBLE_B)) 
    {
        return RUMBLE_A;
    }
    if(get_rumble(RUMBLE_A) < get_rumble(RUMBLE_B)) 
    {
        return RUMBLE_B;
    }
    return 0;
}
/*
============================================================================================================================================
  PS4 CrossOver Support  ()                                                                                                                       
============================================================================================================================================
*/
function Ps4CrossOver(){ 
 	if(get_console() == PIO_PS4)
    {
        if(get_controller() != PIO_PS4) // If not PS4 controller:
        {
            if(get_ival(PS4_SHARE)) // View
            {
                if(get_ival(PS4_R3)) // RS + View =  ScreenShot
                {
                    set_val(PS4_SHARE,100);
                    set_val(PS4_TOUCH,0);
                    set_val(PS4_R3,0);
                }
                else // View only = PS4_TOUCH
                {
                    set_val(PS4_TOUCH, 100);
                    set_val(PS4_SHARE, 0);
                }
            }
        }
    }
    else if(get_console() == PIO_XB360) // If XBOX console
    {
        if(get_controller() == PIO_PS4) // If PS4 controller:
            swap(PS4_TOUCH, PS4_SHARE);
    }
} 
/*
============================================================================================================================================
  Menu Activation ()                                                                                                                      
============================================================================================================================================
*/
function MenuActivation(){  
 	if(get_ival(Ads))                                            
	{ 
		if(event_press(PS4_OPTIONS))                               
		{ 
		    MenuStatus(1,1,0,0,0,0);
		    ModORVal[0]  = 0; 
		    combo_run(RumbleOn);
		    
		    if(!ModOrEditMenu[0]){ 
		    	MenuStatus(0,0,0,0,0,1);
		    }    
	    }
	    if(event_press(PS4_SHARE)){
	    	ModOrEditMenu[3] =!ModOrEditMenu[3]
	    	DisplayMenu = TRUE;
	    	//MenuStatus(1,0,0,0,1,0);
	    	
	    	if(!ModOrEditMenu[3]){ 
		    	MenuStatus(0,0,0,0,0,1);
		    } 
	    }
	    set_val(PS4_OPTIONS,0); set_val(PS4_SHARE,0);  
    }
} 
 /*
============================================================================================================================================
  Combo Section ()                                                                                                                      
============================================================================================================================================
*/
combo StickyAim {
offset(AimRY,AimAssistSize);
wait(AimAssistTime);
offset(AimRX,AimAssistSize);
offset(MoveLX,AimAssistSize);
wait(AimAssistTime);
offset(AimRY,inv(AimAssistSize));
wait(AimAssistTime);
offset(AimRX,inv(AimAssistSize));
offset(MoveLX,inv(AimAssistSize));
wait(AimAssistTime);
}
combo EnemyPing {
set_val(Ping,100);
wait(20)
set_val(Ping,0);
wait(20)
set_val(Ping,100);
wait(20)
set_val(Ping,0); 
wait(PingDelay); 
}
combo FastMelee {
set_val(Melee, 100);
wait(35);
set_val(Melee, 0);
wait(30);  
}
combo JumpShot {
set_val(Jump,100);
wait(100);
}
combo DriveMode { 
cls_oled(0);
String(Misc[13],Medium,-15,0);
String(Misc[11],Medium,10,0);
wait(1500);
DisplayTitle = TRUE;
} 
combo CrouchShotCmb {
set_val(Crouch,100);
wait(50);
set_val(Crouch,0);
wait(CrouchSpeed);
}
combo HoldBreath {
set_val(Sprint,0);
wait(60);
set_val(Sprint,100);
wait(110);
set_val(Sprint,0);
wait(110);
}
combo Bunnyhop{
set_val(Jump, 100);
wait(30);
set_val(Jump, 0);
wait(30);
set_val(Jump, 100);
wait(30);
set_val(Jump, 0);
wait(30);
}
combo CancelSlideMW {              
set_val(Crouch, 100);          
wait(SlideDelay);                         
set_val(Crouch, 0);            
wait(60);                          
set_val(Crouch, 100);          
wait(50);                          
set_val(Crouch, 100);          
set_val(Jump, 100);           
wait(60);                          
set_val(Crouch, 0);            
set_val(Jump, 100);          
wait(10);                        
set_val(Jump, 0);
} 
combo CancelSlideCW {
set_val(Crouch, 100);
wait(SlideDelay);
set_val(Crouch, 0);
wait(20);
set_val(Sprint, 0);
set_val(Crouch, 100);
set_val(Sprint, 100);
wait(20);
set_val(Crouch, 0);
set_val(Sprint, 0);
wait(20);
}
combo CancelReload {
set_val(Swap,100);
wait(20);
wait(20)
set_val(Swap,100);
wait(20);
ReloadInProgress = FALSE; }
combo StrafeShot{ 
offset(MoveLX,100);
wait(StrafeShotTime);
wait(50);
offset(MoveLX,-100);
wait(StrafeShotTime);
wait(20);
}
combo Saved { 
cls_oled(0); 
String(Misc[17],Medium,0,0);
wait(2000);
DisplayTitle = TRUE; 
} 
combo QuickToggles{ 
wait(1500) 
DisplayTitle  = TRUE; 
reset_leds(); 
InitializeShapeChange();
} 
combo RAPIDFIRE { 
wait(HoldTime);
set_val(Fire, 0);
wait(RestTime);
}		     
combo BLINK {
wait(LedOn);
led(7);
wait(LedOff);
} 
combo Blink{
led(6);
wait(LedOn);
led(7);
wait(LedOff);
}
combo RumbleOn {
set_ledx(2, 2);
set_rumble(RUMBLE_B, 50);
wait(150);
reset_rumble();
wait(100);
set_rumble(RUMBLE_B, 50);
wait(150);
reset_rumble();
reset_leds();
led(ProfileIdx);
}
combo RumbleOff {						
set_ledx(1, 1);
set_rumble(RUMBLE_A, 50);
wait(300);
reset_rumble();
wait(400);
reset_leds();
led(ProfileIdx);
}
combo BurstFireAuto {

    set_val(Fire,100);
    wait(BurstFireHold);
    set_val(Fire,0);
    wait(BurstFireWait);
}

combo BurstFireSemi {

    set_val(Fire,100);
    wait(40);
    set_val(Fire,0);
    wait(40);
    set_val(Fire,100);
    wait(40);
    set_val(Fire,0);
    wait(40);   
    set_val(Fire,100);
    wait(40);
    set_val(Fire,0);
    wait(40);    
    wait(BurstFireWait);
}
combo AkimboRapidFire {
set_val(Fire,100);
set_val(Ads,100);
wait(40);
set_val(Fire,0);
set_val(Ads,0);
wait(RateOfFireRf[ProfileIdx]);
}
/*
============================================================================================================================================
  Print String Functions ()                                                                                                                      
============================================================================================================================================
*/ 
define Small  = 0;
define Medium = 1;
define Large  = 2;
int stringPosition,stringHeight; 
int stringLength,color;
int vert = 4;
function String (stringLabel,fontSize,offsetY,offsetX) {
    
    if (fontSize == Small) {
        stringPosition = (127 - get_string_length(stringLabel) * 7) / 2;
        stringHeight = (64 - 10) / 2;
    } 
    
    else if (fontSize == Medium) {
        stringPosition = (127 - get_string_length(stringLabel) * 10) / 2;
        stringHeight = (64 - 16) / 2;
    }
    
    else if (fontSize == Large) {
        stringPosition = (127 - get_string_length(stringLabel) * 15) / 2;
        stringHeight = (64 - 21) / 2;
    }
    Print(stringPosition,stringHeight,stringLabel,fontSize,offsetY,offsetX);
}
function get_string_length(offset) { 
    stringLength = 0;
    do { 
        offset++;
        stringLength++;
    } while (duint8(offset));
    return stringLength;
}
function Print (positionString,heightString,captionString,sizeFont,offSetY,offSetX) {
    
        print(positionString + offSetX,heightString + offSetY,sizeFont,1,captionString);
}
function GetEntriesStrings(x) {
    do {
        x++;
    } while (MainMenuId[x] != -1);
    return x;
}
function GetCharsStrings(x){
	if (MainMenuId[x + 1] != -1) return MainMenuId[x + 1] - MainMenuId[x] - 1;
 	return sizeof(MainMenuId) - MainMenuId[x];
}

/*
============================================================================================================================================
  NumberToString ()                                                                                                                      
============================================================================================================================================
*/   
int bufferIndex;
int charIndex,digitIndex;
function NumberToString(f_val,f_digits) {
    bufferIndex = 1;  
    digitIndex = 10000;
    if(f_val < 0) {                    //--neg numbers
         putc_oled(bufferIndex,45);    //--add leading "-"
         bufferIndex += 1;
         f_val = abs(f_val);
    } 
    for(charIndex = 5; charIndex >= 1; charIndex--) {
        if(f_digits >= charIndex) {
            putc_oled(bufferIndex,(f_val / digitIndex) + 48);
            f_val %= digitIndex;
            bufferIndex ++; 
            if(charIndex == 4) {
                putc_oled(bufferIndex,44);//--add ","
                bufferIndex ++;
            }
        }
        digitIndex /= 10;
    } 
    puts_oled(64 - ((OLED_FONT_MEDIUM_WIDTH * bufferIndex - 1) / 2),30,OLED_FONT_MEDIUM,bufferIndex - 1,OLED_WHITE);
} 
int logVal,i;
function FindDigits(num) {
   logVal = 0;
   do {
      num /= 10;
      logVal++;
   } while (num);
   return logVal;
}
/*
============================================================================================================================================
  LED Lights ()                                                                                                                      
============================================================================================================================================
*/ 
int LedOn,LedOff;
function LedBlink(f_on,f_off) {
	LedOn  = f_on;
	LedOff = f_off;
	combo_run(BLINK);
}
function led(f_color){
for(i = 0; i <= 3; i++) 
{
 set_led(i,duint8((f_color * 4) + i));
 }
}
// Led's For Zen Eyes \\
data(
//  0 Blue    1 Pink   2 SkyBlue  3 Green         
    1,0,0,0,  0,0,0,1,  1,0,1,0,  0,0,1,0,
//  4 Yellow  5 White   6 Red      7 OFF         
    0,1,1,0,  1,1,1,0,  0,1,0,0,  0,0,0,0 );	
/*
============================================================================================================================================
  Block Menu Buttons ()                                                                                                                      
============================================================================================================================================
*/   
const uint8 MenuOnlyButtons [] = {  
  PS4_L2,PS4_OPTIONS,PS4_LEFT, PS4_RIGHT,PS4_UP,PS4_DOWN,PS4_CROSS,PS4_CIRCLE,PS4_SQUARE,PS4_TRIANGLE,PS4_L1,PS4_R1,PS4_R2};

function BlockButtons (){  
    for(i = 0; i < 13; i++){
    	if(get_ival(MenuOnlyButtons[i]) || event_press(MenuOnlyButtons[i])){
        	set_val(MenuOnlyButtons[i],0); 
        	set_val(Tactical,0);
        	set_val(Ping,0);
        }    
    }
}
 /*
============================================================================================================================================
  Bit Packing SPVARs ()                                                                                                                      
============================================================================================================================================
*/
function Save(){ 

    set_pvar(SPVAR_1,TaylorARVert[0]);
    set_pvar(SPVAR_2,TaylorARVert[1]);
    set_pvar(SPVAR_3,TaylorARVert[2]);
    
	set_pvar(SPVAR_4,VerticalStart[0]);
	set_pvar(SPVAR_5,VerticalStart[1]);
	set_pvar(SPVAR_6,VerticalStart[2]);
	
	set_pvar(SPVAR_7,VerticalEnd  [0]);
	set_pvar(SPVAR_8,VerticalEnd  [1]);
	set_pvar(SPVAR_9,VerticalEnd  [2]);
	
	set_pvar(SPVAR_10,VerticalTime [0]);
	set_pvar(SPVAR_11,VerticalTime [1]);
	set_pvar(SPVAR_12,VerticalTime [2]);

	set_pvar(SPVAR_13,ToggleAATypev1[0]);
	set_pvar(SPVAR_14,ToggleAATypev1[1]);
	set_pvar(SPVAR_15,ToggleAATypev1[2]);
	
	set_pvar(SPVAR_16,TaylorShapesv1[0]);
	set_pvar(SPVAR_17,TaylorShapesv1[1]);
	set_pvar(SPVAR_18,TaylorShapesv1[2]);
	
    set_pvar(SPVAR_19,SpeedAA12[0]);
    set_pvar(SPVAR_20,SpeedAA12[1]);
    set_pvar(SPVAR_21,SpeedAA12[2]);
    
    set_pvar(SPVAR_22,RadiusAA12[0]);
    set_pvar(SPVAR_23,RadiusAA12[1]);
    set_pvar(SPVAR_24,RadiusAA12[2]);
    
 	set_pvar(SPVAR_25,ToggleAAType[0]);
 	set_pvar(SPVAR_26,ToggleAAType[1]);
 	set_pvar(SPVAR_27,ToggleAAType[2]);
 	
 	set_pvar(SPVAR_28,TaylorShapes[0]);
 	set_pvar(SPVAR_29,TaylorShapes[1]);
 	set_pvar(SPVAR_30,TaylorShapes[2]);
 	
 	set_pvar(SPVAR_31,AdsSpeed[0]);
 	set_pvar(SPVAR_32,AdsSpeed[1]);
 	set_pvar(SPVAR_33,AdsSpeed[2]);
 	
 	set_pvar(SPVAR_34,TaylorAngle[0]);
 	set_pvar(SPVAR_35,TaylorAngle[1]);
 	set_pvar(SPVAR_36,TaylorAngle[2]);
 	
 	set_pvar(SPVAR_37,TaylorRadius[0]);
 	set_pvar(SPVAR_38,TaylorRadius[1]);
 	set_pvar(SPVAR_39,TaylorRadius[2]);
 	

 } 
 /*
============================================================================================================================================
  Menu Scroll ()                                                                                                                      
============================================================================================================================================
*/
int introScrollTimer, introScrollPauseTime;
int introScrollTextOffset;
int introScrollTextIndex;
int introScrollCharIndex = 1;

function MenuScroll() {
    introScrollTimer += get_rtime();
    if(introScrollTimer >= introScrollPauseTime) {
        introScrollPauseTime = 30;
        for (introScrollTextIndex = 1; introScrollTextIndex <= 18; introScrollTextIndex++) {
            if (introScrollTextIndex + introScrollTextOffset >= sizeof(MENU_SCROLL_TEXT)) {
                putc_oled(introScrollTextIndex, MENU_SCROLL_TEXT[introScrollTextIndex + (introScrollTextOffset - sizeof(MENU_SCROLL_TEXT))]);
            }
            else {
                putc_oled(introScrollTextIndex, MENU_SCROLL_TEXT[introScrollTextIndex + introScrollTextOffset]);
            }
        }
        puts_oled(1, 53,OLED_FONT_SMALL, introScrollTextIndex, OLED_WHITE);
        introScrollTextOffset++;
        if (introScrollTextOffset >= sizeof(MENU_SCROLL_TEXT)) {
            introScrollTextOffset = 0;
        }
        introScrollCharIndex--;
        if (introScrollCharIndex < 1) {
            introScrollCharIndex = 18;
            introScrollPauseTime = 2000;

        }
        introScrollTimer = 0;
    }
}
const uint8 MENU_SCROLL_TEXT[] = {
//    1			2		   3		4	     5		     6		   7		  8		     9         10	       11	   12		  13	  14		 15		  16		17        18
     _space, _left,	   _space,   _right,	_space,    _N,	      _e,         _x,       _t,        _space,    _M,      _o,       _d,     _slash,    _V,      _a,       _l,       _space,        
     _space,   _o,	     _r,     _space,    _up,	  _space,	  _down,	 _space,	_F,        _o,		  _r,	   _space,   _T,     _o, 	     _g,	  _g,		_l,	      _e,
     _space, _X,       _slash,       _A,       _space,     _F,	  _o,	      _r,		_space,	   _E,	      _d,	   _i,		  _t,		 _space,	 _M,	  _e,		_n,      _u,
     _space, _space,  _O,        _slash,   _B, _space,     _T,       _o,       _space,     _E,       _x,         _i,       _t,      _space,    _M,     _e,        _n,     _u,
     _space, _Y,_triangle, _space, _C,_h,_a,_n,_g,_e, _space, _P,_r,_o,_f,_i,_l,_e,
     _space,   _H,	  _o,	    _l,		_d,	      _space,	 _L,	    _2, 	    _slash,    _L,	  _T,    _space,		_left,       _space, _O, _r, _space,_right,
     _space,   _T,	   _o,    _space,   _A,	    _d, _j,	      _u,	 _s,	_t,     _space,		   _V,	  _a,		 _l, 	     _u,	  _e,		_s,	     _space,
     _space, _O,	   _r,     _space,    _B,   _u,		_t,	      _t,		 _o,		_n,	        _space,		   _C,		  _h,		 _o,	 _i,	  _c,		_e,      _s
};    


define  _0 = 48,   _A = 65,   _K = 75,   _U =  85,   _e = 101,   _o = 111,   _y       = 121,    _plus      = 43, _slash     = 47 , _dot     =  46;
define  _1 = 49,   _B = 66,   _L = 76,   _V =  86,   _f = 102,   _p = 112,   _z       = 122;
define  _2 = 50,   _C = 67,   _M = 77,   _W =  87,   _g = 103,   _q = 113,   _space   =  32;
define  _3 = 51,   _D = 68,   _N = 78,   _X =  88,   _h = 104,   _r = 114,   _bang    =  33;
define  _4 = 52,   _E = 69,   _O = 79,   _Y =  89,   _i = 105,   _s = 115,   _quote   =  34;
define  _5 = 53,   _F = 70,   _P = 80,   _Z =  90,   _j = 106,   _t = 116,   _hash    =  35;
define  _6 = 54,   _G = 71,   _Q = 81,   _a =  97,   _k = 107,   _u = 117,   _dollar  =  36;
define  _7 = 55,   _H = 72,   _R = 82,   _b =  98,   _l = 108,   _v = 118,   _percent =  37;
define  _8 = 56,   _I = 73,   _S = 83,   _c =  99,   _m = 109,   _w = 119,   _and     =  38;
define  _9 = 57,   _J = 74,   _T = 84,   _d = 100,   _n = 110,   _x = 120,   _tick    =  39;
define _left     = 133,   _right = 134,_up       = 131,_down     = 132,_cross    = 127, _circle   = 128, _triangle = 130;
 /*
============================================================================================================================================
  Controller Button Layout ()                                                                                                                      
============================================================================================================================================
*/
const string ControllerLayouts[] = { "Default", "Tactical", "Lefty", "N0M4D/Charlie", "N0M4D/Charlie Tac", "N0M4D/Charlie Left", "Bumper Jumper", "Bumper Jumper Tac", "1-Hand Gunslinger", "Stick & Move", 
"Brawler", "Beast","Bumper Ping","Bumper Ping Tac", "Default Flipped","Tactical Flipped", "B.Jumper Flipped", "B.JumprTac Flipped", "Stick&Move Flipped","Beasty Swapped","B.Ping Flipped","B.Ping.Tac.Flipped",""}

int Ads,Fire,Tactical,Lethal,Crouch,Jump,Reload,Melee,Swap,Sprint,Ping;    
const uint8 Layouts[][] = {            
 	  //Fire   ADS	  Lethal Tactical  Jump	 Crouch	  Melee	  Sprint  Reload WSwap,  Ping 	
	{ XB1_RT, XB1_LT, XB1_RB, XB1_LB, XB1_A,  XB1_B,  XB1_RS, XB1_LS ,XB1_X, XB1_Y, XB1_UP }, // DEFAULT = 0
	{ XB1_RT, XB1_LT, XB1_RB, XB1_LB, XB1_A,  XB1_RS, XB1_B,  XB1_LS ,XB1_X, XB1_Y, XB1_UP }, // TACTICAL = 1
	{ XB1_LT, XB1_RT, XB1_LB, XB1_RB, XB1_A,  XB1_B,  XB1_LS, XB1_RS ,XB1_X, XB1_Y, XB1_UP }, // LEFTY = 2
	{ XB1_RT, XB1_RB, XB1_LT, XB1_LB, XB1_A,  XB1_B,  XB1_RS, XB1_LS ,XB1_X, XB1_Y, XB1_UP }, // N0M4D/CHARLIE = 3
	{ XB1_RT, XB1_RB, XB1_LT, XB1_LB, XB1_A,  XB1_RS, XB1_B,  XB1_LS ,XB1_X, XB1_Y, XB1_UP }, // N0M4D/CHARLIE TACTICAL = 4
	{ XB1_LT, XB1_LB, XB1_RT, XB1_RB, XB1_A,  XB1_B,  XB1_LS, XB1_RS ,XB1_X, XB1_Y, XB1_UP }, // N0M4D/CHARLIE LEFTY = 5
	{ XB1_RT, XB1_LT, XB1_RB, XB1_A,  XB1_LB, XB1_B,  XB1_RS, XB1_LS ,XB1_X, XB1_Y, XB1_UP }, // BUMPER JUMPER = 6 
	{ XB1_RT, XB1_LT, XB1_RB, XB1_A,  XB1_LB, XB1_RS, XB1_B,  XB1_LS ,XB1_X, XB1_Y, XB1_UP }, // BUMPER JUMPER TACTICAL = 7
	{ XB1_LB, XB1_LT, XB1_RT, XB1_RB, XB1_A,  XB1_B,  XB1_RS, XB1_LS ,XB1_X, XB1_Y, XB1_UP }, // ONE-HAND GUNSLINGER = 8
	{ XB1_RT, XB1_LT, XB1_RB, XB1_LB, XB1_RS, XB1_B,  XB1_A,  XB1_LS ,XB1_X, XB1_Y, XB1_UP }, // STICK AND MOVE = 9
	{ XB1_RT, XB1_LT, XB1_RB, XB1_LB, XB1_A,  XB1_B,  XB1_RS, XB1_LS ,XB1_X, XB1_Y, XB1_UP }, // BRAWLER = 10
	{ XB1_RT, XB1_LT, XB1_RS, XB1_A,  XB1_LB, XB1_B,  XB1_RB, XB1_LS ,XB1_X, XB1_Y, XB1_UP }, // BEASTY = 11
	{ XB1_RT, XB1_LT, XB1_RB, XB1_RB, XB1_A,  XB1_B,  XB1_RS, XB1_LS ,XB1_X, XB1_Y, XB1_LB }, // BUMPER PING = 12
	{ XB1_RT, XB1_LT, XB1_RB, XB1_RB, XB1_A,  XB1_RS, XB1_B,  XB1_LS ,XB1_X, XB1_Y, XB1_LB }, // BUMPER PING TACTICAL = 13
	{ XB1_RB, XB1_LB, XB1_RT, XB1_LT, XB1_A,  XB1_B,  XB1_RS, XB1_LS ,XB1_X, XB1_Y, XB1_UP }, // DEFAULT SWAPPED = 14
	{ XB1_RB, XB1_LB, XB1_RT, XB1_LT, XB1_A,  XB1_RS, XB1_B,  XB1_LS ,XB1_X, XB1_Y, XB1_UP }, // TACTICAL SWAPPED = 15
	{ XB1_RB, XB1_LB, XB1_RT, XB1_A,  XB1_LT, XB1_B,  XB1_RS, XB1_LS ,XB1_X, XB1_Y, XB1_UP }, // BUMPER JUMPER SWAPPED = 16 
	{ XB1_RB, XB1_LB, XB1_RT, XB1_A,  XB1_LT, XB1_RS, XB1_B,  XB1_LS ,XB1_X, XB1_Y, XB1_UP }, // BUMPER JUMPER TACTICAL SWAPPED = 17 
	{ XB1_RB, XB1_LB, XB1_RT, XB1_LT, XB1_RS, XB1_B,  XB1_A,  XB1_LS ,XB1_X, XB1_Y, XB1_UP }, // STICK AND MOVE SWAPPED = 18
	{ XB1_RB, XB1_LB, XB1_RS, XB1_A,  XB1_LB, XB1_B,  XB1_RB, XB1_LS ,XB1_X, XB1_Y, XB1_UP }, // BEASTY SWAPPED 19
	{ XB1_RB, XB1_LB, XB1_RT, XB1_RT, XB1_A,  XB1_B,  XB1_RS, XB1_LS ,XB1_X, XB1_Y, XB1_LT }, // BUMPER PING = 18
	{ XB1_RB, XB1_LB, XB1_RT, XB1_RT, XB1_A,  XB1_RS, XB1_B,  XB1_LS ,XB1_X, XB1_Y, XB1_LT }}; // BUMPER PING TACTICAL = 19		

function Buttons(Type) {
	
	Fire     = Layouts[Type][0];
	Ads      = Layouts[Type][1];
	Lethal   = Layouts[Type][2];
	Tactical = Layouts[Type][3];
	Jump     = Layouts[Type][4];
	Crouch   = Layouts[Type][5];
	Melee    = Layouts[Type][6];
	Sprint   = Layouts[Type][7];
	Reload   = Layouts[Type][8];
	Swap     = Layouts[Type][9];
	Ping     = Layouts[Type][10];
	
} 
 /*
============================================================================================================================================
  Controller Stick Layouts ()                                                                                                                      
============================================================================================================================================
*/
int AimRY,AimRX,MoveLY,MoveLX;
const string ControllerSticks[] = {"Default","Southpaw","Legacy","Legacy Southpaw",""}; 
const uint8  StickLayouts[][] = { 
//  0       1      2      3    //
{ PS4_RY,PS4_RX,PS4_LY,PS4_LX},// Default Sticks 
{ PS4_LY,PS4_LX,PS4_RY,PS4_RX},// SouthPaw
{ PS4_RY,PS4_LX,PS4_LY,PS4_RX},// Legacy 
{ PS4_LY,PS4_RX,PS4_LY,PS4_LX} // Legacy SouthPaw
};

function ControllerRSLS(sticks){ 
  AimRY      = StickLayouts[sticks][0];
  AimRX      = StickLayouts[sticks][1];
  MoveLY     = StickLayouts[sticks][2];
  MoveLX     = StickLayouts[sticks][3];
 
 } 
 